import{r as U,C as y,c as L,g as _,o,w as l,e as a,b as s,u as e,j as Y,h as C,f as r,t as d,a as p,F as h,i as $,W as Z}from"./app-CV2cPHwK.js";import{_ as ee}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BWp_mKAe.js";import{_ as k}from"./Button.vue_vue_type_script_setup_true_lang-C5sOPNae.js";import{_ as se}from"./Input.vue_vue_type_script_setup_true_lang-DwXOvzA9.js";import{_ as te}from"./Label.vue_vue_type_script_setup_true_lang-ciU9q85C.js";import{_ as B}from"./Card.vue_vue_type_script_setup_true_lang--D3KWfGq.js";import{_ as M}from"./CardContent.vue_vue_type_script_setup_true_lang-RDGa4TMZ.js";import{_ as le}from"./CardDescription.vue_vue_type_script_setup_true_lang-1DS5NEM9.js";import{_ as ae}from"./CardHeader.vue_vue_type_script_setup_true_lang-mDEJg-F9.js";import{_ as ne}from"./CardTitle.vue_vue_type_script_setup_true_lang-BSzOzICM.js";import{_ as V,a as T,b as j,c as A,d as N}from"./SelectValue.vue_vue_type_script_setup_true_lang-DxGbDS4g.js";import{_ as re,a as oe,b as F,c as g,d as ie,e as v}from"./TableHeader.vue_vue_type_script_setup_true_lang-BFB0bwl-.js";import{_ as ue}from"./index-CjSyc0sf.js";import{c as de,e as me}from"./AppLayout.vue_vue_type_script_setup_true_lang-BSvNWHlH.js";import{_ as E}from"./Checkbox.vue_vue_type_script_setup_true_lang-BX5_cPIJ.js";import{_ as fe,a as ce,b as _e,c as pe}from"./DialogTitle.vue_vue_type_script_setup_true_lang-Dt6niOGT.js";import{_ as ge}from"./DialogDescription.vue_vue_type_script_setup_true_lang-DeO73u4f.js";import{_ as ve}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BrzzPG_Y.js";import{S as xe}from"./search-DW-pPOEN.js";import{S as he}from"./send-BBVQKN3h.js";import{U as H}from"./_plugin-vue_export-helper-BqS9F3Z2.js";import{T as D}from"./triangle-alert-CdY9FU4_.js";import{C as ke}from"./calendar-gYCWvhXo.js";import{B as we}from"./book-open-BqIuda0t.js";import{M as O}from"./mail--y4IVrnL.js";import{L as $e}from"./loader-circle-BY952dbN.js";import"./index-3f0HzYe1.js";import"./index-DhfkKPqp.js";import"./useForwardPropsEmits-BDdvJDZW.js";import"./Presence-CDD0pFUW.js";import"./ConfigProvider-B93GNSGp.js";import"./useForwardExpose-CFKb2kDd.js";import"./Teleport-C72WAmXs.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-CU0akrCZ.js";import"./Collection-CUuFiyGC.js";import"./usePrimitiveElement-Cy5XmkBm.js";import"./check-i9adLcBw.js";import"./useSize-C1FRSfdB.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-bKed1-cs.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CWDFjwen.js";import"./clock-BeTrlB51.js";const Se={class:"px-4 sm:px-6 lg:px-8 space-y-6"},be={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},ye={class:"flex-1 max-w-md"},Ce={class:"relative"},Ue={class:"flex gap-3"},Le={class:"overflow-x-auto"},Be={class:"flex items-center space-x-3"},Me={class:"font-medium text-foreground"},Ve={class:"text-sm text-muted-foreground"},Te={class:"flex items-center text-muted-foreground"},je={class:"flex items-center text-muted-foreground"},Ae={class:"flex items-center gap-2"},Ne={key:0,class:"text-center py-12"},Fe={key:0,class:"flex items-center justify-between pt-4 border-t"},Ee={class:"text-sm text-muted-foreground"},He={class:"flex space-x-1"},De={class:"space-y-4"},Oe={class:"space-y-2"},ze={class:"p-4 bg-muted rounded-lg"},Re={class:"flex items-start space-x-2"},As={__name:"ResendLoginLinks",props:{users:Object,courses:Array,filters:Object},setup(u){const w=u,m=U([]),x=U(!1),S=y({search:w.filters.search||""}),b=y({course_id:""}),c=y({user_ids:[],course_id:""}),z=L(()=>m.value.length>0),R=L(()=>m.value.length===w.users.data.length&&w.users.data.length>0);function W(){S.get(route("admin.resend-login-links.index"),{preserveState:!0,replace:!0})}function q(i,t){b.course_id=t,b.post(route("admin.resend-login-links.resend",i.id),{preserveScroll:!0,onSuccess:()=>{b.reset()}})}function G(i){i?m.value=w.users.data.map(t=>t.id):m.value=[]}function I(){c.user_ids=m.value,x.value=!0}function J(){c.post(route("admin.resend-login-links.bulk"),{preserveScroll:!0,onSuccess:()=>{m.value=[],x.value=!1,c.reset()}})}function K(i){return i?new Date(i).toLocaleDateString():"Never"}const P=i=>i.split(" ").map(t=>t.charAt(0).toUpperCase()).join("").slice(0,2),Q=(i,t)=>{i&&q({id:t},i)},X=i=>{c.course_id=i};return(i,t)=>(o(),_(ee,null,{default:l(()=>[a("div",Se,[t[18]||(t[18]=a("div",null,[a("h1",{class:"text-3xl font-bold text-foreground"},"Resend Login Links"),a("p",{class:"mt-2 text-muted-foreground"},"Send new secure login links to users with expired access")],-1)),s(e(B),null,{default:l(()=>[s(e(M),{class:"p-6"},{default:l(()=>[a("div",be,[a("div",ye,[a("form",{onSubmit:Y(W,["prevent"])},[a("div",Ce,[s(e(xe),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s(e(se),{modelValue:e(S).search,"onUpdate:modelValue":t[0]||(t[0]=n=>e(S).search=n),type:"text",placeholder:"Search users by name or email...",class:"pl-9"},null,8,["modelValue"])])],32)]),a("div",Ue,[z.value?(o(),_(e(k),{key:0,onClick:I},{default:l(()=>[s(e(he),{class:"mr-2 h-4 w-4"}),r(" Send to "+d(m.value.length)+" Users ",1)]),_:1})):C("",!0)])])]),_:1})]),_:1}),s(e(B),null,{default:l(()=>[s(e(ae),null,{default:l(()=>[s(e(ne),{class:"flex items-center"},{default:l(()=>[s(e(H),{class:"mr-2 h-5 w-5"}),t[4]||(t[4]=r(" Users with Expired Access "))]),_:1}),s(e(le),null,{default:l(()=>t[5]||(t[5]=[r("Users who need new login links to access their courses")])),_:1})]),_:1}),s(e(M),null,{default:l(()=>[a("div",Le,[s(e(re),null,{default:l(()=>[s(e(oe),null,{default:l(()=>[s(e(F),null,{default:l(()=>[s(e(g),{class:"w-12"},{default:l(()=>[s(e(E),{checked:R.value,"onUpdate:checked":G,indeterminate:m.value.length>0&&m.value.length<u.users.data.length},null,8,["checked","indeterminate"])]),_:1}),s(e(g),null,{default:l(()=>t[6]||(t[6]=[r("User")])),_:1}),s(e(g),null,{default:l(()=>t[7]||(t[7]=[r("Status")])),_:1}),s(e(g),null,{default:l(()=>t[8]||(t[8]=[r("Last Login")])),_:1}),s(e(g),null,{default:l(()=>t[9]||(t[9]=[r("Courses")])),_:1}),s(e(g),null,{default:l(()=>t[10]||(t[10]=[r("Actions")])),_:1})]),_:1})]),_:1}),s(e(ie),null,{default:l(()=>[(o(!0),p(h,null,$(u.users.data,n=>(o(),_(e(F),{key:n.id,class:"hover:bg-muted/50"},{default:l(()=>[s(e(v),null,{default:l(()=>[s(e(E),{checked:m.value,"onUpdate:checked":t[1]||(t[1]=f=>m.value=f),value:n.id},null,8,["checked","value"])]),_:2},1024),s(e(v),null,{default:l(()=>[a("div",Be,[s(e(de),null,{default:l(()=>[s(e(me),{class:"bg-muted text-muted-foreground"},{default:l(()=>[r(d(P(n.name)),1)]),_:2},1024)]),_:2},1024),a("div",null,[a("div",Me,d(n.name),1),a("div",Ve,d(n.email),1)])])]),_:2},1024),s(e(v),null,{default:l(()=>[s(e(ue),{variant:"destructive"},{default:l(()=>[s(e(D),{class:"mr-1 h-3 w-3"}),t[11]||(t[11]=r(" Expired Access "))]),_:1})]),_:1}),s(e(v),null,{default:l(()=>[a("div",Te,[s(e(ke),{class:"mr-1 h-3 w-3"}),r(" "+d(K(n.login_token_expires_at)),1)])]),_:2},1024),s(e(v),null,{default:l(()=>{var f;return[a("div",je,[s(e(we),{class:"mr-1 h-3 w-3"}),r(" "+d(((f=n.course_registrations)==null?void 0:f.length)||0)+" enrolled ",1)])]}),_:2},1024),s(e(v),null,{default:l(()=>[a("div",Ae,[s(e(V),{"onUpdate:modelValue":f=>Q(f,n.id)},{default:l(()=>[s(e(T),{class:"w-40"},{default:l(()=>[s(e(j),{placeholder:"Select Course"})]),_:1}),s(e(A),null,{default:l(()=>[(o(!0),p(h,null,$(u.courses,f=>(o(),_(e(N),{key:f.id,value:f.id.toString()},{default:l(()=>[r(d(f.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:2},1032,["onUpdate:modelValue"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),!u.users.data||u.users.data.length===0?(o(),p("div",Ne,[s(e(H),{class:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),t[12]||(t[12]=a("h3",{class:"text-lg font-medium text-foreground mb-2"},"No users found",-1)),t[13]||(t[13]=a("p",{class:"text-sm text-muted-foreground"},"No users with expired access match your search criteria.",-1))])):C("",!0)]),u.users.links&&u.users.data.length>0?(o(),p("div",Fe,[a("div",Ee," Showing "+d(u.users.from)+" to "+d(u.users.to)+" of "+d(u.users.total)+" results ",1),a("div",He,[(o(!0),p(h,null,$(u.users.links,(n,f)=>(o(),p(h,{key:f},[n.url?(o(),_(e(k),{key:0,onClick:We=>e(Z).get(n.url),variant:n.active?"default":"outline",size:"sm",innerHTML:n.label},null,8,["onClick","variant","innerHTML"])):(o(),_(e(k),{key:1,variant:"outline",size:"sm",disabled:"",innerHTML:n.label},null,8,["innerHTML"]))],64))),128))])])):C("",!0)]),_:1})]),_:1}),s(e(fe),{open:x.value,"onUpdate:open":t[3]||(t[3]=n=>x.value=n)},{default:l(()=>[s(e(ce),{class:"max-w-md"},{default:l(()=>[s(e(_e),null,{default:l(()=>[s(e(pe),{class:"flex items-center"},{default:l(()=>[s(e(O),{class:"mr-2 h-5 w-5"}),t[14]||(t[14]=r(" Send Login Links to Multiple Users "))]),_:1}),s(e(ge),null,{default:l(()=>[r(" Send new secure login links to "+d(m.value.length)+" selected users. ",1)]),_:1})]),_:1}),a("div",De,[a("div",Oe,[s(e(te),null,{default:l(()=>t[15]||(t[15]=[r("Select Course")])),_:1}),s(e(V),{"model-value":e(c).course_id,"onUpdate:modelValue":X},{default:l(()=>[s(e(T),null,{default:l(()=>[s(e(j),{placeholder:"Choose a course..."})]),_:1}),s(e(A),null,{default:l(()=>[(o(!0),p(h,null,$(u.courses,n=>(o(),_(e(N),{key:n.id,value:n.id.toString()},{default:l(()=>[r(d(n.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),a("div",ze,[a("div",Re,[s(e(D),{class:"h-4 w-4 text-amber-500 mt-0.5"}),t[16]||(t[16]=a("div",{class:"text-sm text-muted-foreground"}," This will send new login links to all selected users for the chosen course. ",-1))])])]),s(e(ve),null,{default:l(()=>[s(e(k),{onClick:t[2]||(t[2]=n=>x.value=!1),variant:"outline"},{default:l(()=>t[17]||(t[17]=[r(" Cancel ")])),_:1}),s(e(k),{onClick:J,disabled:!e(c).course_id||e(c).processing},{default:l(()=>[e(c).processing?(o(),_(e($e),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(o(),_(e(O),{key:1,class:"mr-2 h-4 w-4"})),r(" "+d(e(c).processing?"Sending...":"Send Login Links"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])])]),_:1}))}};export{As as default};
