import{P as A,I as b,k as C,o as l,w as h,e as t,b as M,j as S,t as o,n as w,a as i,f as u,F as q,h as z,g as E,v as j,r as y,s as B,c as k,W as L}from"./app-iYB6CK9s.js";import{_ as N}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BmAEUQ0k.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-BOHGZ_58.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B3PnW6xU.js";import"./index-BHiy4VMt.js";const T={components:{AdminLayout:N,Link:A},props:{attempt:{type:Object,required:!0}},setup(x){const e=y({}),n=y(!1),r=y(!1),m=y({}),_=s=>Array.isArray(s)?s.join(", "):typeof s=="string"?s:s==null?"N/A":String(s);B(()=>x.attempt.responses,s=>{s.forEach(d=>{d.question.type==="text"&&!d.is_correct&&(e.value[d.id]=d.points_earned??0)})},{immediate:!0});const v=k(()=>Object.values(e.value).some(s=>s!=null&&s!==0)),g=k(()=>Object.values(m.value).some(s=>s!==null));return{manualScores:e,saving:n,success:r,manualScoreErrors:m,hasManualScores:v,hasErrors:g,updateManualScore:(s,d)=>{const c=parseInt(d)||0;c<0||c>100?m.value[s]="Score must be between 0 and 100.":m.value[s]=null,e.value[s]=c},saveManualScores:async()=>{if(!g.value){n.value=!0,r.value=!1;try{const s=await L.put(route("admin.quiz-attempts.update",x.attempt.id),{manual_scores:Object.fromEntries(Object.entries(e.value).map(([d,c])=>[d,c]))},{preserveScroll:!0,onSuccess:()=>r.value=!0})}catch(s){console.error("Error saving scores:",s)}finally{n.value=!1,setTimeout(()=>r.value=!1,3e3)}}},formatCorrectAnswer:_,breadcrumbs:[{name:"Quizzes",route:"admin.quizzes.index"},{name:"Attempts",route:"admin.quiz-attempts.index"},{name:"Details",route:null}]}}},V={class:"mx-auto max-w-3xl py-12 sm:px-6 lg:px-8"},O={class:"mb-8 flex items-center justify-between"},D={class:"mb-6 rounded-xl bg-white p-6 shadow-sm"},Q={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},F={class:"text-sm text-gray-900"},U={class:"text-sm text-gray-900"},I={class:"text-sm text-gray-900"},W={class:"text-sm text-gray-900"},R={class:"text-sm text-gray-900"},Y={class:"text-sm text-gray-900"},G={class:"text-sm text-gray-900"},H={class:"rounded-xl bg-white p-6 shadow-sm"},J={class:"mb-2 text-sm font-medium text-gray-700"},K={class:"mb-2 text-sm text-gray-900"},X={class:"space-y-2"},Z={class:"text-sm text-gray-900"},$={class:"text-sm text-gray-900"},tt={key:0,class:"text-sm text-gray-600"},et={key:1},st=["onUpdate:modelValue","onChange"],at={key:0,class:"mt-1 text-sm text-red-600"},rt={key:0,class:"mt-6"},ot=["disabled"],nt={key:0,class:"flex items-center justify-center"},lt={key:1},it={key:0,class:"mt-2 text-sm text-green-600"},dt={key:1,class:"mt-2 text-sm text-red-600"};function ut(x,e,n,r,m,_){const v=b("Link"),g=b("AdminLayout");return l(),C(g,{breadcrumbs:r.breadcrumbs},{default:h(()=>[t("div",V,[t("div",O,[e[2]||(e[2]=t("h1",{class:"text-3xl font-bold text-gray-900"},"Attempt Details",-1)),M(v,{href:x.route("admin.quiz-attempts.index"),class:"inline-flex items-center rounded-lg bg-gray-100 px-4 py-2 text-sm font-semibold text-gray-700 transition-colors duration-200 hover:bg-gray-200 focus:outline-hidden focus:ring-2 focus:ring-gray-300"},{default:h(()=>e[1]||(e[1]=[t("svg",{class:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),S(" Back to Attempts ")])),_:1},8,["href"])]),t("div",D,[e[11]||(e[11]=t("h2",{class:"mb-4 text-lg font-semibold text-gray-800"},"Summary",-1)),t("div",Q,[t("div",null,[e[3]||(e[3]=t("p",{class:"text-sm text-gray-700"},"User:",-1)),t("p",F,o(n.attempt.user.name)+" ("+o(n.attempt.user.email)+")",1)]),t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-700"},"Quiz:",-1)),t("p",U,o(n.attempt.quiz.title),1)]),t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-700"},"Auto Score:",-1)),t("p",I,o(n.attempt.score),1)]),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-gray-700"},"Manual Score:",-1)),t("p",W,o(n.attempt.manual_score??0),1)]),t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-gray-700"},"Total Score:",-1)),t("p",R,o(n.attempt.total_score),1)]),t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-700"},"Pass Threshold:",-1)),t("p",Y,o(n.attempt.quiz.pass_threshold)+"%",1)]),t("div",null,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-700"},"Status:",-1)),t("span",{class:w({"inline-flex rounded-full px-2 text-xs font-semibold leading-5":!0,"bg-green-100 text-green-800":n.attempt.passed,"bg-red-100 text-red-800":!n.attempt.passed})},o(n.attempt.passed?"Passed":"Failed"),3)]),t("div",null,[e[10]||(e[10]=t("p",{class:"text-sm text-gray-700"},"Completed At:",-1)),t("p",G,o(n.attempt.completed_at),1)])])]),t("div",H,[e[16]||(e[16]=t("h2",{class:"mb-4 text-lg font-semibold text-gray-800"},"Question Review",-1)),(l(!0),i(q,null,z(n.attempt.responses,(a,p)=>(l(),i("div",{key:p,class:"mb-6 rounded-lg bg-gray-50 p-4"},[t("h3",J,"Question "+o(p+1)+" ("+o(a.question.points||"N/A")+" points)",1),t("p",K,o(a.question.question_text),1),t("div",X,[e[13]||(e[13]=t("p",{class:"text-sm text-gray-700"},"Your Answer:",-1)),t("p",Z,o(a.answer||"No answer"),1),e[14]||(e[14]=t("p",{class:"text-sm text-gray-700"},"Correct Answer(s):",-1)),t("p",$,o(r.formatCorrectAnswer(a.question.correct_answer)),1),a.question.correct_answer_explanation?(l(),i("p",tt," Explanation: "+o(a.question.correct_answer_explanation),1)):u("",!0),t("p",{class:w(["text-sm",{"text-green-700":a.is_correct,"text-red-700":!a.is_correct&&a.is_correct!==null}])}," Status: "+o(a.is_correct!==null?a.is_correct?"Correct":"Incorrect":"Pending (Text)"),3),a.question.type==="text"&&!a.is_correct?(l(),i("div",et,[e[12]||(e[12]=t("label",{for:"manualScore",class:"mt-2 block text-sm font-medium text-gray-700"},"Manual Score (0-100):",-1)),E(t("input",{"onUpdate:modelValue":f=>r.manualScores[a.id]=f,type:"number",id:"manualScore",min:"0",max:"100",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter points",onChange:f=>r.updateManualScore(a.id,f.target.value)},null,40,st),[[j,r.manualScores[a.id],void 0,{number:!0}]]),r.manualScoreErrors[a.id]?(l(),i("p",at,o(r.manualScoreErrors[a.id]),1)):u("",!0)])):u("",!0)])]))),128)),r.hasManualScores?(l(),i("div",rt,[t("button",{onClick:e[0]||(e[0]=(...a)=>r.saveManualScores&&r.saveManualScores(...a)),disabled:r.saving||r.hasErrors,class:"w-full rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white transition-colors duration-200 hover:bg-indigo-700 focus:outline-hidden focus:ring-2 focus:ring-indigo-500"},[r.saving?(l(),i("span",nt,e[15]||(e[15]=[t("svg",{class:"mr-2 h-5 w-5 animate-spin text-white",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8h-8z"})],-1),S(" Saving... ")]))):(l(),i("span",lt,"Save Manual Scores"))],8,ot),r.success?(l(),i("div",it,"Scores saved successfully!")):u("",!0),r.hasErrors?(l(),i("div",dt,"Please fix the errors before saving.")):u("",!0)])):u("",!0)])])]),_:1},8,["breadcrumbs"])}const vt=P(T,[["render",ut],["__scopeId","data-v-748d1c15"]]);export{vt as default};
