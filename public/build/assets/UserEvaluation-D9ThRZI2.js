import{d as Ve,c as w,r as A,C as Ue,l as Z,bU as _e,p as Fe,bp as Ie,g as k,o as d,w as r,e as s,b as l,u as e,P as De,f as _,j as Ae,a as c,h as p,F as O,i as q,t as u,n as ce,s as Pe}from"./app-CCCS0CZF.js";import{_ as je}from"./AdminLayout.vue_vue_type_script_setup_true_lang-IFyItuqP.js";import{_ as z}from"./Button.vue_vue_type_script_setup_true_lang-D-fF9GCs.js";import{_ as Ne}from"./Input.vue_vue_type_script_setup_true_lang-BQ7YqneJ.js";import{_ as ve}from"./Textarea.vue_vue_type_script_setup_true_lang-ChASn6yT.js";import{_ as E}from"./Label.vue_vue_type_script_setup_true_lang-Di0JbUWQ.js";import{_ as N}from"./Card.vue_vue_type_script_setup_true_lang-CRkEhIeg.js";import{_ as C}from"./CardContent.vue_vue_type_script_setup_true_lang-DtVg1eqL.js";import{_ as ee}from"./CardDescription.vue_vue_type_script_setup_true_lang-CkNQtlWZ.js";import{_ as te}from"./CardHeader.vue_vue_type_script_setup_true_lang-CouQvq0a.js";import{_ as se}from"./CardTitle.vue_vue_type_script_setup_true_lang-Bh6tkZxp.js";import{_ as le,a as oe,b as re,c as ae,d as B}from"./SelectValue.vue_vue_type_script_setup_true_lang-B3jsAbAP.js";import{_ as Ce,a as Be}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-a1TMh0SK.js";import{_ as R}from"./index-DLMFaGQy.js";import{_ as Re,a as Me,b as Ge,c as Oe}from"./DialogTitle.vue_vue_type_script_setup_true_lang-g5x8m1zH.js";import{_ as qe}from"./DialogDescription.vue_vue_type_script_setup_true_lang-B6p-m_gc.js";import{_ as ze}from"./DialogFooter.vue_vue_type_script_setup_true_lang-ComP2_d1.js";import{_ as K,a as Q}from"./index-xB8l7wmf.js";import{_ as He}from"./Progress.vue_vue_type_script_setup_true_lang-Bi55sdX4.js";import{R as fe}from"./rotate-ccw-D9TNPjE0.js";import{U as Je}from"./user-DpRf7xAZ.js";import{L as W}from"./loader-circle-CDUaL_cf.js";import{C as ie}from"./circle-check-big-B8uw0VhS.js";import{T as Ke}from"./target-3AHfUO23.js";import{T as pe}from"./trending-up-Ch-IvgfC.js";import{D as Qe}from"./dollar-sign-VjcaeJhW.js";import{A as We}from"./award-qKzCAlFD.js";import{L as Xe}from"./layers-CXKJRtjl.js";import{S as Ye}from"./send-Cr1K760S.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-DQk27E9I.js";import"./index-DqS1P1ZA.js";import"./index-Cqm0A19K.js";import"./_plugin-vue_export-helper-BAqViWah.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DpFjYdO-.js";import"./clock-Bl_lmuQc.js";import"./useForwardPropsEmits-8FOKfY2W.js";import"./Presence-NDCzCsIB.js";import"./ConfigProvider-BOzqjy9z.js";import"./useForwardExpose-COCesWTN.js";import"./Teleport-gATq20kZ.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-Dk8Sntxr.js";import"./Collection-CUkQUq5R.js";import"./usePrimitiveElement-B5U8Xw_y.js";import"./check-BNsQs_6P.js";import"./useSize-DZ8A6S9i.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-CC1jLlt8.js";import"./RovingFocusItem-BKfRTdum.js";import"./VisuallyHiddenInput-C8AlVRBT.js";const Ze={class:"mx-auto max-w-7xl py-8 px-4 sm:px-6 lg:px-8 space-y-8"},et={class:"flex items-center justify-between"},tt={class:"flex items-center"},st={class:"shrink-0 mr-4"},lt={class:"flex items-center justify-center h-10 w-10 rounded-lg bg-primary/10"},ot={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},rt={class:"space-y-2"},at={class:"space-y-2"},it={class:"relative"},nt={key:0,class:"absolute right-8 top-2.5"},ut={key:0,class:"text-xs text-muted-foreground"},dt={key:1,class:"text-xs text-destructive"},mt={key:2,class:"text-sm text-destructive"},_t={class:"space-y-2"},ct={class:"relative"},vt={key:0,class:"absolute right-8 top-2.5"},ft={key:0,class:"text-xs text-muted-foreground"},pt={key:1,class:"text-xs text-destructive"},gt={key:2,class:"text-sm text-destructive"},xt={class:"space-y-2"},yt={key:0,class:"text-sm text-destructive"},bt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4 text-sm"},ht={key:0},wt={key:1},kt={key:2},$t={key:3},St={key:0,class:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},Tt={class:"flex items-center"},Lt={class:"text-yellow-800 text-sm"},Et={key:0,class:"space-y-6"},Vt={class:"flex items-center justify-between"},Ut={class:"grid gap-6"},Ft={class:"flex items-start justify-between"},It={class:"flex-1"},Dt={class:"flex items-center space-x-3 mb-2"},At={key:0,class:"text-right"},Pt={class:"text-2xl font-bold text-foreground"},jt={class:"text-xs text-muted-foreground"},Nt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ct={class:"space-y-4"},Bt={class:"flex-1 flex items-center justify-between"},Rt={class:"text-sm text-muted-foreground"},Mt={key:0,class:"text-sm text-destructive"},Gt={key:0,class:"space-y-4"},Ot={class:"space-y-3"},qt={class:"flex items-center justify-between"},zt={class:"flex items-center justify-between"},Ht={class:"text-sm font-bold"},Jt={class:"mt-6 space-y-2"},Kt={key:0,class:"text-sm text-destructive"},Qt={class:"flex items-center"},Wt={class:"shrink-0 mr-4"},Xt={class:"flex items-center justify-center h-10 w-10 rounded-lg bg-green-100"},Yt={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},Zt={class:"flex items-center"},es={class:"flex items-center"},ts={class:"text-2xl font-bold text-green-600"},ss={class:"flex items-center"},ls={class:"text-lg font-bold text-purple-600"},os={class:"font-semibold text-yellow-900 mb-2"},rs={class:"grid grid-cols-2 gap-4 text-sm text-yellow-700"},as={key:0},is={class:"font-bold"},ns={class:"space-y-2"},us={key:0,class:"text-sm text-destructive"},ds={key:2,class:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4"},ms={key:2},_s={key:3},cs={class:"flex items-start"},vs={class:"shrink-0 mr-4"},fs={class:"flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},ps={class:"flex-1"},gs={class:"font-semibold"},xs={class:"grid grid-cols-2 gap-4 text-sm"},ys={class:"font-medium"},bs={class:"font-medium"},hs={class:"font-medium"},ws={class:"font-medium"},ks={class:"font-medium"},$s={key:0},Ss={class:"font-medium"},Ts={key:1},$l=Ve({__name:"UserEvaluation",props:{users:{},categories:{},departments:{},courses:{},incentives:{},userLevels:{}},setup(ge){const V=ge,H=w(()=>V.users||[]),b=w(()=>V.categories||[]),xe=w(()=>V.departments||[]),M=w(()=>V.courses||[]),U=w(()=>V.incentives||[]);w(()=>V.userLevels||[]);const P=A(!1),X=A(!1),$=A(H.value),S=A(M.value),F=A(!1),I=A(!1),T=A(!0),a=Ue({user_id:null,course_id:null,department_id:null,evaluation_date:new Date().toISOString().split("T")[0],notes:"",categories:[]}),Y=()=>{a.categories=b.value.map(i=>({category_id:i.id,evaluation_type_id:null,comments:""}))};Z(()=>V.categories,()=>{Y()},{immediate:!0});const ye=i=>{T.value&&(a.department_id=i==="none"?null:parseInt(i))},be=i=>{T.value&&(a.user_id=i==="none"?null:parseInt(i))},he=i=>{T.value&&(a.course_id=i==="none"?null:parseInt(i))};Z(()=>a.department_id,async i=>{if(T.value){if(i){F.value=!0;try{const t=route("admin.evaluations.users-by-department"),n={department_id:i};console.log("Fetching users for department:",i);const o=await _e.get(t,{params:n});$.value=o.data.users||[]}catch(t){console.error("Error fetching users by department:",t),$.value=[]}finally{F.value=!1}}else $.value=H.value;a.user_id=null,a.course_id=null,S.value=M.value}}),Z(()=>a.user_id,async i=>{if(T.value){if(i){I.value=!0;try{const t=route("admin.evaluations.user-courses"),n={user_id:i},o=await _e.get(t,{params:n});S.value=o.data.courses||[]}catch(t){console.error("Error fetching user courses:",t);const n=$.value.find(o=>o.id===i);S.value=(n==null?void 0:n.completed_courses)||[]}finally{I.value=!1}}else S.value=M.value;a.course_id=null}});const v=w(()=>a.user_id&&$.value.find(i=>i.id===a.user_id)||null),G=w(()=>a.course_id&&S.value.find(i=>i.id===a.course_id)||null),L=(i,t)=>{if(!t)return null;const n=b.value.find(o=>o.id===i);return n&&n.types.find(o=>o.id===t)||null},f=w(()=>a.categories.reduce((i,t)=>{const n=L(t.category_id,t.evaluation_type_id);return i+((n==null?void 0:n.score_value)||0)},0)),ne=w(()=>{if(f.value===0||!v.value)return 0;const i=v.value;if(i.user_level&&i.user_level_tier){const n=U.value.find(o=>o.user_level_id===i.user_level.id&&o.user_level_tier_id===i.user_level_tier.id&&f.value>=o.min_score&&f.value<=o.max_score);if(n)return console.log("Found Level+Tier specific incentive:",n.incentive_amount),parseFloat(n.incentive_amount.toString())}if(i.user_level){const n=U.value.find(o=>o.user_level_id===i.user_level.id&&!o.user_level_tier_id&&f.value>=o.min_score&&f.value<=o.max_score);if(n)return console.log("Found Level-only incentive:",n.incentive_amount),parseFloat(n.incentive_amount.toString())}const t=U.value.find(n=>!n.user_level_id&&!n.user_level_tier_id&&f.value>=n.min_score&&f.value<=n.max_score);return t?parseFloat(t.incentive_amount.toString()):0}),D=w(()=>{if(f.value===0||!v.value)return null;const i=v.value;let t=null;return i.user_level&&i.user_level_tier&&(t=U.value.find(n=>n.user_level_id===i.user_level.id&&n.user_level_tier_id===i.user_level_tier.id&&f.value>=n.min_score&&f.value<=n.max_score)),!t&&i.user_level&&(t=U.value.find(n=>n.user_level_id===i.user_level.id&&!n.user_level_tier_id&&f.value>=n.min_score&&f.value<=n.max_score)),t||(t=U.value.find(n=>!n.user_level_id&&!n.user_level_tier_id&&f.value>=n.min_score&&f.value<=n.max_score)),t?{range:`${t.min_score}-${t.max_score}`,amount:parseFloat(t.incentive_amount.toString()),tier:we(t),level_info:t.user_level?t.user_level.name:"Global",tier_info:t.user_level_tier?t.user_level_tier.tier_name:null}:null}),we=(i,t)=>{if(i.user_level&&i.user_level_tier)return`${i.user_level.code} - ${i.user_level_tier.tier_name}`;if(i.user_level)return`${i.user_level.name} Level`;const o=[...U.value].filter(x=>!x.user_level_id&&!x.user_level_tier_id).sort((x,m)=>m.min_score-x.min_score).findIndex(x=>x.min_score===i.min_score&&x.max_score===i.max_score),y=["Exceptional Tier","Excellent Tier","Good Tier","Average Tier","Below Average Tier","Poor Tier","Very Poor Tier"];return o<y.length?y[o]:`Tier ${o+1}`},ue=i=>i>=13?{label:"Excellent",variant:"default"}:i>=10?{label:"Good",variant:"secondary"}:i>=7?{label:"Average",variant:"outline"}:i>=4?{label:"Below Average",variant:"secondary"}:i>=1?{label:"Poor",variant:"destructive"}:{label:"No Score",variant:"secondary"},ke=(i,t)=>{const n=i/t*100;return n>=90?"default":n>=80?"secondary":n>=70?"outline":n>=60?"secondary":"destructive"},$e=(i,t)=>{if(!T.value)return;const n=a.categories.findIndex(o=>o.category_id===i);n!==-1&&(a.categories[n].evaluation_type_id=parseInt(t),de())},de=()=>{X.value=!!(a.user_id&&a.course_id&&a.evaluation_date&&a.categories.length>0&&a.categories.every(i=>i.evaluation_type_id!==null))};function Se(){de(),X.value&&(P.value=!0)}function Te(){T.value&&a.post(route("admin.evaluations.user-evaluation.store"),{onSuccess:()=>{P.value=!1,a.reset(),$.value=H.value,S.value=M.value,Y()},onError:i=>{P.value=!1,console.error("Validation errors:",i)}})}function Le(){T.value&&(a.reset(),$.value=H.value,S.value=M.value,Y())}const Ee=[{name:"Dashboard",href:route("dashboard")},{name:"Evaluations",href:route("admin.evaluations.index")},{name:"User Evaluation",href:null}];return Fe(()=>{T.value=!1}),(i,t)=>{const n=Ie('else"');return d(),k(je,{breadcrumbs:Ee},{default:r(()=>[s("div",Ze,[s("div",null,[s("div",et,[t[5]||(t[5]=s("div",null,[s("h1",{class:"text-3xl font-bold text-foreground"},"User Performance Evaluation"),s("p",{class:"mt-2 text-sm text-muted-foreground"},"Assess employee performance with Level + Tier based incentive calculations.")],-1)),l(e(z),{as:e(De),href:i.route("admin.evaluations.index"),variant:"outline"},{default:r(()=>[l(e(fe),{class:"mr-2 h-4 w-4"}),t[4]||(t[4]=_(" Back to Evaluations "))]),_:1},8,["as","href"])])]),s("form",{onSubmit:Ae(Se,["prevent"]),class:"space-y-8"},[l(e(N),null,{default:r(()=>[l(e(te),null,{default:r(()=>[s("div",tt,[s("div",st,[s("div",lt,[l(e(Je),{class:"h-6 w-6 text-primary"})])]),s("div",null,[l(e(se),null,{default:r(()=>t[6]||(t[6]=[_("Select Department, Employee & Course")])),_:1}),l(e(ee),null,{default:r(()=>t[7]||(t[7]=[_("Choose department first, then employee, and finally their completed course")])),_:1})])])]),_:1}),l(e(C),null,{default:r(()=>{var o,y,x;return[s("div",ot,[s("div",rt,[l(e(E),{for:"department"},{default:r(()=>t[8]||(t[8]=[_("Select Department")])),_:1}),l(e(le),{"model-value":((o=e(a).department_id)==null?void 0:o.toString())||"none","onUpdate:modelValue":ye,disabled:e(a).processing},{default:r(()=>[l(e(oe),{id:"department"},{default:r(()=>[l(e(re),{placeholder:"All Departments"})]),_:1}),l(e(ae),null,{default:r(()=>[l(e(B),{value:"none"},{default:r(()=>t[9]||(t[9]=[_("All Departments")])),_:1}),(d(!0),c(O,null,q(xe.value,m=>(d(),k(e(B),{key:m.id,value:m.id.toString()},{default:r(()=>[_(u(m.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),t[10]||(t[10]=s("p",{class:"text-xs text-muted-foreground"},"Filter employees by department",-1))]),s("div",at,[l(e(E),{for:"user"},{default:r(()=>t[11]||(t[11]=[_("Select Employee *")])),_:1}),s("div",it,[l(e(le),{"model-value":((y=e(a).user_id)==null?void 0:y.toString())||"none","onUpdate:modelValue":be,disabled:e(a).processing||F.value},{default:r(()=>[l(e(oe),{id:"user"},{default:r(()=>[l(e(re),{placeholder:F.value?"Loading users...":"Choose an employee..."},null,8,["placeholder"])]),_:1}),l(e(ae),null,{default:r(()=>[l(e(B),{value:"none"},{default:r(()=>[_(u(F.value?"Loading users...":"Choose an employee..."),1)]),_:1}),(d(!0),c(O,null,q($.value,m=>(d(),k(e(B),{key:m.id,value:m.id.toString()},{default:r(()=>[_(u(m.name)+" "+u(m.department?`(${m.department.name})`:""),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),F.value?(d(),c("div",nt,[l(e(W),{class:"h-4 w-4 animate-spin text-primary"})])):p("",!0)]),e(a).department_id?$.value.length===0&&!F.value?(d(),c("p",dt,"No employees found in this department")):p("",!0):(d(),c("p",ut,"Showing all employees")),e(a).errors.user_id?(d(),c("span",mt,u(e(a).errors.user_id),1)):p("",!0)]),s("div",_t,[l(e(E),{for:"course"},{default:r(()=>t[12]||(t[12]=[_("Select Completed Course *")])),_:1}),s("div",ct,[l(e(le),{"model-value":((x=e(a).course_id)==null?void 0:x.toString())||"none","onUpdate:modelValue":he,disabled:e(a).processing||!e(a).user_id||I.value},{default:r(()=>[l(e(oe),{id:"course"},{default:r(()=>[l(e(re),{placeholder:e(a).user_id?I.value?"Loading courses...":"Choose a completed course...":"Select employee first..."},null,8,["placeholder"])]),_:1}),l(e(ae),null,{default:r(()=>[l(e(B),{value:"none"},{default:r(()=>[_(u(e(a).user_id?I.value?"Loading courses...":"Choose a completed course...":"Select employee first..."),1)]),_:1}),(d(!0),c(O,null,q(S.value,m=>(d(),k(e(B),{key:m.id,value:m.id.toString()},{default:r(()=>[_(u(m.title),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),I.value?(d(),c("div",vt,[l(e(W),{class:"h-4 w-4 animate-spin text-primary"})])):p("",!0)]),e(a).user_id?S.value.length===0&&!I.value?(d(),c("p",pt,"This employee hasn't completed any courses yet")):p("",!0):(d(),c("p",ft,"Select an employee to see their completed courses")),e(a).errors.course_id?(d(),c("span",gt,u(e(a).errors.course_id),1)):p("",!0)]),s("div",xt,[l(e(E),{for:"date"},{default:r(()=>t[13]||(t[13]=[_("Evaluation Date *")])),_:1}),l(e(Ne),{id:"date",type:"date",modelValue:e(a).evaluation_date,"onUpdate:modelValue":t[0]||(t[0]=m=>e(a).evaluation_date=m),disabled:e(a).processing,required:""},null,8,["modelValue","disabled"]),e(a).errors.evaluation_date?(d(),c("span",yt,u(e(a).errors.evaluation_date),1)):p("",!0)])]),v.value&&G.value?(d(),k(e(K),{key:0,class:"mt-6"},{default:r(()=>[l(e(ie),{class:"h-4 w-4"}),l(e(Q),null,{default:r(()=>[s("div",bt,[s("div",null,[t[14]||(t[14]=s("span",{class:"font-medium"},"Employee:",-1)),s("p",null,u(v.value.name),1)]),s("div",null,[t[15]||(t[15]=s("span",{class:"font-medium"},"Course:",-1)),s("p",null,u(G.value.title),1)]),G.value.completed_at?(d(),c("div",ht,[t[16]||(t[16]=s("span",{class:"font-medium"},"Completed:",-1)),s("p",null,u(new Date(G.value.completed_at).toLocaleDateString()),1)])):p("",!0),v.value.department?(d(),c("div",wt,[t[17]||(t[17]=s("span",{class:"font-medium"},"Department:",-1)),s("p",null,u(v.value.department.name),1)])):p("",!0),v.value.user_level?(d(),c("div",kt,[t[18]||(t[18]=s("span",{class:"font-medium"},"Level:",-1)),s("p",null,[l(e(R),{variant:"secondary",class:"text-xs"},{default:r(()=>[_(u(v.value.user_level.code)+" - "+u(v.value.user_level.name),1)]),_:1})])])):p("",!0),v.value.user_level_tier?(d(),c("div",$t,[t[19]||(t[19]=s("span",{class:"font-medium"},"Tier:",-1)),s("p",null,[l(e(R),{variant:"outline",class:"text-xs"},{default:r(()=>[_(u(v.value.user_level_tier.tier_name)+" (T"+u(v.value.user_level_tier.tier_order)+") ",1)]),_:1})])])):p("",!0)]),!v.value.user_level||!v.value.user_level_tier?(d(),c("div",St,[s("div",Tt,[l(e(Ke),{class:"h-4 w-4 text-yellow-600 mr-2"}),s("div",Lt,[t[20]||(t[20]=s("p",{class:"font-medium"},"Incomplete Assignment",-1)),s("p",null," This employee is missing "+u(v.value.user_level?"":"level assignment")+" "+u(!v.value.user_level&&!v.value.user_level_tier?" and ":"")+" "+u(v.value.user_level_tier?"":"tier assignment")+". Incentive calculation may fall back to global rates. ",1)])])])):p("",!0)]),_:1})]),_:1})):p("",!0)]}),_:1})]),_:1}),e(a).user_id&&e(a).course_id&&b.value.length>0?(d(),c("div",Et,[s("div",Vt,[t[21]||(t[21]=s("h2",{class:"text-xl font-semibold text-foreground"},"Evaluation Categories",-1)),l(e(R),{variant:"secondary"},{default:r(()=>[_(u(b.value.length)+" categories",1)]),_:1})]),s("div",Ut,[(d(!0),c(O,null,q(e(a).categories,(o,y)=>(d(),k(e(N),{key:o.category_id,class:"hover:shadow-md transition-shadow duration-200"},{default:r(()=>[l(e(te),null,{default:r(()=>{var x,m;return[s("div",Ft,[s("div",It,[s("div",Dt,[l(e(se),{class:"text-lg"},{default:r(()=>{var g;return[_(u(((g=b.value.find(h=>h.id===o.category_id))==null?void 0:g.name)||"Category"),1)]}),_:2},1024),l(e(R),{variant:"outline"},{default:r(()=>{var g;return[_(u(((g=b.value.find(h=>h.id===o.category_id))==null?void 0:g.weight)||0)+"% weight ",1)]}),_:2},1024)]),l(e(ee),null,{default:r(()=>{var g;return[_(u(((g=b.value.find(h=>h.id===o.category_id))==null?void 0:g.description)||"No description available"),1)]}),_:2},1024)]),L(o.category_id,o.evaluation_type_id)?(d(),c("div",At,[s("div",Pt,u((x=L(o.category_id,o.evaluation_type_id))==null?void 0:x.score_value),1),s("div",jt," out of "+u((m=b.value.find(g=>g.id===o.category_id))==null?void 0:m.max_score),1)])):p("",!0)])]}),_:2},1024),l(e(C),null,{default:r(()=>{var x;return[s("div",Nt,[s("div",Ct,[l(e(E),{class:"text-sm font-medium"},{default:r(()=>t[22]||(t[22]=[_("Select Performance Level")])),_:1}),l(e(Ce),{"model-value":((x=o.evaluation_type_id)==null?void 0:x.toString())||"","onUpdate:modelValue":m=>$e(o.category_id,m),class:"space-y-2"},{default:r(()=>{var m;return[(d(!0),c(O,null,q(((m=b.value.find(g=>g.id===o.category_id))==null?void 0:m.types)||[],g=>{var h;return d(),c("div",{key:g.id,class:ce(["flex items-center space-x-3 p-4 border rounded-lg hover:bg-accent/50 transition-colors",{"border-primary bg-primary/5":o.evaluation_type_id===g.id}])},[l(e(Be),{value:g.id.toString(),id:`type_${o.category_id}_${g.id}`},null,8,["value","id"]),s("div",Bt,[s("div",null,[l(e(E),{for:`type_${o.category_id}_${g.id}`,class:"font-medium cursor-pointer"},{default:r(()=>[_(u(g.type_name),1)]),_:2},1032,["for"]),s("p",Rt,u(g.description),1)]),l(e(R),{variant:ke(g.score_value,((h=b.value.find(J=>J.id===o.category_id))==null?void 0:h.max_score)||100)},{default:r(()=>[_(u(g.score_value)+" pts ",1)]),_:2},1032,["variant"])])],2)}),128))]}),_:2},1032,["model-value","onUpdate:modelValue"]),e(a).errors[`categories.${y}.evaluation_type_id`]?(d(),c("span",Mt,u(e(a).errors[`categories.${y}.evaluation_type_id`]),1)):p("",!0)]),L(o.category_id,o.evaluation_type_id)?(d(),c("div",Gt,[l(e(K),null,{default:r(()=>[l(e(pe),{class:"h-4 w-4"}),l(e(Q),null,{default:r(()=>{var m,g,h,J,me;return[t[25]||(t[25]=s("h4",{class:"font-medium mb-3"},"Selected Performance Level",-1)),s("div",Ot,[s("div",qt,[t[23]||(t[23]=s("span",{class:"text-sm font-medium"},"Performance:",-1)),l(e(R),{variant:ue(((m=L(o.category_id,o.evaluation_type_id))==null?void 0:m.score_value)||0).variant},{default:r(()=>{var j;return[_(u((j=L(o.category_id,o.evaluation_type_id))==null?void 0:j.type_name),1)]}),_:2},1032,["variant"])]),s("div",zt,[t[24]||(t[24]=s("span",{class:"text-sm font-medium"},"Score:",-1)),s("span",Ht,u((g=L(o.category_id,o.evaluation_type_id))==null?void 0:g.score_value)+" / "+u((h=b.value.find(j=>j.id===o.category_id))==null?void 0:h.max_score),1)]),l(e(He),{value:Math.round((((J=L(o.category_id,o.evaluation_type_id))==null?void 0:J.score_value)||0)/(((me=b.value.find(j=>j.id===o.category_id))==null?void 0:me.max_score)||100)*100),class:"h-2"},null,8,["value"])])]}),_:2},1024)]),_:2},1024)])):p("",!0)]),s("div",Jt,[l(e(E),{for:`comments_${o.category_id}`},{default:r(()=>t[26]||(t[26]=[_("Detailed Comments & Feedback")])),_:2},1032,["for"]),l(e(ve),{id:`comments_${o.category_id}`,modelValue:o.comments,"onUpdate:modelValue":m=>o.comments=m,rows:"3",disabled:e(a).processing,placeholder:"Provide specific feedback, strengths, areas for improvement, and recommendations..."},null,8,["id","modelValue","onUpdate:modelValue","disabled"]),e(a).errors[`categories.${y}.comments`]?(d(),c("span",Kt,u(e(a).errors[`categories.${y}.comments`]),1)):p("",!0)])]}),_:2},1024)]),_:2},1024))),128))])])):p("",!0),e(a).user_id&&e(a).course_id&&e(a).categories.some(o=>o.evaluation_type_id!==null)?(d(),k(e(N),{key:1},{default:r(()=>[l(e(te),null,{default:r(()=>[s("div",Qt,[s("div",Wt,[s("div",Xt,[l(e(ie),{class:"h-6 w-6 text-green-600"})])]),s("div",null,[l(e(se),null,{default:r(()=>t[27]||(t[27]=[_("Overall Assessment")])),_:1}),l(e(ee),null,{default:r(()=>t[28]||(t[28]=[_("Summary with Level + Tier based incentive calculation")])),_:1})])])]),_:1}),l(e(C),null,{default:r(()=>[s("div",Yt,[l(e(N),{class:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"},{default:r(()=>[l(e(C),{class:"p-4"},{default:r(()=>[s("div",Zt,[l(e(pe),{class:"h-8 w-8 text-blue-600 mr-4"}),s("div",null,[t[29]||(t[29]=s("p",{class:"text-sm font-medium text-blue-900"},"Total Score",-1)),s("p",{class:ce(["text-2xl font-bold",{"text-emerald-600":f.value>=13,"text-green-600":f.value>=10&&f.value<13,"text-blue-600":f.value>=7&&f.value<10,"text-yellow-600":f.value>=4&&f.value<7,"text-red-600":f.value<4}])},u(f.value),3)])])]),_:1})]),_:1}),l(e(N),{class:"bg-gradient-to-r from-green-50 to-emerald-50 border-green-200"},{default:r(()=>[l(e(C),{class:"p-4"},{default:r(()=>[s("div",es,[l(e(Qe),{class:"h-8 w-8 text-green-600 mr-4"}),s("div",null,[t[30]||(t[30]=s("p",{class:"text-sm font-medium text-green-900"},"Incentive Amount",-1)),s("p",ts," $"+u(ne.value.toFixed(2)),1)])])]),_:1})]),_:1}),l(e(N),{class:"bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200"},{default:r(()=>[l(e(C),{class:"p-4"},{default:r(()=>[s("div",ss,[l(e(We),{class:"h-8 w-8 text-purple-600 mr-4"}),s("div",null,[t[31]||(t[31]=s("p",{class:"text-sm font-medium text-purple-900"},"Performance Rating",-1)),s("p",ls,u(ue(f.value).label),1)])])]),_:1})]),_:1})]),D.value?(d(),k(e(K),{key:0,class:"mb-6 bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-200"},{default:r(()=>[l(e(Xe),{class:"h-4 w-4"}),l(e(Q),null,{default:r(()=>[s("h4",os,u(D.value.tier),1),s("div",rs,[s("div",null,[t[32]||(t[32]=s("span",{class:"font-medium"},"Incentive Level:",-1)),s("p",null,u(D.value.level_info),1)]),D.value.tier_info?(d(),c("div",as,[t[33]||(t[33]=s("span",{class:"font-medium"},"Performance Tier:",-1)),s("p",null,u(D.value.tier_info),1)])):p("",!0),s("div",null,[t[34]||(t[34]=s("span",{class:"font-medium"},"Score Range:",-1)),s("p",null,u(D.value.range)+" points",1)]),s("div",null,[t[35]||(t[35]=s("span",{class:"font-medium"},"Reward Amount:",-1)),s("p",is,"$"+u(D.value.amount.toFixed(2)),1)])])]),_:1})]),_:1})):p("",!0),s("div",ns,[l(e(E),{for:"notes"},{default:r(()=>t[36]||(t[36]=[_("Overall Notes & Recommendations")])),_:1}),l(e(ve),{id:"notes",modelValue:e(a).notes,"onUpdate:modelValue":t[1]||(t[1]=o=>e(a).notes=o),rows:"4",disabled:e(a).processing,placeholder:"Provide overall assessment, key achievements, development areas, goals for improvement, and recommendations for career development..."},null,8,["modelValue","disabled"]),e(a).errors.notes?(d(),c("span",us,u(e(a).errors.notes),1)):p("",!0)])]),_:1})]),_:1})):p("",!0),e(a).user_id&&e(a).course_id?(d(),c("div",ds,[l(e(z),{type:"button",onClick:Le,variant:"outline",disabled:e(a).processing},{default:r(()=>[l(e(fe),{class:"mr-2 h-4 w-4"}),t[37]||(t[37]=_(" Reset Form "))]),_:1},8,["disabled"]),l(e(z),{type:"submit",disabled:e(a).processing||!X.value||f.value===0},{default:r(()=>[e(a).processing?(d(),k(e(W),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(d(),k(e(Ye),{key:1,class:"mr-2 h-4 w-4"})),e(a).processing?(d(),c("span",ms,"Submitting Evaluation...")):(d(),c("span",_s,"Submit Evaluation"))]),_:1},8,["disabled"])])):p("",!0)],32)]),l(e(Re),{open:P.value,"onUpdate:open":t[3]||(t[3]=o=>P.value=o)},{default:r(()=>[l(e(Me),{class:"sm:max-w-lg"},{default:r(()=>[l(e(Ge),null,{default:r(()=>[s("div",cs,[s("div",vs,[s("div",fs,[l(e(ie),{class:"h-6 w-6 text-green-600"})])]),s("div",ps,[l(e(Oe),null,{default:r(()=>t[38]||(t[38]=[_("Confirm Evaluation Submission")])),_:1}),l(e(qe),null,{default:r(()=>{var o;return[t[39]||(t[39]=_(" Please review the evaluation details before submitting. This action will record the performance evaluation for ")),s("span",gs,u((o=v.value)==null?void 0:o.name),1),t[40]||(t[40]=_(". "))]}),_:1})])])]),_:1}),l(e(K),{class:"my-4"},{default:r(()=>[l(e(Q),null,{default:r(()=>{var o,y,x,m;return[t[47]||(t[47]=s("h4",{class:"font-medium mb-2"},"Evaluation Summary",-1)),s("div",xs,[s("div",null,[t[41]||(t[41]=s("span",{class:"text-muted-foreground"},"Employee:",-1)),s("p",ys,u((o=v.value)==null?void 0:o.name),1)]),s("div",null,[t[42]||(t[42]=s("span",{class:"text-muted-foreground"},"Course:",-1)),s("p",bs,u((y=G.value)==null?void 0:y.title),1)]),s("div",null,[t[43]||(t[43]=s("span",{class:"text-muted-foreground"},"Date:",-1)),s("p",hs,u(e(a).evaluation_date),1)]),s("div",null,[t[44]||(t[44]=s("span",{class:"text-muted-foreground"},"Total Score:",-1)),s("p",ws,u(f.value),1)]),s("div",null,[t[45]||(t[45]=s("span",{class:"text-muted-foreground"},"Incentive Amount:",-1)),s("p",ks,"$"+u(ne.value.toFixed(2)),1)]),(x=v.value)!=null&&x.user_level&&((m=v.value)!=null&&m.user_level_tier)?(d(),c("div",$s,[t[46]||(t[46]=s("span",{class:"text-muted-foreground"},"Level + Tier:",-1)),s("p",Ss,u(v.value.user_level.code)+" - "+u(v.value.user_level_tier.tier_name),1)])):p("",!0)])]}),_:1})]),_:1}),l(e(ze),null,{default:r(()=>[l(e(z),{onClick:t[2]||(t[2]=o=>P.value=!1),variant:"outline"},{default:r(()=>t[48]||(t[48]=[_(" Cancel ")])),_:1}),l(e(z),{onClick:Te,disabled:e(a).processing},{default:r(()=>[e(a).processing?(d(),k(e(W),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):p("",!0),e(a).processing?(d(),c("span",Ts,"Submitting...")):p("",!0),Pe((d(),c("span",null,t[49]||(t[49]=[_("Confirm & Submit")]))),[[n]])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})}}});export{$l as default};
