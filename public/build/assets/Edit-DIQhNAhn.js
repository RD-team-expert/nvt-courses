import{d as J,C as Q,r as U,l as K,a as u,o as d,b as s,u as e,m as O,w as o,e as i,P as T,f as a,j as X,g as p,h as f,n as g,t as m,F as R,i as Y,W as Z}from"./app-CnrnAeaW.js";import{m as ee,f as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-BcvwYufd.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-Chjbg-G7.js";import{_ as y}from"./Card.vue_vue_type_script_setup_true_lang-BrcYgiMV.js";import{_ as b}from"./CardContent.vue_vue_type_script_setup_true_lang-Bkw8NoLA.js";import{_ as h}from"./CardDescription.vue_vue_type_script_setup_true_lang-DdGkxQcd.js";import{_ as x}from"./CardHeader.vue_vue_type_script_setup_true_lang-CxLwTIth.js";import{_ as w}from"./CardTitle.vue_vue_type_script_setup_true_lang-DJukbwHJ.js";import{_ as C}from"./Input.vue_vue_type_script_setup_true_lang-iRX4HCfk.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-Cn4rj2Sy.js";import{_ as se}from"./Textarea.vue_vue_type_script_setup_true_lang-BzhoEEpt.js";import{_ as oe}from"./Switch.vue_vue_type_script_setup_true_lang-C6yzboyz.js";import{_ as ie,a as le,b as re,c as ae,d as de}from"./SelectValue.vue_vue_type_script_setup_true_lang-BctNH2ZG.js";import{_ as ne}from"./Separator.vue_vue_type_script_setup_true_lang-BX1ymvnp.js";import{_ as ue,a as me}from"./index-BFNklyDQ.js";import{A as fe}from"./arrow-left-cfWp3HBS.js";import{C as j}from"./chart-column-B7L6uJYu.js";import{S as ve}from"./square-play-ChfF8SXj.js";import{H as A,C as ce}from"./hard-drive-BNn7rU5U.js";import{C as _e}from"./circle-alert-DVTEwnWC.js";import{L as pe}from"./link-2-ClPwTT_8.js";import{L as ge}from"./loader-circle-luvfjwtZ.js";import{T as ye}from"./test-tube-Ba6axT37.js";import{I as F}from"./image-ChNbFmF7.js";import{T as M}from"./trash-2-CH_iNcNi.js";import{S as be}from"./save-C0iqIUyr.js";import"./index-Q-18rvuh.js";import"./index-DmlPtEYW.js";import"./_plugin-vue_export-helper-CKIavhZI.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DYfnJ9Qu.js";import"./clock-DPWjuP8V.js";import"./useForwardPropsEmits-DI9uWy15.js";import"./useForwardExpose-CQN9OsxU.js";import"./VisuallyHidden-COCh_rWM.js";import"./VisuallyHiddenInput-Dk7AQln8.js";import"./usePrimitiveElement-C4db3Ck2.js";import"./Presence-DCQFBocN.js";import"./ConfigProvider-B5NoWp14.js";import"./Teleport-vOCQia5l.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-BLgKkF5S.js";import"./Collection-Dj_8Pmx6.js";import"./check-DUjKDA9s.js";import"./useSize-DoZBn2Jt.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";const he={class:"max-w-4xl mx-auto space-y-6"},xe={class:"flex items-center gap-4"},we={class:"space-y-2"},ke={key:0,class:"text-sm text-destructive"},Ve={class:"space-y-2"},Se={key:0,class:"text-sm text-destructive"},$e={class:"space-y-2"},Ce={key:0,class:"text-sm text-destructive"},Ue={class:"flex items-center gap-4 p-4 bg-muted rounded-lg"},Te={class:"flex-1"},De={class:"font-semibold text-lg"},Le={class:"text-sm text-muted-foreground"},Pe={key:0,class:"space-y-3"},Re={key:0,class:"p-3 bg-muted/50 rounded-lg space-y-2"},je={key:0,class:"flex items-center justify-between text-sm"},Ae={class:"font-medium"},Fe={key:1,class:"flex items-center justify-between text-sm"},Me={class:"font-mono text-xs truncate max-w-md"},ze={key:0,class:"space-y-2"},Ee={class:"flex gap-2"},Be={key:0,class:"text-sm text-destructive"},Ge={class:"space-y-2"},Ne={class:"flex gap-2"},Ie={class:"flex items-center px-3 py-2 bg-muted rounded-md text-sm text-muted-foreground min-w-0"},qe={key:0,class:"text-sm text-destructive"},He={key:1,class:"text-sm text-muted-foreground"},We={key:0,class:"space-y-4"},Je={class:"mt-2 flex items-start gap-4"},Qe={class:"w-48 h-32 rounded-lg overflow-hidden bg-muted"},Ke=["src","alt"],Oe={class:"flex-1 space-y-2"},Xe={class:"flex gap-2"},Ye={class:"space-y-2"},Ze={class:"flex items-start gap-4"},et={class:"w-32 h-24 rounded-lg border-2 border-dashed border-muted-foreground/25 bg-muted/50 flex items-center justify-center overflow-hidden shrink-0"},tt=["src"],st={key:1,class:"text-center"},ot={class:"flex-1"},it={key:0,class:"text-sm text-destructive mt-1"},lt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},rt={class:"flex items-center justify-between"},at={class:"space-y-1"},dt={class:"grid grid-cols-2 gap-4"},nt={class:"text-center"},ut={class:"text-2xl font-bold text-blue-600"},mt={class:"text-center"},ft={class:"text-2xl font-bold text-green-600"},vt={class:"flex justify-between items-center"},ct={class:"flex gap-2"},as=J({__name:"Edit",props:{video:{},categories:{}},setup(z){var D;const v=z,E=[{title:"Video Management",href:"/admin/videos"},{title:"Edit Video",href:""}],l=Q({name:v.video.name,description:v.video.description||"",google_drive_url:v.video.google_drive_url,duration:v.video.duration,thumbnail:null,content_category_id:((D=v.video.content_category_id)==null?void 0:D.toString())||null,is_active:v.video.is_active,remove_thumbnail:!1}),S=U(!1),$=U(!1),k=U(null),B=r=>{var V;const n=(V=r.target.files)==null?void 0:V[0];if(n){l.thumbnail=n,l.remove_thumbnail=!1;const L=new FileReader;L.onload=W=>{var P;k.value=(P=W.target)==null?void 0:P.result},L.readAsDataURL(n)}else l.thumbnail=null,k.value=null},G=()=>{l.remove_thumbnail=!0,l.thumbnail=null,k.value=null},N=async()=>{if(l.google_drive_url){$.value=!0;try{console.log("Testing URL:",l.google_drive_url),await new Promise(r=>setTimeout(r,2e3)),alert("Video URL is valid!")}catch(r){console.error("URL test failed:",r),alert("Failed to validate video URL. Please check the link.")}finally{$.value=!1}}},I=r=>{if(!r)return"00:00";const t=Math.floor(r/3600),n=Math.floor(r%3600/60),V=r%60;return t>0?`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`:`${n.toString().padStart(2,"0")}:${V.toString().padStart(2,"0")}`},q=async()=>{S.value=!0,l.post(`/admin/videos/${v.video.id}/update`,{forceFormData:!0,onFinish:()=>{S.value=!1},onSuccess:()=>{console.log("Video updated successfully")},onError:r=>{console.error("Update failed:",r)}})},H=()=>{confirm(`Are you sure you want to delete "${v.video.name}"? This action cannot be undone and will remove all associated progress data.`)&&Z.delete(`/admin/videos/${v.video.id}`)};return K(()=>l.thumbnail,r=>{r&&(l.remove_thumbnail=!1)}),(r,t)=>(d(),u(R,null,[s(e(O),{title:`Edit ${r.video.name}`},null,8,["title"]),s(te,{breadcrumbs:E},{default:o(()=>[i("div",he,[i("div",xe,[s(e(_),{"as-child":"",variant:"ghost"},{default:o(()=>[s(e(T),{href:"/admin/videos"},{default:o(()=>[s(e(fe),{class:"h-4 w-4 mr-2"}),t[6]||(t[6]=a(" Back to Videos "))]),_:1})]),_:1}),t[8]||(t[8]=i("div",{class:"flex-1"},[i("h1",{class:"text-2xl font-bold"},"Edit Video Course"),i("p",{class:"text-muted-foreground"},"Update video course details and settings")],-1)),s(e(_),{"as-child":"",variant:"outline"},{default:o(()=>[s(e(T),{href:`/admin/videos/${r.video.id}`},{default:o(()=>[s(e(j),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=a(" View Analytics "))]),_:1},8,["href"])]),_:1})]),i("form",{onSubmit:X(q,["prevent"]),class:"space-y-6"},[s(e(y),null,{default:o(()=>[s(e(x),null,{default:o(()=>[s(e(w),{class:"flex items-center gap-2"},{default:o(()=>[s(e(ve),{class:"h-5 w-5"}),t[9]||(t[9]=a(" Video Information "))]),_:1}),s(e(h),null,{default:o(()=>t[10]||(t[10]=[a(" Update the basic details for your video course ")])),_:1})]),_:1}),s(e(b),{class:"space-y-4"},{default:o(()=>[i("div",we,[s(e(c),{for:"name"},{default:o(()=>t[11]||(t[11]=[a("Video Title")])),_:1}),s(e(C),{id:"name",modelValue:e(l).name,"onUpdate:modelValue":t[0]||(t[0]=n=>e(l).name=n),type:"text",placeholder:"Enter video course title...",class:g({"border-destructive":e(l).errors.name}),required:""},null,8,["modelValue","class"]),e(l).errors.name?(d(),u("div",ke,m(e(l).errors.name),1)):f("",!0)]),i("div",Ve,[s(e(c),{for:"description"},{default:o(()=>t[12]||(t[12]=[a("Description")])),_:1}),s(e(se),{id:"description",modelValue:e(l).description,"onUpdate:modelValue":t[1]||(t[1]=n=>e(l).description=n),placeholder:"Describe what students will learn from this video course...",rows:"5",class:g({"border-destructive":e(l).errors.description})},null,8,["modelValue","class"]),e(l).errors.description?(d(),u("div",Se,m(e(l).errors.description),1)):f("",!0)]),i("div",$e,[s(e(c),{for:"content_category_id"},{default:o(()=>t[13]||(t[13]=[a("Category")])),_:1}),s(e(ie),{modelValue:e(l).content_category_id,"onUpdate:modelValue":t[2]||(t[2]=n=>e(l).content_category_id=n)},{default:o(()=>[s(e(le),{class:g({"border-destructive":e(l).errors.content_category_id})},{default:o(()=>[s(e(re),{placeholder:"Select a category..."})]),_:1},8,["class"]),s(e(ae),null,{default:o(()=>[(d(!0),u(R,null,Y(r.categories,n=>(d(),p(e(de),{key:n.id,value:n.id.toString()},{default:o(()=>[a(m(n.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(l).errors.content_category_id?(d(),u("div",Ce,m(e(l).errors.content_category_id),1)):f("",!0),t[14]||(t[14]=i("div",{class:"text-sm text-muted-foreground"}," Select a category or leave unset for no category ",-1))])]),_:1})]),_:1}),r.video.storage_type?(d(),p(e(y),{key:0},{default:o(()=>[s(e(x),null,{default:o(()=>[s(e(w),{class:"flex items-center gap-2"},{default:o(()=>[s(e(A),{class:"h-5 w-5"}),t[15]||(t[15]=a(" Storage Information "))]),_:1}),s(e(h),null,{default:o(()=>t[16]||(t[16]=[a(" Current storage configuration (cannot be changed after creation) ")])),_:1})]),_:1}),s(e(b),{class:"space-y-4"},{default:o(()=>[i("div",Ue,[r.video.storage_type==="google_drive"?(d(),p(e(ce),{key:0,class:"h-8 w-8 text-blue-500"})):(d(),p(e(A),{key:1,class:"h-8 w-8 text-green-500"})),i("div",Te,[i("p",De,m(r.video.storage_type_label||(r.video.storage_type==="google_drive"?"Google Drive":"Local Storage")),1),i("p",Le,m(r.video.storage_type==="google_drive"?"Video stored on Google Drive":"Video stored on local server"),1)])]),r.video.storage_type==="local"?(d(),u("div",Pe,[s(e(ue),null,{default:o(()=>[s(e(_e),{class:"h-4 w-4"}),s(e(me),null,{default:o(()=>t[17]||(t[17]=[a(" Video files cannot be replaced after upload. To use a different video file, please create a new video entry. ")])),_:1})]),_:1}),r.video.formatted_file_size||r.video.file_path?(d(),u("div",Re,[r.video.formatted_file_size?(d(),u("div",je,[t[18]||(t[18]=i("span",{class:"text-muted-foreground"},"File Size:",-1)),i("span",Ae,m(r.video.formatted_file_size),1)])):f("",!0),r.video.file_path?(d(),u("div",Fe,[t[19]||(t[19]=i("span",{class:"text-muted-foreground"},"File Path:",-1)),i("span",Me,m(r.video.file_path),1)])):f("",!0)])):f("",!0)])):f("",!0)]),_:1})]),_:1})):f("",!0),s(e(y),null,{default:o(()=>[s(e(x),null,{default:o(()=>[s(e(w),{class:"flex items-center gap-2"},{default:o(()=>[s(e(pe),{class:"h-5 w-5"}),t[20]||(t[20]=a(" Video Source "))]),_:1}),s(e(h),null,{default:o(()=>[a(m(r.video.storage_type==="local"?"Video file information":"Update the video source and metadata"),1)]),_:1})]),_:1}),s(e(b),{class:"space-y-4"},{default:o(()=>[!r.video.storage_type||r.video.storage_type==="google_drive"?(d(),u("div",ze,[s(e(c),{for:"google_drive_url"},{default:o(()=>t[21]||(t[21]=[a("Google Drive Video URL")])),_:1}),i("div",Ee,[s(e(C),{id:"google_drive_url",modelValue:e(l).google_drive_url,"onUpdate:modelValue":t[3]||(t[3]=n=>e(l).google_drive_url=n),type:"url",placeholder:"https://drive.google.com/file/d/...",class:g({"border-destructive":e(l).errors.google_drive_url}),required:""},null,8,["modelValue","class"]),s(e(_),{type:"button",variant:"outline",size:"icon",onClick:N,disabled:!e(l).google_drive_url||$.value},{default:o(()=>[$.value?(d(),p(e(ge),{key:0,class:"h-4 w-4 animate-spin"})):(d(),p(e(ye),{key:1,class:"h-4 w-4"}))]),_:1},8,["disabled"])]),e(l).errors.google_drive_url?(d(),u("div",Be,m(e(l).errors.google_drive_url),1)):f("",!0),t[22]||(t[22]=i("div",{class:"text-sm text-muted-foreground"},' Paste the shareable link from Google Drive. Make sure the video is set to "Anyone with the link can view" ',-1))])):f("",!0),i("div",Ge,[s(e(c),{for:"duration"},{default:o(()=>t[23]||(t[23]=[a("Duration (seconds)")])),_:1}),i("div",Ne,[s(e(C),{id:"duration",modelValue:e(l).duration,"onUpdate:modelValue":t[4]||(t[4]=n=>e(l).duration=n),type:"number",min:"1",max:"86400",placeholder:"e.g., 3600 for 1 hour",class:g({"border-destructive":e(l).errors.duration})},null,8,["modelValue","class"]),i("div",Ie,m(I(e(l).duration)),1)]),e(l).errors.duration?(d(),u("div",qe,m(e(l).errors.duration),1)):f("",!0),r.video.storage_type==="local"?(d(),u("div",He," Duration for local videos (auto-detected during upload if available) ")):f("",!0)])]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[s(e(x),null,{default:o(()=>[s(e(w),{class:"flex items-center gap-2"},{default:o(()=>[s(e(F),{class:"h-5 w-5"}),t[24]||(t[24]=a(" Thumbnail "))]),_:1}),s(e(h),null,{default:o(()=>t[25]||(t[25]=[a(" Update or remove the video thumbnail ")])),_:1})]),_:1}),s(e(b),{class:"space-y-4"},{default:o(()=>[r.video.thumbnail_url?(d(),u("div",We,[i("div",null,[s(e(c),null,{default:o(()=>t[26]||(t[26]=[a("Current Thumbnail")])),_:1}),i("div",Je,[i("div",Qe,[i("img",{src:r.video.thumbnail_url,alt:r.video.name,class:"w-full h-full object-cover"},null,8,Ke)]),i("div",Oe,[t[28]||(t[28]=i("p",{class:"text-sm text-muted-foreground"}," Current thumbnail for this video course ",-1)),i("div",Xe,[s(e(_),{type:"button",variant:"outline",size:"sm",onClick:G},{default:o(()=>[s(e(M),{class:"h-4 w-4 mr-2"}),t[27]||(t[27]=a(" Remove Thumbnail "))]),_:1})])])])]),s(e(ne))])):f("",!0),i("div",Ye,[s(e(c),{for:"thumbnail"},{default:o(()=>[a(m(r.video.thumbnail_url?"Replace":"Upload")+" Thumbnail",1)]),_:1}),i("div",Ze,[i("div",et,[k.value?(d(),u("img",{key:0,src:k.value,class:"w-full h-full object-cover",alt:"New thumbnail preview"},null,8,tt)):(d(),u("div",st,[s(e(F),{class:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),t[29]||(t[29]=i("div",{class:"text-xs text-muted-foreground"},"Preview",-1))]))]),i("div",ot,[s(e(C),{id:"thumbnail",type:"file",accept:"image/*",class:g({"border-destructive":e(l).errors.thumbnail}),onChange:B},null,8,["class"]),e(l).errors.thumbnail?(d(),u("div",it,m(e(l).errors.thumbnail),1)):f("",!0),t[30]||(t[30]=i("div",{class:"text-sm text-muted-foreground mt-1"}," Recommended: 1280x720px (16:9 ratio), JPG or PNG, max 2MB ",-1))])])])]),_:1})]),_:1}),i("div",lt,[s(e(y),null,{default:o(()=>[s(e(x),null,{default:o(()=>[s(e(w),{class:"flex items-center gap-2"},{default:o(()=>[s(e(ee),{class:"h-5 w-5"}),t[31]||(t[31]=a(" Settings "))]),_:1}),s(e(h),null,{default:o(()=>t[32]||(t[32]=[a(" Configure the video course settings ")])),_:1})]),_:1}),s(e(b),null,{default:o(()=>[i("div",rt,[i("div",at,[s(e(c),null,{default:o(()=>t[33]||(t[33]=[a("Active Status")])),_:1}),t[34]||(t[34]=i("div",{class:"text-sm text-muted-foreground"}," Make this video course available to students ",-1))]),s(e(oe),{checked:e(l).is_active,"onUpdate:checked":t[5]||(t[5]=n=>e(l).is_active=n)},null,8,["checked"])])]),_:1})]),_:1}),s(e(y),null,{default:o(()=>[s(e(x),null,{default:o(()=>[s(e(w),{class:"flex items-center gap-2"},{default:o(()=>[s(e(j),{class:"h-5 w-5"}),t[35]||(t[35]=a(" Quick Statistics "))]),_:1}),s(e(h),null,{default:o(()=>t[36]||(t[36]=[a(" Current performance metrics ")])),_:1})]),_:1}),s(e(b),null,{default:o(()=>[i("div",dt,[i("div",nt,[i("div",ut,m(r.video.total_viewers||0),1),t[37]||(t[37]=i("div",{class:"text-xs text-muted-foreground"},"Viewers",-1))]),i("div",mt,[i("div",ft,m(Math.round(r.video.avg_completion||0))+"%",1),t[38]||(t[38]=i("div",{class:"text-xs text-muted-foreground"},"Avg Progress",-1))])])]),_:1})]),_:1})]),i("div",vt,[i("div",ct,[s(e(_),{"as-child":"",variant:"outline"},{default:o(()=>[s(e(T),{href:"/admin/videos"},{default:o(()=>t[39]||(t[39]=[a("Cancel")])),_:1})]),_:1}),s(e(_),{type:"button",variant:"destructive",onClick:H},{default:o(()=>[s(e(M),{class:"h-4 w-4 mr-2"}),t[40]||(t[40]=a(" Delete Video "))]),_:1})]),s(e(_),{type:"submit",disabled:S.value||e(l).processing},{default:o(()=>[s(e(be),{class:"h-4 w-4 mr-2"}),a(" "+m(S.value?"Updating...":"Update Video Course"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{as as default};
