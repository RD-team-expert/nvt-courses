import{d as Ue,c as w,r as A,C as Fe,l as Z,bU as _e,p as Ie,bp as De,g as k,o as d,w as a,e as s,b as l,u as e,P as ce,f as m,j as Ae,a as c,h as p,F as q,i as z,t as u,n as ve,s as Pe}from"./app-CMeuDvoP.js";import{_ as je}from"./AdminLayout.vue_vue_type_script_setup_true_lang-C9Hm6hTB.js";import{_ as C}from"./Button.vue_vue_type_script_setup_true_lang-qmd9sDVK.js";import{_ as Ce}from"./Input.vue_vue_type_script_setup_true_lang-DZXtcmjx.js";import{_ as fe}from"./Textarea.vue_vue_type_script_setup_true_lang-CvwGk7XG.js";import{_ as E}from"./Label.vue_vue_type_script_setup_true_lang-DBxN4hY4.js";import{_ as N}from"./Card.vue_vue_type_script_setup_true_lang-_3Mj6LHu.js";import{_ as B}from"./CardContent.vue_vue_type_script_setup_true_lang-BeAltFON.js";import{_ as ee}from"./CardDescription.vue_vue_type_script_setup_true_lang-CpjxZkaT.js";import{_ as te}from"./CardHeader.vue_vue_type_script_setup_true_lang-doEuB6qR.js";import{_ as se}from"./CardTitle.vue_vue_type_script_setup_true_lang-CuprtVDT.js";import{_ as le,a as oe,b as ae,c as re,d as R}from"./SelectValue.vue_vue_type_script_setup_true_lang-DZjIb0ip.js";import{_ as Ne,a as Be}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-VtHdq-Jp.js";import{_ as M}from"./index-DDsjInfw.js";import{_ as Re,a as Me,b as Oe,c as Ge}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BNKyDLwL.js";import{_ as qe}from"./DialogDescription.vue_vue_type_script_setup_true_lang-F6OTewSQ.js";import{_ as ze}from"./DialogFooter.vue_vue_type_script_setup_true_lang-ByDM0XRv.js";import{_ as K,a as Q}from"./index-Db-pHE1k.js";import{_ as He}from"./Progress.vue_vue_type_script_setup_true_lang-CLW6iSCF.js";import{R as pe}from"./rotate-ccw-CfXkXXYd.js";import{U as Je}from"./user-Dq3VwUjH.js";import{L as W}from"./loader-circle-ChKCPitx.js";import{C as ie}from"./circle-check-big-DeIXxT8N.js";import{T as Ke}from"./target-B6XZsdHg.js";import{T as ge}from"./trending-up-DFEHrZFn.js";import{D as Qe}from"./dollar-sign-DLo3qpHY.js";import{A as We}from"./award-zCz_yK94.js";import{L as Xe}from"./layers-BM8gntyb.js";import{S as Ye}from"./send-B_GYUdLr.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-JbSY-cOV.js";import"./index-BbgJk9qm.js";import"./index-BUcLHlOS.js";import"./_plugin-vue_export-helper-C_LD-aQG.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CxzE3VNR.js";import"./clock-CwXnKjpH.js";import"./useForwardPropsEmits-qYJfovx1.js";import"./Presence-CcFYE7wc.js";import"./ConfigProvider-CUlHPCjx.js";import"./useForwardExpose-CKDslz7x.js";import"./Teleport-Bey3z-fO.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-BRuxqL7U.js";import"./Collection-DUgtdtCq.js";import"./usePrimitiveElement-DDIbYEzp.js";import"./check-BRkZYSzi.js";import"./useSize-DSjsmeQI.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-B2tt79RZ.js";import"./RovingFocusItem-Cac_7YVY.js";import"./VisuallyHiddenInput-C9NDiwUZ.js";const Ze={class:"mx-auto max-w-7xl py-8 px-4 sm:px-6 lg:px-8 space-y-8"},et={class:"flex items-center justify-between"},tt={class:"flex gap-2"},st={class:"flex items-center"},lt={class:"shrink-0 mr-4"},ot={class:"flex items-center justify-center h-10 w-10 rounded-lg bg-primary/10"},at={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},rt={class:"space-y-2"},it={class:"space-y-2"},nt={class:"relative"},ut={key:0,class:"absolute right-8 top-2.5"},dt={key:0,class:"text-xs text-muted-foreground"},mt={key:1,class:"text-xs text-destructive"},_t={key:2,class:"text-sm text-destructive"},ct={class:"space-y-2"},vt={class:"relative"},ft={key:0,class:"absolute right-8 top-2.5"},pt={key:0,class:"text-xs text-muted-foreground"},gt={key:1,class:"text-xs text-destructive"},xt={key:2,class:"text-sm text-destructive"},yt={class:"space-y-2"},bt={key:0,class:"text-sm text-destructive"},ht={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4 text-sm"},wt={key:0},kt={key:1},$t={key:2},St={key:3},Tt={key:0,class:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},Lt={class:"flex items-center"},Et={class:"text-yellow-800 text-sm"},Vt={key:0,class:"space-y-6"},Ut={class:"flex items-center justify-between"},Ft={class:"grid gap-6"},It={class:"flex items-start justify-between"},Dt={class:"flex-1"},At={class:"flex items-center space-x-3 mb-2"},Pt={key:0,class:"text-right"},jt={class:"text-2xl font-bold text-foreground"},Ct={class:"text-xs text-muted-foreground"},Nt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Bt={class:"space-y-4"},Rt={class:"flex-1 flex items-center justify-between"},Mt={class:"text-sm text-muted-foreground"},Ot={key:0,class:"text-sm text-destructive"},Gt={key:0,class:"space-y-4"},qt={class:"space-y-3"},zt={class:"flex items-center justify-between"},Ht={class:"flex items-center justify-between"},Jt={class:"text-sm font-bold"},Kt={class:"mt-6 space-y-2"},Qt={key:0,class:"text-sm text-destructive"},Wt={class:"flex items-center"},Xt={class:"shrink-0 mr-4"},Yt={class:"flex items-center justify-center h-10 w-10 rounded-lg bg-green-100"},Zt={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},es={class:"flex items-center"},ts={class:"flex items-center"},ss={class:"text-2xl font-bold text-green-600"},ls={class:"flex items-center"},os={class:"text-lg font-bold text-purple-600"},as={class:"font-semibold text-yellow-900 mb-2"},rs={class:"grid grid-cols-2 gap-4 text-sm text-yellow-700"},is={key:0},ns={class:"font-bold"},us={class:"space-y-2"},ds={key:0,class:"text-sm text-destructive"},ms={key:2,class:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4"},_s={key:2},cs={key:3},vs={class:"flex items-start"},fs={class:"shrink-0 mr-4"},ps={class:"flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},gs={class:"flex-1"},xs={class:"font-semibold"},ys={class:"grid grid-cols-2 gap-4 text-sm"},bs={class:"font-medium"},hs={class:"font-medium"},ws={class:"font-medium"},ks={class:"font-medium"},$s={class:"font-medium"},Ss={key:0},Ts={class:"font-medium"},Ls={key:1},Sl=Ue({__name:"UserEvaluation",props:{users:{},categories:{},departments:{},courses:{},incentives:{},userLevels:{}},setup(xe){const V=xe,H=w(()=>V.users||[]),b=w(()=>V.categories||[]),ye=w(()=>V.departments||[]),O=w(()=>V.courses||[]),U=w(()=>V.incentives||[]);w(()=>V.userLevels||[]);const P=A(!1),X=A(!1),$=A(H.value),S=A(O.value),F=A(!1),I=A(!1),T=A(!0),r=Fe({user_id:null,course_id:null,department_id:null,evaluation_date:new Date().toISOString().split("T")[0],notes:"",categories:[]}),Y=()=>{r.categories=b.value.map(i=>({category_id:i.id,evaluation_type_id:null,comments:""}))};Z(()=>V.categories,()=>{Y()},{immediate:!0});const be=i=>{T.value&&(r.department_id=i==="none"?null:parseInt(i))},he=i=>{T.value&&(r.user_id=i==="none"?null:parseInt(i))},we=i=>{T.value&&(r.course_id=i==="none"?null:parseInt(i))};Z(()=>r.department_id,async i=>{if(T.value){if(i){F.value=!0;try{const t=route("admin.evaluations.users-by-department"),n={department_id:i};console.log("Fetching users for department:",i);const o=await _e.get(t,{params:n});$.value=o.data.users||[]}catch(t){console.error("Error fetching users by department:",t),$.value=[]}finally{F.value=!1}}else $.value=H.value;r.user_id=null,r.course_id=null,S.value=O.value}}),Z(()=>r.user_id,async i=>{if(T.value){if(i){I.value=!0;try{const t=route("admin.evaluations.user-courses"),n={user_id:i},o=await _e.get(t,{params:n});S.value=o.data.courses||[]}catch(t){console.error("Error fetching user courses:",t);const n=$.value.find(o=>o.id===i);S.value=(n==null?void 0:n.completed_courses)||[]}finally{I.value=!1}}else S.value=O.value;r.course_id=null}});const v=w(()=>r.user_id&&$.value.find(i=>i.id===r.user_id)||null),G=w(()=>r.course_id&&S.value.find(i=>i.id===r.course_id)||null),L=(i,t)=>{if(!t)return null;const n=b.value.find(o=>o.id===i);return n&&n.types.find(o=>o.id===t)||null},f=w(()=>r.categories.reduce((i,t)=>{const n=L(t.category_id,t.evaluation_type_id);return i+((n==null?void 0:n.score_value)||0)},0)),ne=w(()=>{if(f.value===0||!v.value)return 0;const i=v.value;if(i.user_level&&i.user_level_tier){const n=U.value.find(o=>o.user_level_id===i.user_level.id&&o.user_level_tier_id===i.user_level_tier.id&&f.value>=o.min_score&&f.value<=o.max_score);if(n)return console.log("Found Level+Tier specific incentive:",n.incentive_amount),parseFloat(n.incentive_amount.toString())}if(i.user_level){const n=U.value.find(o=>o.user_level_id===i.user_level.id&&!o.user_level_tier_id&&f.value>=o.min_score&&f.value<=o.max_score);if(n)return console.log("Found Level-only incentive:",n.incentive_amount),parseFloat(n.incentive_amount.toString())}const t=U.value.find(n=>!n.user_level_id&&!n.user_level_tier_id&&f.value>=n.min_score&&f.value<=n.max_score);return t?parseFloat(t.incentive_amount.toString()):0}),D=w(()=>{if(f.value===0||!v.value)return null;const i=v.value;let t=null;return i.user_level&&i.user_level_tier&&(t=U.value.find(n=>n.user_level_id===i.user_level.id&&n.user_level_tier_id===i.user_level_tier.id&&f.value>=n.min_score&&f.value<=n.max_score)),!t&&i.user_level&&(t=U.value.find(n=>n.user_level_id===i.user_level.id&&!n.user_level_tier_id&&f.value>=n.min_score&&f.value<=n.max_score)),t||(t=U.value.find(n=>!n.user_level_id&&!n.user_level_tier_id&&f.value>=n.min_score&&f.value<=n.max_score)),t?{range:`${t.min_score}-${t.max_score}`,amount:parseFloat(t.incentive_amount.toString()),tier:ke(t),level_info:t.user_level?t.user_level.name:"Global",tier_info:t.user_level_tier?t.user_level_tier.tier_name:null}:null}),ke=(i,t)=>{if(i.user_level&&i.user_level_tier)return`${i.user_level.code} - ${i.user_level_tier.tier_name}`;if(i.user_level)return`${i.user_level.name} Level`;const o=[...U.value].filter(x=>!x.user_level_id&&!x.user_level_tier_id).sort((x,_)=>_.min_score-x.min_score).findIndex(x=>x.min_score===i.min_score&&x.max_score===i.max_score),y=["Exceptional Tier","Excellent Tier","Good Tier","Average Tier","Below Average Tier","Poor Tier","Very Poor Tier"];return o<y.length?y[o]:`Tier ${o+1}`},ue=i=>i>=13?{label:"Excellent",variant:"default"}:i>=10?{label:"Good",variant:"secondary"}:i>=7?{label:"Average",variant:"outline"}:i>=4?{label:"Below Average",variant:"secondary"}:i>=1?{label:"Poor",variant:"destructive"}:{label:"No Score",variant:"secondary"},$e=(i,t)=>{const n=i/t*100;return n>=90?"default":n>=80?"secondary":n>=70?"outline":n>=60?"secondary":"destructive"},Se=(i,t)=>{if(!T.value)return;const n=r.categories.findIndex(o=>o.category_id===i);n!==-1&&(r.categories[n].evaluation_type_id=parseInt(t),de())},de=()=>{X.value=!!(r.user_id&&r.course_id&&r.evaluation_date&&r.categories.length>0&&r.categories.every(i=>i.evaluation_type_id!==null))};function Te(){de(),X.value&&(P.value=!0)}function Le(){T.value&&r.post(route("admin.evaluations.user-evaluation.store"),{onSuccess:()=>{P.value=!1,r.reset(),$.value=H.value,S.value=O.value,Y()},onError:i=>{P.value=!1,console.error("Validation errors:",i)}})}function Ee(){T.value&&(r.reset(),$.value=H.value,S.value=O.value,Y())}const Ve=[{name:"Dashboard",href:route("dashboard")},{name:"Evaluations",href:route("admin.evaluations.index")},{name:"User Evaluation",href:null}];return Ie(()=>{T.value=!1}),(i,t)=>{const n=De('else"');return d(),k(je,{breadcrumbs:Ve},{default:a(()=>[s("div",Ze,[s("div",null,[s("div",et,[t[6]||(t[6]=s("div",null,[s("h1",{class:"text-3xl font-bold text-foreground"},"User Performance Evaluation"),s("p",{class:"mt-2 text-sm text-muted-foreground"},"Assess employee performance with Level + Tier based incentive calculations.")],-1)),s("div",tt,[l(e(C),{as:e(ce),href:i.route("admin.evaluations.online.index"),variant:"outline"},{default:a(()=>t[4]||(t[4]=[m(" Online Courses ")])),_:1},8,["as","href"]),l(e(C),{as:e(ce),href:i.route("admin.evaluations.index"),variant:"outline"},{default:a(()=>[l(e(pe),{class:"mr-2 h-4 w-4"}),t[5]||(t[5]=m(" Back to Evaluations "))]),_:1},8,["as","href"])])])]),s("form",{onSubmit:Ae(Te,["prevent"]),class:"space-y-8"},[l(e(N),null,{default:a(()=>[l(e(te),null,{default:a(()=>[s("div",st,[s("div",lt,[s("div",ot,[l(e(Je),{class:"h-6 w-6 text-primary"})])]),s("div",null,[l(e(se),null,{default:a(()=>t[7]||(t[7]=[m("Select Department, Employee & Course")])),_:1}),l(e(ee),null,{default:a(()=>t[8]||(t[8]=[m("Choose department first, then employee, and finally their completed course")])),_:1})])])]),_:1}),l(e(B),null,{default:a(()=>{var o,y,x;return[s("div",at,[s("div",rt,[l(e(E),{for:"department"},{default:a(()=>t[9]||(t[9]=[m("Select Department")])),_:1}),l(e(le),{"model-value":((o=e(r).department_id)==null?void 0:o.toString())||"none","onUpdate:modelValue":be,disabled:e(r).processing},{default:a(()=>[l(e(oe),{id:"department"},{default:a(()=>[l(e(ae),{placeholder:"All Departments"})]),_:1}),l(e(re),null,{default:a(()=>[l(e(R),{value:"none"},{default:a(()=>t[10]||(t[10]=[m("All Departments")])),_:1}),(d(!0),c(q,null,z(ye.value,_=>(d(),k(e(R),{key:_.id,value:_.id.toString()},{default:a(()=>[m(u(_.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),t[11]||(t[11]=s("p",{class:"text-xs text-muted-foreground"},"Filter employees by department",-1))]),s("div",it,[l(e(E),{for:"user"},{default:a(()=>t[12]||(t[12]=[m("Select Employee *")])),_:1}),s("div",nt,[l(e(le),{"model-value":((y=e(r).user_id)==null?void 0:y.toString())||"none","onUpdate:modelValue":he,disabled:e(r).processing||F.value},{default:a(()=>[l(e(oe),{id:"user"},{default:a(()=>[l(e(ae),{placeholder:F.value?"Loading users...":"Choose an employee..."},null,8,["placeholder"])]),_:1}),l(e(re),null,{default:a(()=>[l(e(R),{value:"none"},{default:a(()=>[m(u(F.value?"Loading users...":"Choose an employee..."),1)]),_:1}),(d(!0),c(q,null,z($.value,_=>(d(),k(e(R),{key:_.id,value:_.id.toString()},{default:a(()=>[m(u(_.name)+" "+u(_.department?`(${_.department.name})`:""),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),F.value?(d(),c("div",ut,[l(e(W),{class:"h-4 w-4 animate-spin text-primary"})])):p("",!0)]),e(r).department_id?$.value.length===0&&!F.value?(d(),c("p",mt,"No employees found in this department")):p("",!0):(d(),c("p",dt,"Showing all employees")),e(r).errors.user_id?(d(),c("span",_t,u(e(r).errors.user_id),1)):p("",!0)]),s("div",ct,[l(e(E),{for:"course"},{default:a(()=>t[13]||(t[13]=[m("Select Completed Course *")])),_:1}),s("div",vt,[l(e(le),{"model-value":((x=e(r).course_id)==null?void 0:x.toString())||"none","onUpdate:modelValue":we,disabled:e(r).processing||!e(r).user_id||I.value},{default:a(()=>[l(e(oe),{id:"course"},{default:a(()=>[l(e(ae),{placeholder:e(r).user_id?I.value?"Loading courses...":"Choose a completed course...":"Select employee first..."},null,8,["placeholder"])]),_:1}),l(e(re),null,{default:a(()=>[l(e(R),{value:"none"},{default:a(()=>[m(u(e(r).user_id?I.value?"Loading courses...":"Choose a completed course...":"Select employee first..."),1)]),_:1}),(d(!0),c(q,null,z(S.value,_=>(d(),k(e(R),{key:_.id,value:_.id.toString()},{default:a(()=>[m(u(_.title),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),I.value?(d(),c("div",ft,[l(e(W),{class:"h-4 w-4 animate-spin text-primary"})])):p("",!0)]),e(r).user_id?S.value.length===0&&!I.value?(d(),c("p",gt,"This employee hasn't completed any courses yet")):p("",!0):(d(),c("p",pt,"Select an employee to see their completed courses")),e(r).errors.course_id?(d(),c("span",xt,u(e(r).errors.course_id),1)):p("",!0)]),s("div",yt,[l(e(E),{for:"date"},{default:a(()=>t[14]||(t[14]=[m("Evaluation Date *")])),_:1}),l(e(Ce),{id:"date",type:"date",modelValue:e(r).evaluation_date,"onUpdate:modelValue":t[0]||(t[0]=_=>e(r).evaluation_date=_),disabled:e(r).processing,required:""},null,8,["modelValue","disabled"]),e(r).errors.evaluation_date?(d(),c("span",bt,u(e(r).errors.evaluation_date),1)):p("",!0)])]),v.value&&G.value?(d(),k(e(K),{key:0,class:"mt-6"},{default:a(()=>[l(e(ie),{class:"h-4 w-4"}),l(e(Q),null,{default:a(()=>[s("div",ht,[s("div",null,[t[15]||(t[15]=s("span",{class:"font-medium"},"Employee:",-1)),s("p",null,u(v.value.name),1)]),s("div",null,[t[16]||(t[16]=s("span",{class:"font-medium"},"Course:",-1)),s("p",null,u(G.value.title),1)]),G.value.completed_at?(d(),c("div",wt,[t[17]||(t[17]=s("span",{class:"font-medium"},"Completed:",-1)),s("p",null,u(new Date(G.value.completed_at).toLocaleDateString()),1)])):p("",!0),v.value.department?(d(),c("div",kt,[t[18]||(t[18]=s("span",{class:"font-medium"},"Department:",-1)),s("p",null,u(v.value.department.name),1)])):p("",!0),v.value.user_level?(d(),c("div",$t,[t[19]||(t[19]=s("span",{class:"font-medium"},"Level:",-1)),s("p",null,[l(e(M),{variant:"secondary",class:"text-xs"},{default:a(()=>[m(u(v.value.user_level.code)+" - "+u(v.value.user_level.name),1)]),_:1})])])):p("",!0),v.value.user_level_tier?(d(),c("div",St,[t[20]||(t[20]=s("span",{class:"font-medium"},"Tier:",-1)),s("p",null,[l(e(M),{variant:"outline",class:"text-xs"},{default:a(()=>[m(u(v.value.user_level_tier.tier_name)+" (T"+u(v.value.user_level_tier.tier_order)+") ",1)]),_:1})])])):p("",!0)]),!v.value.user_level||!v.value.user_level_tier?(d(),c("div",Tt,[s("div",Lt,[l(e(Ke),{class:"h-4 w-4 text-yellow-600 mr-2"}),s("div",Et,[t[21]||(t[21]=s("p",{class:"font-medium"},"Incomplete Assignment",-1)),s("p",null," This employee is missing "+u(v.value.user_level?"":"level assignment")+" "+u(!v.value.user_level&&!v.value.user_level_tier?" and ":"")+" "+u(v.value.user_level_tier?"":"tier assignment")+". Incentive calculation may fall back to global rates. ",1)])])])):p("",!0)]),_:1})]),_:1})):p("",!0)]}),_:1})]),_:1}),e(r).user_id&&e(r).course_id&&b.value.length>0?(d(),c("div",Vt,[s("div",Ut,[t[22]||(t[22]=s("h2",{class:"text-xl font-semibold text-foreground"},"Evaluation Categories",-1)),l(e(M),{variant:"secondary"},{default:a(()=>[m(u(b.value.length)+" categories",1)]),_:1})]),s("div",Ft,[(d(!0),c(q,null,z(e(r).categories,(o,y)=>(d(),k(e(N),{key:o.category_id,class:"hover:shadow-md transition-shadow duration-200"},{default:a(()=>[l(e(te),null,{default:a(()=>{var x,_;return[s("div",It,[s("div",Dt,[s("div",At,[l(e(se),{class:"text-lg"},{default:a(()=>{var g;return[m(u(((g=b.value.find(h=>h.id===o.category_id))==null?void 0:g.name)||"Category"),1)]}),_:2},1024),l(e(M),{variant:"outline"},{default:a(()=>{var g;return[m(u(((g=b.value.find(h=>h.id===o.category_id))==null?void 0:g.weight)||0)+"% weight ",1)]}),_:2},1024)]),l(e(ee),null,{default:a(()=>{var g;return[m(u(((g=b.value.find(h=>h.id===o.category_id))==null?void 0:g.description)||"No description available"),1)]}),_:2},1024)]),L(o.category_id,o.evaluation_type_id)?(d(),c("div",Pt,[s("div",jt,u((x=L(o.category_id,o.evaluation_type_id))==null?void 0:x.score_value),1),s("div",Ct," out of "+u((_=b.value.find(g=>g.id===o.category_id))==null?void 0:_.max_score),1)])):p("",!0)])]}),_:2},1024),l(e(B),null,{default:a(()=>{var x;return[s("div",Nt,[s("div",Bt,[l(e(E),{class:"text-sm font-medium"},{default:a(()=>t[23]||(t[23]=[m("Select Performance Level")])),_:1}),l(e(Ne),{"model-value":((x=o.evaluation_type_id)==null?void 0:x.toString())||"","onUpdate:modelValue":_=>Se(o.category_id,_),class:"space-y-2"},{default:a(()=>{var _;return[(d(!0),c(q,null,z(((_=b.value.find(g=>g.id===o.category_id))==null?void 0:_.types)||[],g=>{var h;return d(),c("div",{key:g.id,class:ve(["flex items-center space-x-3 p-4 border rounded-lg hover:bg-accent/50 transition-colors",{"border-primary bg-primary/5":o.evaluation_type_id===g.id}])},[l(e(Be),{value:g.id.toString(),id:`type_${o.category_id}_${g.id}`},null,8,["value","id"]),s("div",Rt,[s("div",null,[l(e(E),{for:`type_${o.category_id}_${g.id}`,class:"font-medium cursor-pointer"},{default:a(()=>[m(u(g.type_name),1)]),_:2},1032,["for"]),s("p",Mt,u(g.description),1)]),l(e(M),{variant:$e(g.score_value,((h=b.value.find(J=>J.id===o.category_id))==null?void 0:h.max_score)||100)},{default:a(()=>[m(u(g.score_value)+" pts ",1)]),_:2},1032,["variant"])])],2)}),128))]}),_:2},1032,["model-value","onUpdate:modelValue"]),e(r).errors[`categories.${y}.evaluation_type_id`]?(d(),c("span",Ot,u(e(r).errors[`categories.${y}.evaluation_type_id`]),1)):p("",!0)]),L(o.category_id,o.evaluation_type_id)?(d(),c("div",Gt,[l(e(K),null,{default:a(()=>[l(e(ge),{class:"h-4 w-4"}),l(e(Q),null,{default:a(()=>{var _,g,h,J,me;return[t[26]||(t[26]=s("h4",{class:"font-medium mb-3"},"Selected Performance Level",-1)),s("div",qt,[s("div",zt,[t[24]||(t[24]=s("span",{class:"text-sm font-medium"},"Performance:",-1)),l(e(M),{variant:ue(((_=L(o.category_id,o.evaluation_type_id))==null?void 0:_.score_value)||0).variant},{default:a(()=>{var j;return[m(u((j=L(o.category_id,o.evaluation_type_id))==null?void 0:j.type_name),1)]}),_:2},1032,["variant"])]),s("div",Ht,[t[25]||(t[25]=s("span",{class:"text-sm font-medium"},"Score:",-1)),s("span",Jt,u((g=L(o.category_id,o.evaluation_type_id))==null?void 0:g.score_value)+" / "+u((h=b.value.find(j=>j.id===o.category_id))==null?void 0:h.max_score),1)]),l(e(He),{value:Math.round((((J=L(o.category_id,o.evaluation_type_id))==null?void 0:J.score_value)||0)/(((me=b.value.find(j=>j.id===o.category_id))==null?void 0:me.max_score)||100)*100),class:"h-2"},null,8,["value"])])]}),_:2},1024)]),_:2},1024)])):p("",!0)]),s("div",Kt,[l(e(E),{for:`comments_${o.category_id}`},{default:a(()=>t[27]||(t[27]=[m("Detailed Comments & Feedback")])),_:2},1032,["for"]),l(e(fe),{id:`comments_${o.category_id}`,modelValue:o.comments,"onUpdate:modelValue":_=>o.comments=_,rows:"3",disabled:e(r).processing,placeholder:"Provide specific feedback, strengths, areas for improvement, and recommendations..."},null,8,["id","modelValue","onUpdate:modelValue","disabled"]),e(r).errors[`categories.${y}.comments`]?(d(),c("span",Qt,u(e(r).errors[`categories.${y}.comments`]),1)):p("",!0)])]}),_:2},1024)]),_:2},1024))),128))])])):p("",!0),e(r).user_id&&e(r).course_id&&e(r).categories.some(o=>o.evaluation_type_id!==null)?(d(),k(e(N),{key:1},{default:a(()=>[l(e(te),null,{default:a(()=>[s("div",Wt,[s("div",Xt,[s("div",Yt,[l(e(ie),{class:"h-6 w-6 text-green-600"})])]),s("div",null,[l(e(se),null,{default:a(()=>t[28]||(t[28]=[m("Overall Assessment")])),_:1}),l(e(ee),null,{default:a(()=>t[29]||(t[29]=[m("Summary with Level + Tier based incentive calculation")])),_:1})])])]),_:1}),l(e(B),null,{default:a(()=>[s("div",Zt,[l(e(N),{class:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"},{default:a(()=>[l(e(B),{class:"p-4"},{default:a(()=>[s("div",es,[l(e(ge),{class:"h-8 w-8 text-blue-600 mr-4"}),s("div",null,[t[30]||(t[30]=s("p",{class:"text-sm font-medium text-blue-900"},"Total Score",-1)),s("p",{class:ve(["text-2xl font-bold",{"text-emerald-600":f.value>=13,"text-green-600":f.value>=10&&f.value<13,"text-blue-600":f.value>=7&&f.value<10,"text-yellow-600":f.value>=4&&f.value<7,"text-red-600":f.value<4}])},u(f.value),3)])])]),_:1})]),_:1}),l(e(N),{class:"bg-gradient-to-r from-green-50 to-emerald-50 border-green-200"},{default:a(()=>[l(e(B),{class:"p-4"},{default:a(()=>[s("div",ts,[l(e(Qe),{class:"h-8 w-8 text-green-600 mr-4"}),s("div",null,[t[31]||(t[31]=s("p",{class:"text-sm font-medium text-green-900"},"Incentive Amount",-1)),s("p",ss," $"+u(ne.value.toFixed(2)),1)])])]),_:1})]),_:1}),l(e(N),{class:"bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200"},{default:a(()=>[l(e(B),{class:"p-4"},{default:a(()=>[s("div",ls,[l(e(We),{class:"h-8 w-8 text-purple-600 mr-4"}),s("div",null,[t[32]||(t[32]=s("p",{class:"text-sm font-medium text-purple-900"},"Performance Rating",-1)),s("p",os,u(ue(f.value).label),1)])])]),_:1})]),_:1})]),D.value?(d(),k(e(K),{key:0,class:"mb-6 bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-200"},{default:a(()=>[l(e(Xe),{class:"h-4 w-4"}),l(e(Q),null,{default:a(()=>[s("h4",as,u(D.value.tier),1),s("div",rs,[s("div",null,[t[33]||(t[33]=s("span",{class:"font-medium"},"Incentive Level:",-1)),s("p",null,u(D.value.level_info),1)]),D.value.tier_info?(d(),c("div",is,[t[34]||(t[34]=s("span",{class:"font-medium"},"Performance Tier:",-1)),s("p",null,u(D.value.tier_info),1)])):p("",!0),s("div",null,[t[35]||(t[35]=s("span",{class:"font-medium"},"Score Range:",-1)),s("p",null,u(D.value.range)+" points",1)]),s("div",null,[t[36]||(t[36]=s("span",{class:"font-medium"},"Reward Amount:",-1)),s("p",ns,"$"+u(D.value.amount.toFixed(2)),1)])])]),_:1})]),_:1})):p("",!0),s("div",us,[l(e(E),{for:"notes"},{default:a(()=>t[37]||(t[37]=[m("Overall Notes & Recommendations")])),_:1}),l(e(fe),{id:"notes",modelValue:e(r).notes,"onUpdate:modelValue":t[1]||(t[1]=o=>e(r).notes=o),rows:"4",disabled:e(r).processing,placeholder:"Provide overall assessment, key achievements, development areas, goals for improvement, and recommendations for career development..."},null,8,["modelValue","disabled"]),e(r).errors.notes?(d(),c("span",ds,u(e(r).errors.notes),1)):p("",!0)])]),_:1})]),_:1})):p("",!0),e(r).user_id&&e(r).course_id?(d(),c("div",ms,[l(e(C),{type:"button",onClick:Ee,variant:"outline",disabled:e(r).processing},{default:a(()=>[l(e(pe),{class:"mr-2 h-4 w-4"}),t[38]||(t[38]=m(" Reset Form "))]),_:1},8,["disabled"]),l(e(C),{type:"submit",disabled:e(r).processing||!X.value||f.value===0},{default:a(()=>[e(r).processing?(d(),k(e(W),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(d(),k(e(Ye),{key:1,class:"mr-2 h-4 w-4"})),e(r).processing?(d(),c("span",_s,"Submitting Evaluation...")):(d(),c("span",cs,"Submit Evaluation"))]),_:1},8,["disabled"])])):p("",!0)],32)]),l(e(Re),{open:P.value,"onUpdate:open":t[3]||(t[3]=o=>P.value=o)},{default:a(()=>[l(e(Me),{class:"sm:max-w-lg"},{default:a(()=>[l(e(Oe),null,{default:a(()=>[s("div",vs,[s("div",fs,[s("div",ps,[l(e(ie),{class:"h-6 w-6 text-green-600"})])]),s("div",gs,[l(e(Ge),null,{default:a(()=>t[39]||(t[39]=[m("Confirm Evaluation Submission")])),_:1}),l(e(qe),null,{default:a(()=>{var o;return[t[40]||(t[40]=m(" Please review the evaluation details before submitting. This action will record the performance evaluation for ")),s("span",xs,u((o=v.value)==null?void 0:o.name),1),t[41]||(t[41]=m(". "))]}),_:1})])])]),_:1}),l(e(K),{class:"my-4"},{default:a(()=>[l(e(Q),null,{default:a(()=>{var o,y,x,_;return[t[48]||(t[48]=s("h4",{class:"font-medium mb-2"},"Evaluation Summary",-1)),s("div",ys,[s("div",null,[t[42]||(t[42]=s("span",{class:"text-muted-foreground"},"Employee:",-1)),s("p",bs,u((o=v.value)==null?void 0:o.name),1)]),s("div",null,[t[43]||(t[43]=s("span",{class:"text-muted-foreground"},"Course:",-1)),s("p",hs,u((y=G.value)==null?void 0:y.title),1)]),s("div",null,[t[44]||(t[44]=s("span",{class:"text-muted-foreground"},"Date:",-1)),s("p",ws,u(e(r).evaluation_date),1)]),s("div",null,[t[45]||(t[45]=s("span",{class:"text-muted-foreground"},"Total Score:",-1)),s("p",ks,u(f.value),1)]),s("div",null,[t[46]||(t[46]=s("span",{class:"text-muted-foreground"},"Incentive Amount:",-1)),s("p",$s,"$"+u(ne.value.toFixed(2)),1)]),(x=v.value)!=null&&x.user_level&&((_=v.value)!=null&&_.user_level_tier)?(d(),c("div",Ss,[t[47]||(t[47]=s("span",{class:"text-muted-foreground"},"Level + Tier:",-1)),s("p",Ts,u(v.value.user_level.code)+" - "+u(v.value.user_level_tier.tier_name),1)])):p("",!0)])]}),_:1})]),_:1}),l(e(ze),null,{default:a(()=>[l(e(C),{onClick:t[2]||(t[2]=o=>P.value=!1),variant:"outline"},{default:a(()=>t[49]||(t[49]=[m(" Cancel ")])),_:1}),l(e(C),{onClick:Le,disabled:e(r).processing},{default:a(()=>[e(r).processing?(d(),k(e(W),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):p("",!0),e(r).processing?(d(),c("span",Ls,"Submitting...")):p("",!0),Pe((d(),c("span",null,t[50]||(t[50]=[m("Confirm & Submit")]))),[[n]])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})}}});export{Sl as default};
