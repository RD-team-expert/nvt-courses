import{d as Pe,c as h,r as j,C as Fe,l as te,bU as ce,p as Ie,bp as je,g as k,o as d,w as o,e as s,b as l,u as t,P as ve,f as _,j as Ne,a as c,h as x,F as O,i as q,t as u,n as z,s as Ce}from"./app-B6yE8LOk.js";import{_ as Ae}from"./AdminLayout.vue_vue_type_script_setup_true_lang-Dla4wK9w.js";import{_ as A}from"./Button.vue_vue_type_script_setup_true_lang-BCmbLoyf.js";import{_ as Re}from"./Input.vue_vue_type_script_setup_true_lang-DZioDOGQ.js";import{_ as fe}from"./Textarea.vue_vue_type_script_setup_true_lang-DuROun2w.js";import{_ as V}from"./Label.vue_vue_type_script_setup_true_lang-W8iOXUBt.js";import{_ as G}from"./Card.vue_vue_type_script_setup_true_lang-DD4LNril.js";import{_ as H}from"./CardContent.vue_vue_type_script_setup_true_lang-CZheQe_Z.js";import{_ as se}from"./CardDescription.vue_vue_type_script_setup_true_lang-CXK7hJOE.js";import{_ as le}from"./CardHeader.vue_vue_type_script_setup_true_lang-CboW5KhX.js";import{_ as ae}from"./CardTitle.vue_vue_type_script_setup_true_lang-C-pTtL_h.js";import{_ as re,a as oe,b as ie,c as ne,d as R}from"./SelectValue.vue_vue_type_script_setup_true_lang-D42fbF8p.js";import{_ as Be,a as Me}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-BRxsEYpE.js";import{_ as D}from"./index-DI_vaViV.js";import{_ as Oe,a as qe,b as ze,c as Ge}from"./DialogTitle.vue_vue_type_script_setup_true_lang-PUQ632Gv.js";import{_ as He}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BxMSRjIA.js";import{_ as Je}from"./DialogFooter.vue_vue_type_script_setup_true_lang-BWGKtXkh.js";import{_ as Q,a as W}from"./index-C-9aVWff.js";import{_ as Ke}from"./Progress.vue_vue_type_script_setup_true_lang-vNPtqBVC.js";import{R as pe}from"./rotate-ccw-CgDfWFgp.js";import{U as Qe}from"./user-BktJVGdn.js";import{L as X}from"./loader-circle-2ygYPtIG.js";import{C as ue}from"./circle-check-big-ClmpUFBh.js";import{T as We}from"./target-At5fEJVK.js";import{T as ge}from"./trending-up-CnzlNIPq.js";import{A as xe}from"./award-D7vcc-qN.js";import{S as Xe}from"./send-9sf7xYHm.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-fW9bHL08.js";import"./index-ByyNcVWT.js";import"./index-Cm0BeycD.js";import"./_plugin-vue_export-helper-DSV2G5wh.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-ypd93s_P.js";import"./clock-TaqH5Jq1.js";import"./useForwardPropsEmits-SSLLGrJh.js";import"./Presence-Dm6ZMHfA.js";import"./ConfigProvider-C0zqv-SX.js";import"./useForwardExpose-CusEPu18.js";import"./Teleport-DPDyMkpW.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-Df01o_XA.js";import"./Collection-Dft6h26F.js";import"./usePrimitiveElement-iDJ2G07Q.js";import"./check-lhpFQjvm.js";import"./useSize-Cf-Feo3N.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-BPH1I801.js";import"./RovingFocusItem-B9ogzL8i.js";import"./VisuallyHiddenInput-BJFPeJ8Q.js";const Ye={class:"mx-auto max-w-7xl py-8 px-4 sm:px-6 lg:px-8 space-y-8"},Ze={class:"flex items-center justify-between"},et={class:"flex gap-2"},tt={class:"flex items-center"},st={class:"shrink-0 mr-4"},lt={class:"flex items-center justify-center h-10 w-10 rounded-lg bg-primary/10"},at={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},rt={class:"space-y-2"},ot={class:"space-y-2"},it={class:"relative"},nt={key:0,class:"absolute right-8 top-2.5"},ut={key:0,class:"text-xs text-muted-foreground"},dt={key:1,class:"text-xs text-destructive"},mt={key:2,class:"text-sm text-destructive"},_t={class:"space-y-2"},ct={class:"relative"},vt={key:0,class:"absolute right-8 top-2.5"},ft={key:0,class:"text-xs text-muted-foreground"},pt={key:1,class:"text-xs text-destructive"},gt={key:2,class:"text-sm text-destructive"},xt={class:"space-y-2"},yt={key:0,class:"text-sm text-destructive"},bt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-6 gap-4 text-sm"},ht={key:0},kt={key:1},wt={key:2},$t={key:3},St={key:0,class:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md"},Lt={class:"flex items-center"},Tt={class:"text-yellow-800 text-sm"},Ut={key:0,class:"space-y-6"},Et={class:"flex items-center justify-between"},Vt={class:"grid gap-6"},Dt={class:"flex items-start justify-between"},Pt={class:"flex-1"},Ft={class:"flex items-center space-x-3 mb-2"},It={key:0,class:"text-right"},jt={class:"text-2xl font-bold text-foreground"},Nt={class:"text-xs text-muted-foreground"},Ct={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},At={class:"space-y-4"},Rt={class:"flex-1 flex items-center justify-between"},Bt={class:"text-sm text-muted-foreground"},Mt={key:0,class:"text-sm text-destructive"},Ot={key:0,class:"space-y-4"},qt={class:"space-y-3"},zt={class:"flex items-center justify-between"},Gt={class:"flex items-center justify-between"},Ht={class:"text-sm font-bold"},Jt={class:"mt-6 space-y-2"},Kt={key:0,class:"text-sm text-destructive"},Qt={class:"flex items-center"},Wt={class:"shrink-0 mr-4"},Xt={class:"flex items-center justify-center h-10 w-10 rounded-lg bg-green-100"},Yt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Zt={class:"flex items-center"},es={class:"flex items-center"},ts={key:1,class:"text-xl font-bold text-gray-600"},ss={class:"grid grid-cols-2 gap-4 text-sm text-blue-700"},ls={class:"col-span-2"},as={class:"space-y-2"},rs={key:0,class:"text-sm text-destructive"},os={key:2,class:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4"},is={key:2},ns={key:3},us={class:"flex items-start"},ds={class:"shrink-0 mr-4"},ms={class:"flex items-center justify-center h-12 w-12 rounded-full bg-green-100"},_s={class:"flex-1"},cs={class:"font-semibold"},vs={class:"grid grid-cols-2 gap-4 text-sm"},fs={class:"font-medium"},ps={class:"font-medium"},gs={class:"font-medium"},xs={class:"font-medium"},ys={class:"font-medium"},bs={key:0},hs={class:"font-medium"},ks={key:1},xl=Pe({__name:"UserEvaluation",props:{users:{},categories:{},departments:{},courses:{},incentives:{},performanceLevels:{},userLevels:{}},setup(ye){const U=ye,J=h(()=>U.users||[]),w=h(()=>U.categories||[]),be=h(()=>U.departments||[]),B=h(()=>U.courses||[]),P=h(()=>U.incentives||[]);h(()=>U.userLevels||[]);const Y=h(()=>U.performanceLevels||[]),N=j(!1),Z=j(!1),S=j(J.value),L=j(B.value),F=j(!1),I=j(!1),T=j(!0),i=Fe({user_id:null,course_id:null,department_id:null,evaluation_date:new Date().toISOString().split("T")[0],notes:"",categories:[]}),ee=()=>{i.categories=w.value.map(r=>({category_id:r.id,evaluation_type_id:null,comments:""}))};te(()=>U.categories,()=>{ee()},{immediate:!0});const he=r=>{T.value&&(i.department_id=r==="none"?null:parseInt(r))},ke=r=>{T.value&&(i.user_id=r==="none"?null:parseInt(r))},we=r=>{T.value&&(i.course_id=r==="none"?null:parseInt(r))};te(()=>i.department_id,async r=>{if(T.value){if(r){F.value=!0;try{const e=route("admin.evaluations.users-by-department"),n={department_id:r};console.log("Fetching users for department:",r);const a=await ce.get(e,{params:n});S.value=a.data.users||[]}catch(e){console.error("Error fetching users by department:",e),S.value=[]}finally{F.value=!1}}else S.value=J.value;i.user_id=null,i.course_id=null,L.value=B.value}}),te(()=>i.user_id,async r=>{if(T.value){if(r){I.value=!0;try{const e=route("admin.evaluations.user-courses"),n={user_id:r},a=await ce.get(e,{params:n});L.value=a.data.courses||[]}catch(e){console.error("Error fetching user courses:",e);const n=S.value.find(a=>a.id===r);L.value=(n==null?void 0:n.completed_courses)||[]}finally{I.value=!1}}else L.value=B.value;i.course_id=null}});const f=h(()=>i.user_id&&S.value.find(r=>r.id===i.user_id)||null),M=h(()=>i.course_id&&L.value.find(r=>r.id===i.course_id)||null),E=(r,e)=>{if(!e)return null;const n=w.value.find(a=>a.id===r);return n&&n.types.find(a=>a.id===e)||null},v=h(()=>i.categories.reduce((r,e)=>{const n=E(e.category_id,e.evaluation_type_id);return r+((n==null?void 0:n.score_value)||0)},0)),b=h(()=>{if(!v.value||v.value===0)return null;const r=de(v.value);if(Y.value.length>0){const e=Y.value.find(n=>n.level===r);if(e)return e}if(r){let e,n,a,y,p,m;switch(r){case 1:e="Outstanding",n="green",a="badge-success",y=13,p=15,m="Consistently exceeds expectations";break;case 2:e="Reliable",n="blue",a="badge-info",y=10,p=12,m="Meets expectations consistently";break;case 3:e="Developing",n="yellow",a="badge-warning",y=7,p=9,m="Meets some expectations, needs improvement";break;case 4:e="Underperforming",n="red",a="badge-danger",y=0,p=6,m="Does not meet expectations";break}return{level:r,label:e,color:n,badge_class:a,min_score:y,max_score:p,description:m}}return null});h(()=>{if(v.value===0||!f.value)return 0;const r=f.value;if(r.user_level&&r.user_level_tier){const n=P.value.find(a=>a.user_level_id===r.user_level.id&&a.user_level_tier_id===r.user_level_tier.id&&v.value>=a.min_score&&v.value<=a.max_score);if(n)return parseFloat(n.incentive_amount.toString())}if(r.user_level){const n=P.value.find(a=>a.user_level_id===r.user_level.id&&!a.user_level_tier_id&&v.value>=a.min_score&&v.value<=a.max_score);if(n)return parseFloat(n.incentive_amount.toString())}const e=P.value.find(n=>!n.user_level_id&&!n.user_level_tier_id&&v.value>=n.min_score&&v.value<=n.max_score);return e?parseFloat(e.incentive_amount.toString()):0}),h(()=>{if(v.value===0||!f.value)return null;const r=f.value;let e=null;return r.user_level&&r.user_level_tier&&(e=P.value.find(n=>n.user_level_id===r.user_level.id&&n.user_level_tier_id===r.user_level_tier.id&&v.value>=n.min_score&&v.value<=n.max_score)),!e&&r.user_level&&(e=P.value.find(n=>n.user_level_id===r.user_level.id&&!n.user_level_tier_id&&v.value>=n.min_score&&v.value<=n.max_score)),e||(e=P.value.find(n=>!n.user_level_id&&!n.user_level_tier_id&&v.value>=n.min_score&&v.value<=n.max_score)),e?{range:`${e.min_score}-${e.max_score}`,amount:parseFloat(e.incentive_amount.toString()),tier:$e(e),level_info:e.user_level?e.user_level.name:"Global",tier_info:e.user_level_tier?e.user_level_tier.tier_name:null}:null});const $e=(r,e)=>{if(r.user_level&&r.user_level_tier)return`${r.user_level.code} - ${r.user_level_tier.tier_name}`;if(r.user_level)return`${r.user_level.name} Level`;const a=[...P.value].filter(p=>!p.user_level_id&&!p.user_level_tier_id).sort((p,m)=>m.min_score-p.min_score).findIndex(p=>p.min_score===r.min_score&&p.max_score===r.max_score),y=["Exceptional Tier","Excellent Tier","Good Tier","Average Tier","Below Average Tier","Poor Tier","Very Poor Tier"];return a<y.length?y[a]:`Tier ${a+1}`},de=r=>r>=13&&r<=15?1:r>=10&&r<=12?2:r>=7&&r<=9?3:r<7?4:null,Se=r=>{const e=de(r),n=Y.value.find(a=>a.level===e);return n?{label:n.label,variant:n.badge_class.replace("badge-","")||"default",color:n.color}:r>=13?{label:"Outstanding",variant:"success",color:"green"}:r>=10?{label:"Reliable",variant:"info",color:"blue"}:r>=7?{label:"Developing",variant:"warning",color:"yellow"}:r<7?{label:"Underperforming",variant:"destructive",color:"red"}:{label:"No Score",variant:"secondary",color:"gray"}},Le=(r,e)=>{const n=r/e*100;return n>=90?"default":n>=80?"secondary":n>=70?"outline":n>=60?"secondary":"destructive"},Te=(r,e)=>{if(!T.value)return;const n=i.categories.findIndex(a=>a.category_id===r);n!==-1&&(i.categories[n].evaluation_type_id=parseInt(e),me())},me=()=>{Z.value=!!(i.user_id&&i.course_id&&i.evaluation_date&&i.categories.length>0&&i.categories.every(r=>r.evaluation_type_id!==null))};function Ue(){me(),Z.value&&(N.value=!0)}function Ee(){T.value&&i.post(route("admin.evaluations.user-evaluation.store"),{onSuccess:()=>{N.value=!1,i.reset(),S.value=J.value,L.value=B.value,ee()},onError:r=>{N.value=!1,console.error("Validation errors:",r)}})}function Ve(){T.value&&(i.reset(),S.value=J.value,L.value=B.value,ee())}const De=[{name:"Dashboard",href:route("dashboard")},{name:"Evaluations",href:route("admin.evaluations.index")},{name:"User Evaluation",href:null}];return Ie(()=>{T.value=!1}),(r,e)=>{const n=je('else"');return d(),k(Ae,{breadcrumbs:De},{default:o(()=>[s("div",Ye,[s("div",null,[s("div",Ze,[e[6]||(e[6]=s("div",null,[s("h1",{class:"text-3xl font-bold text-foreground"},"User Performance Evaluation"),s("p",{class:"mt-2 text-sm text-muted-foreground"},"Assess employee performance with Level + Tier based incentive calculations.")],-1)),s("div",et,[l(t(A),{as:t(ve),href:r.route("admin.evaluations.online.index"),variant:"outline"},{default:o(()=>e[4]||(e[4]=[_(" Online Courses ")])),_:1},8,["as","href"]),l(t(A),{as:t(ve),href:r.route("admin.evaluations.index"),variant:"outline"},{default:o(()=>[l(t(pe),{class:"mr-2 h-4 w-4"}),e[5]||(e[5]=_(" Back to Evaluations "))]),_:1},8,["as","href"])])])]),s("form",{onSubmit:Ne(Ue,["prevent"]),class:"space-y-8"},[l(t(G),null,{default:o(()=>[l(t(le),null,{default:o(()=>[s("div",tt,[s("div",st,[s("div",lt,[l(t(Qe),{class:"h-6 w-6 text-primary"})])]),s("div",null,[l(t(ae),null,{default:o(()=>e[7]||(e[7]=[_("Select Department, Employee & Course")])),_:1}),l(t(se),null,{default:o(()=>e[8]||(e[8]=[_("Choose department first, then employee, and finally their completed course")])),_:1})])])]),_:1}),l(t(H),null,{default:o(()=>{var a,y,p;return[s("div",at,[s("div",rt,[l(t(V),{for:"department"},{default:o(()=>e[9]||(e[9]=[_("Select Department")])),_:1}),l(t(re),{"model-value":((a=t(i).department_id)==null?void 0:a.toString())||"none","onUpdate:modelValue":he,disabled:t(i).processing},{default:o(()=>[l(t(oe),{id:"department"},{default:o(()=>[l(t(ie),{placeholder:"All Departments"})]),_:1}),l(t(ne),null,{default:o(()=>[l(t(R),{value:"none"},{default:o(()=>e[10]||(e[10]=[_("All Departments")])),_:1}),(d(!0),c(O,null,q(be.value,m=>(d(),k(t(R),{key:m.id,value:m.id.toString()},{default:o(()=>[_(u(m.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),e[11]||(e[11]=s("p",{class:"text-xs text-muted-foreground"},"Filter employees by department",-1))]),s("div",ot,[l(t(V),{for:"user"},{default:o(()=>e[12]||(e[12]=[_("Select Employee *")])),_:1}),s("div",it,[l(t(re),{"model-value":((y=t(i).user_id)==null?void 0:y.toString())||"none","onUpdate:modelValue":ke,disabled:t(i).processing||F.value},{default:o(()=>[l(t(oe),{id:"user"},{default:o(()=>[l(t(ie),{placeholder:F.value?"Loading users...":"Choose an employee..."},null,8,["placeholder"])]),_:1}),l(t(ne),null,{default:o(()=>[l(t(R),{value:"none"},{default:o(()=>[_(u(F.value?"Loading users...":"Choose an employee..."),1)]),_:1}),(d(!0),c(O,null,q(S.value,m=>(d(),k(t(R),{key:m.id,value:m.id.toString()},{default:o(()=>[_(u(m.name)+" "+u(m.department?`(${m.department.name})`:""),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),F.value?(d(),c("div",nt,[l(t(X),{class:"h-4 w-4 animate-spin text-primary"})])):x("",!0)]),t(i).department_id?S.value.length===0&&!F.value?(d(),c("p",dt,"No employees found in this department")):x("",!0):(d(),c("p",ut,"Showing all employees")),t(i).errors.user_id?(d(),c("span",mt,u(t(i).errors.user_id),1)):x("",!0)]),s("div",_t,[l(t(V),{for:"course"},{default:o(()=>e[13]||(e[13]=[_("Select Completed Course *")])),_:1}),s("div",ct,[l(t(re),{"model-value":((p=t(i).course_id)==null?void 0:p.toString())||"none","onUpdate:modelValue":we,disabled:t(i).processing||!t(i).user_id||I.value},{default:o(()=>[l(t(oe),{id:"course"},{default:o(()=>[l(t(ie),{placeholder:t(i).user_id?I.value?"Loading courses...":"Choose a completed course...":"Select employee first..."},null,8,["placeholder"])]),_:1}),l(t(ne),null,{default:o(()=>[l(t(R),{value:"none"},{default:o(()=>[_(u(t(i).user_id?I.value?"Loading courses...":"Choose a completed course...":"Select employee first..."),1)]),_:1}),(d(!0),c(O,null,q(L.value,m=>(d(),k(t(R),{key:m.id,value:m.id.toString()},{default:o(()=>[_(u(m.title),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","disabled"]),I.value?(d(),c("div",vt,[l(t(X),{class:"h-4 w-4 animate-spin text-primary"})])):x("",!0)]),t(i).user_id?L.value.length===0&&!I.value?(d(),c("p",pt,"This employee hasn't completed any courses yet")):x("",!0):(d(),c("p",ft,"Select an employee to see their completed courses")),t(i).errors.course_id?(d(),c("span",gt,u(t(i).errors.course_id),1)):x("",!0)]),s("div",xt,[l(t(V),{for:"date"},{default:o(()=>e[14]||(e[14]=[_("Evaluation Date *")])),_:1}),l(t(Re),{id:"date",type:"date",modelValue:t(i).evaluation_date,"onUpdate:modelValue":e[0]||(e[0]=m=>t(i).evaluation_date=m),disabled:t(i).processing,required:""},null,8,["modelValue","disabled"]),t(i).errors.evaluation_date?(d(),c("span",yt,u(t(i).errors.evaluation_date),1)):x("",!0)])]),f.value&&M.value?(d(),k(t(Q),{key:0,class:"mt-6"},{default:o(()=>[l(t(ue),{class:"h-4 w-4"}),l(t(W),null,{default:o(()=>[s("div",bt,[s("div",null,[e[15]||(e[15]=s("span",{class:"font-medium"},"Employee:",-1)),s("p",null,u(f.value.name),1)]),s("div",null,[e[16]||(e[16]=s("span",{class:"font-medium"},"Course:",-1)),s("p",null,u(M.value.title),1)]),M.value.completed_at?(d(),c("div",ht,[e[17]||(e[17]=s("span",{class:"font-medium"},"Completed:",-1)),s("p",null,u(new Date(M.value.completed_at).toLocaleDateString()),1)])):x("",!0),f.value.department?(d(),c("div",kt,[e[18]||(e[18]=s("span",{class:"font-medium"},"Department:",-1)),s("p",null,u(f.value.department.name),1)])):x("",!0),f.value.user_level?(d(),c("div",wt,[e[19]||(e[19]=s("span",{class:"font-medium"},"Level:",-1)),s("p",null,[l(t(D),{variant:"secondary",class:"text-xs"},{default:o(()=>[_(u(f.value.user_level.code)+" - "+u(f.value.user_level.name),1)]),_:1})])])):x("",!0),f.value.user_level_tier?(d(),c("div",$t,[e[20]||(e[20]=s("span",{class:"font-medium"},"Tier:",-1)),s("p",null,[l(t(D),{variant:"outline",class:"text-xs"},{default:o(()=>[_(u(f.value.user_level_tier.tier_name)+" (T"+u(f.value.user_level_tier.tier_order)+") ",1)]),_:1})])])):x("",!0)]),!f.value.user_level||!f.value.user_level_tier?(d(),c("div",St,[s("div",Lt,[l(t(We),{class:"h-4 w-4 text-yellow-600 mr-2"}),s("div",Tt,[e[21]||(e[21]=s("p",{class:"font-medium"},"Incomplete Assignment",-1)),s("p",null," This employee is missing "+u(f.value.user_level?"":"level assignment")+" "+u(!f.value.user_level&&!f.value.user_level_tier?" and ":"")+" "+u(f.value.user_level_tier?"":"tier assignment")+". Performance level calculation may fall back to default values. ",1)])])])):x("",!0)]),_:1})]),_:1})):x("",!0)]}),_:1})]),_:1}),t(i).user_id&&t(i).course_id&&w.value.length>0?(d(),c("div",Ut,[s("div",Et,[e[22]||(e[22]=s("h2",{class:"text-xl font-semibold text-foreground"},"Evaluation Categories",-1)),l(t(D),{variant:"secondary"},{default:o(()=>[_(u(w.value.length)+" categories",1)]),_:1})]),s("div",Vt,[(d(!0),c(O,null,q(t(i).categories,(a,y)=>(d(),k(t(G),{key:a.category_id,class:"hover:shadow-md transition-shadow duration-200"},{default:o(()=>[l(t(le),null,{default:o(()=>{var p,m;return[s("div",Dt,[s("div",Pt,[s("div",Ft,[l(t(ae),{class:"text-lg"},{default:o(()=>{var g;return[_(u(((g=w.value.find($=>$.id===a.category_id))==null?void 0:g.name)||"Category"),1)]}),_:2},1024),l(t(D),{variant:"outline"},{default:o(()=>{var g;return[_(u(((g=w.value.find($=>$.id===a.category_id))==null?void 0:g.weight)||0)+"% weight ",1)]}),_:2},1024)]),l(t(se),null,{default:o(()=>{var g;return[_(u(((g=w.value.find($=>$.id===a.category_id))==null?void 0:g.description)||"No description available"),1)]}),_:2},1024)]),E(a.category_id,a.evaluation_type_id)?(d(),c("div",It,[s("div",jt,u((p=E(a.category_id,a.evaluation_type_id))==null?void 0:p.score_value),1),s("div",Nt," out of "+u((m=w.value.find(g=>g.id===a.category_id))==null?void 0:m.max_score),1)])):x("",!0)])]}),_:2},1024),l(t(H),null,{default:o(()=>{var p;return[s("div",Ct,[s("div",At,[l(t(V),{class:"text-sm font-medium"},{default:o(()=>e[23]||(e[23]=[_("Select Performance Level")])),_:1}),l(t(Be),{"model-value":((p=a.evaluation_type_id)==null?void 0:p.toString())||"","onUpdate:modelValue":m=>Te(a.category_id,m),class:"space-y-2"},{default:o(()=>{var m;return[(d(!0),c(O,null,q(((m=w.value.find(g=>g.id===a.category_id))==null?void 0:m.types)||[],g=>{var $;return d(),c("div",{key:g.id,class:z(["flex items-center space-x-3 p-4 border rounded-lg hover:bg-accent/50 transition-colors",{"border-primary bg-primary/5":a.evaluation_type_id===g.id}])},[l(t(Me),{value:g.id.toString(),id:`type_${a.category_id}_${g.id}`},null,8,["value","id"]),s("div",Rt,[s("div",null,[l(t(V),{for:`type_${a.category_id}_${g.id}`,class:"font-medium cursor-pointer"},{default:o(()=>[_(u(g.type_name),1)]),_:2},1032,["for"]),s("p",Bt,u(g.description),1)]),l(t(D),{variant:Le(g.score_value,(($=w.value.find(K=>K.id===a.category_id))==null?void 0:$.max_score)||100)},{default:o(()=>[_(u(g.score_value)+" pts ",1)]),_:2},1032,["variant"])])],2)}),128))]}),_:2},1032,["model-value","onUpdate:modelValue"]),t(i).errors[`categories.${y}.evaluation_type_id`]?(d(),c("span",Mt,u(t(i).errors[`categories.${y}.evaluation_type_id`]),1)):x("",!0)]),E(a.category_id,a.evaluation_type_id)?(d(),c("div",Ot,[l(t(Q),null,{default:o(()=>[l(t(ge),{class:"h-4 w-4"}),l(t(W),null,{default:o(()=>{var m,g,$,K,_e;return[e[26]||(e[26]=s("h4",{class:"font-medium mb-3"},"Selected Performance Level",-1)),s("div",qt,[s("div",zt,[e[24]||(e[24]=s("span",{class:"text-sm font-medium"},"Performance:",-1)),l(t(D),{variant:Se(((m=E(a.category_id,a.evaluation_type_id))==null?void 0:m.score_value)||0).variant},{default:o(()=>{var C;return[_(u((C=E(a.category_id,a.evaluation_type_id))==null?void 0:C.type_name),1)]}),_:2},1032,["variant"])]),s("div",Gt,[e[25]||(e[25]=s("span",{class:"text-sm font-medium"},"Score:",-1)),s("span",Ht,u((g=E(a.category_id,a.evaluation_type_id))==null?void 0:g.score_value)+" / "+u(($=w.value.find(C=>C.id===a.category_id))==null?void 0:$.max_score),1)]),l(t(Ke),{value:Math.round((((K=E(a.category_id,a.evaluation_type_id))==null?void 0:K.score_value)||0)/(((_e=w.value.find(C=>C.id===a.category_id))==null?void 0:_e.max_score)||100)*100),class:"h-2"},null,8,["value"])])]}),_:2},1024)]),_:2},1024)])):x("",!0)]),s("div",Jt,[l(t(V),{for:`comments_${a.category_id}`},{default:o(()=>e[27]||(e[27]=[_("Detailed Comments & Feedback")])),_:2},1032,["for"]),l(t(fe),{id:`comments_${a.category_id}`,modelValue:a.comments,"onUpdate:modelValue":m=>a.comments=m,rows:"3",disabled:t(i).processing,placeholder:"Provide specific feedback, strengths, areas for improvement, and recommendations..."},null,8,["id","modelValue","onUpdate:modelValue","disabled"]),t(i).errors[`categories.${y}.comments`]?(d(),c("span",Kt,u(t(i).errors[`categories.${y}.comments`]),1)):x("",!0)])]}),_:2},1024)]),_:2},1024))),128))])])):x("",!0),t(i).user_id&&t(i).course_id&&t(i).categories.some(a=>a.evaluation_type_id!==null)?(d(),k(t(G),{key:1},{default:o(()=>[l(t(le),null,{default:o(()=>[s("div",Qt,[s("div",Wt,[s("div",Xt,[l(t(ue),{class:"h-6 w-6 text-green-600"})])]),s("div",null,[l(t(ae),null,{default:o(()=>e[28]||(e[28]=[_("Overall Assessment")])),_:1}),l(t(se),null,{default:o(()=>e[29]||(e[29]=[_("Summary with Level + Tier based incentive calculation")])),_:1})])])]),_:1}),l(t(H),null,{default:o(()=>[s("div",Yt,[l(t(G),{class:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"},{default:o(()=>[l(t(H),{class:"p-4"},{default:o(()=>[s("div",Zt,[l(t(ge),{class:"h-8 w-8 text-blue-600 mr-4"}),s("div",null,[e[30]||(e[30]=s("p",{class:"text-sm font-medium text-blue-900"},"Total Score",-1)),s("p",{class:z(["text-2xl font-bold",{"text-emerald-600":v.value>=13,"text-green-600":v.value>=10&&v.value<13,"text-blue-600":v.value>=7&&v.value<10,"text-yellow-600":v.value>=4&&v.value<7,"text-red-600":v.value<4}])},u(v.value),3)])])]),_:1})]),_:1}),l(t(G),{class:"bg-gradient-to-r from-green-50 to-emerald-50 border-green-200"},{default:o(()=>[l(t(H),{class:"p-4"},{default:o(()=>[s("div",es,[l(t(xe),{class:"h-8 w-8 text-green-600 mr-4"}),s("div",null,[e[31]||(e[31]=s("p",{class:"text-sm font-medium text-green-900"},"Performance Level",-1)),b.value?(d(),c("p",{key:0,class:z(["text-xl font-bold",`text-${b.value.color}-600`])},u(b.value.label),3)):(d(),c("p",ts," Not Rated "))])])]),_:1})]),_:1})]),b.value?(d(),k(t(Q),{key:0,class:"mb-6 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200"},{default:o(()=>[l(t(xe),{class:"h-4 w-4"}),l(t(W),null,{default:o(()=>[e[35]||(e[35]=s("h4",{class:"font-semibold text-blue-900 mb-2"},"Performance Level Details",-1)),s("div",ss,[s("div",null,[e[32]||(e[32]=s("span",{class:"font-medium"},"Level:",-1)),s("p",{class:z(["font-bold",`text-${b.value.color}-600`])},u(b.value.label),3)]),s("div",null,[e[33]||(e[33]=s("span",{class:"font-medium"},"Score Range:",-1)),s("p",null,u(b.value.min_score)+"-"+u(b.value.max_score)+" points",1)]),s("div",ls,[e[34]||(e[34]=s("span",{class:"font-medium"},"Description:",-1)),s("p",null,u(b.value.description),1)])])]),_:1})]),_:1})):x("",!0),s("div",as,[l(t(V),{for:"notes"},{default:o(()=>e[36]||(e[36]=[_("Overall Notes & Recommendations")])),_:1}),l(t(fe),{id:"notes",modelValue:t(i).notes,"onUpdate:modelValue":e[1]||(e[1]=a=>t(i).notes=a),rows:"4",disabled:t(i).processing,placeholder:"Provide overall assessment, key achievements, development areas, goals for improvement, and recommendations for career development..."},null,8,["modelValue","disabled"]),t(i).errors.notes?(d(),c("span",rs,u(t(i).errors.notes),1)):x("",!0)])]),_:1})]),_:1})):x("",!0),t(i).user_id&&t(i).course_id?(d(),c("div",os,[l(t(A),{type:"button",onClick:Ve,variant:"outline",disabled:t(i).processing},{default:o(()=>[l(t(pe),{class:"mr-2 h-4 w-4"}),e[37]||(e[37]=_(" Reset Form "))]),_:1},8,["disabled"]),l(t(A),{type:"submit",disabled:t(i).processing||!Z.value||v.value===0},{default:o(()=>[t(i).processing?(d(),k(t(X),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):(d(),k(t(Xe),{key:1,class:"mr-2 h-4 w-4"})),t(i).processing?(d(),c("span",is,"Submitting Evaluation...")):(d(),c("span",ns,"Submit Evaluation"))]),_:1},8,["disabled"])])):x("",!0)],32)]),l(t(Oe),{open:N.value,"onUpdate:open":e[3]||(e[3]=a=>N.value=a)},{default:o(()=>[l(t(qe),{class:"sm:max-w-lg"},{default:o(()=>[l(t(ze),null,{default:o(()=>[s("div",us,[s("div",ds,[s("div",ms,[l(t(ue),{class:"h-6 w-6 text-green-600"})])]),s("div",_s,[l(t(Ge),null,{default:o(()=>e[38]||(e[38]=[_("Confirm Evaluation Submission")])),_:1}),l(t(He),null,{default:o(()=>{var a;return[e[39]||(e[39]=_(" Please review the evaluation details before submitting. This action will record the performance evaluation for ")),s("span",cs,u((a=f.value)==null?void 0:a.name),1),e[40]||(e[40]=_(". "))]}),_:1})])])]),_:1}),l(t(Q),{class:"my-4"},{default:o(()=>[l(t(W),null,{default:o(()=>{var a,y,p,m;return[e[48]||(e[48]=s("h4",{class:"font-medium mb-2"},"Evaluation Summary",-1)),s("div",vs,[s("div",null,[e[41]||(e[41]=s("span",{class:"text-muted-foreground"},"Employee:",-1)),s("p",fs,u((a=f.value)==null?void 0:a.name),1)]),s("div",null,[e[42]||(e[42]=s("span",{class:"text-muted-foreground"},"Course:",-1)),s("p",ps,u((y=M.value)==null?void 0:y.title),1)]),s("div",null,[e[43]||(e[43]=s("span",{class:"text-muted-foreground"},"Date:",-1)),s("p",gs,u(t(i).evaluation_date),1)]),s("div",null,[e[44]||(e[44]=s("span",{class:"text-muted-foreground"},"Total Score:",-1)),s("p",xs,u(v.value),1)]),s("div",null,[e[46]||(e[46]=s("span",{class:"text-muted-foreground"},"Performance Level:",-1)),s("p",ys,[b.value?(d(),k(t(D),{key:0,class:z(`bg-${b.value.color}-100 text-${b.value.color}-800 border-${b.value.color}-200`)},{default:o(()=>[_(u(b.value.label),1)]),_:1},8,["class"])):(d(),k(t(D),{key:1,variant:"secondary"},{default:o(()=>e[45]||(e[45]=[_(" Not Rated ")])),_:1}))])]),(p=f.value)!=null&&p.user_level&&((m=f.value)!=null&&m.user_level_tier)?(d(),c("div",bs,[e[47]||(e[47]=s("span",{class:"text-muted-foreground"},"Level + Tier:",-1)),s("p",hs,u(f.value.user_level.code)+" - "+u(f.value.user_level_tier.tier_name),1)])):x("",!0)])]}),_:1})]),_:1}),l(t(Je),null,{default:o(()=>[l(t(A),{onClick:e[2]||(e[2]=a=>N.value=!1),variant:"outline"},{default:o(()=>e[49]||(e[49]=[_(" Cancel ")])),_:1}),l(t(A),{onClick:Ee,disabled:t(i).processing},{default:o(()=>[t(i).processing?(d(),k(t(X),{key:0,class:"mr-2 h-4 w-4 animate-spin"})):x("",!0),t(i).processing?(d(),c("span",ks,"Submitting...")):x("",!0),Ce((d(),c("span",null,e[50]||(e[50]=[_("Confirm & Submit")]))),[[n]])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})}}});export{xl as default};
