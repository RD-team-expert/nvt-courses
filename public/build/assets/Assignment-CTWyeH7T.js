import{d as ve,r as v,k as _e,c as V,g as _,o,w as s,e as n,b as t,u as e,t as u,f as d,a as f,F as U,i as $,h as X,P as pe,W as ge}from"./app-sfv6CYbu.js";import{_ as xe}from"./AdminLayout.vue_vue_type_script_setup_true_lang-vvSRP-jI.js";import{_ as p}from"./Button.vue_vue_type_script_setup_true_lang-Ccdh52Vd.js";import{_ as he}from"./Input.vue_vue_type_script_setup_true_lang-PAMz5smE.js";import{_ as C}from"./Label.vue_vue_type_script_setup_true_lang-BH1zqArT.js";import{_ as w}from"./Card.vue_vue_type_script_setup_true_lang-C1bT-eXd.js";import{_ as A}from"./CardContent.vue_vue_type_script_setup_true_lang-Khif222k.js";import{_ as T}from"./CardDescription.vue_vue_type_script_setup_true_lang-Du745yLv.js";import{_ as W}from"./CardHeader.vue_vue_type_script_setup_true_lang-DnS62nQf.js";import{_ as I}from"./CardTitle.vue_vue_type_script_setup_true_lang-BUNiHSkD.js";import{_ as M,a as N,b as z,c as B,d as g}from"./SelectValue.vue_vue_type_script_setup_true_lang-BZdTdVyo.js";import{_ as ye,a as ke,b as G,c as S,d as we,e as L}from"./TableHeader.vue_vue_type_script_setup_true_lang-HEEiC_Nq.js";import{_ as O}from"./index-Dq640zwT.js";import{_ as Ae,b as be,C as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-BqoVmqtq.js";import{_ as q}from"./Checkbox.vue_vue_type_script_setup_true_lang-DkUE1Svg.js";import{U as J,X as Ue}from"./x-BJKYekbZ.js";import{B as $e}from"./building-2-2iVKYNHh.js";import{C as Ce}from"./chart-column-DY6VFw-F.js";import{T as Se}from"./triangle-alert-BvMIqfKd.js";import{U as K}from"./user-plus-Cle-zr6w.js";import{S as Y}from"./search-eRwwfKEd.js";import{E as Le}from"./eye-DypdyHnj.js";import{C as Z}from"./chevron-left-Dadp8I93.js";import"./index-DdH2r2B8.js";import"./index-C4PRPqD0.js";import"./useForwardPropsEmits--cawDwsm.js";import"./Presence-CHrFqoPB.js";import"./ConfigProvider-CuMY5RD4.js";import"./useForwardExpose-C32JnqdD.js";import"./Teleport-DTKdiWK5.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./Collection-DekOIFXO.js";import"./usePrimitiveElement-BTNjppil.js";import"./check-Bs2OgQiG.js";import"./useSize-C9jzGnps.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-oKHpmjgu.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DttcJlkw.js";import"./clock-DTvpSLd-.js";const De={class:"px-4 sm:px-0 space-y-6"},Pe={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Fe={class:"flex items-center"},Ve={class:"shrink-0"},je={class:"w-10 h-10 bg-primary rounded-lg flex items-center justify-center"},Me={class:"ml-4 flex-1"},Ne={class:"text-2xl font-bold text-foreground"},ze={class:"flex items-center"},Be={class:"shrink-0"},Ee={class:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center"},Te={class:"ml-4 flex-1"},We={class:"text-2xl font-bold text-foreground"},Ie={class:"flex items-center"},Oe={class:"shrink-0"},qe={class:"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center"},Qe={class:"ml-4 flex-1"},Re={class:"text-2xl font-bold text-foreground"},Xe={class:"flex items-center"},Ge={class:"shrink-0"},He={class:"w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center"},Je={class:"ml-4 flex-1"},Ke={class:"text-2xl font-bold text-foreground"},Ye={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},Ze={class:"space-y-2"},et={class:"space-y-2"},tt={class:"flex items-end"},lt={class:"flex items-center text-sm text-muted-foreground"},st={class:"ml-2"},at={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},nt={class:"space-y-2"},rt={class:"relative"},it={class:"space-y-2"},dt={class:"space-y-2"},ut={class:"flex items-end"},ot={class:"flex items-center justify-between"},mt={class:"flex items-center space-x-4"},ft={class:"flex items-center space-x-2"},ct={class:"overflow-x-auto"},vt={class:"flex items-center space-x-3"},_t={class:"font-medium text-foreground"},pt={class:"text-sm text-muted-foreground"},gt={key:0,class:"text-xs text-muted-foreground"},xt={key:1,class:"text-sm text-muted-foreground italic"},ht={key:0,class:"text-foreground"},yt={key:1,class:"text-sm text-muted-foreground italic"},kt={key:0,class:"flex items-center justify-between pt-4"},wt={class:"flex justify-between flex-1 sm:hidden"},At={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},bt={class:"text-sm text-muted-foreground"},Ut={class:"flex space-x-1"},j=20,fl=ve({__name:"Assignment",props:{users:Array,departments:Array,userLevels:Array,stats:Object},setup(c){const ee=c,i=v([]),x=v(""),h=v(""),D=v(""),P=v(""),F=v(""),m=v(1);_e(i,r=>{Array.isArray(r)||(i.value=[])},{deep:!0,immediate:!0});const y=V(()=>{let r=ee.users||[];if(D.value){const l=D.value.toLowerCase();r=r.filter(a=>a.name.toLowerCase().includes(l)||a.email.toLowerCase().includes(l)||a.employee_code&&a.employee_code.toLowerCase().includes(l))}return P.value&&(r=r.filter(l=>l.department===P.value)),F.value&&(r=r.filter(l=>l.level_code===F.value)),r}),k=V(()=>{const r=(m.value-1)*j,l=r+j;return y.value.slice(r,l)}),b=V(()=>Math.ceil(y.value.length/j)),te=(r,l)=>{if(Array.isArray(i.value)||(i.value=[]),l)i.value.includes(r)||i.value.push(r);else{const a=i.value.indexOf(r);a>-1&&i.value.splice(a,1)}},le=r=>Array.isArray(i.value)&&i.value.includes(r),se=r=>{if(Array.isArray(i.value)||(i.value=[]),r)k.value.map(a=>a.id).forEach(a=>{i.value.includes(a)||i.value.push(a)});else{const l=k.value.map(a=>a.id);i.value=i.value.filter(a=>!l.includes(a))}},Q=V(()=>!Array.isArray(i.value)||k.value.length===0?!1:k.value.every(r=>i.value.includes(r.id))),ae=V(()=>!Array.isArray(i.value)||k.value.length===0?!1:k.value.some(r=>i.value.includes(r.id))&&!Q.value),E=v(!1),ne=()=>{Array.isArray(i.value)||(i.value=[]),E.value?i.value=y.value.map(r=>r.id):i.value=[]},re=()=>{if(!Array.isArray(i.value)||i.value.length===0){alert("Please select at least one user");return}if(!x.value&&!h.value){alert("Please select a department or level to assign");return}const r={user_ids:i.value};x.value&&(r.department_id=x.value),h.value&&(r.user_level_id=h.value),ge.post(route("admin.users.bulk-assign"),r,{preserveState:!0,onSuccess:()=>{i.value=[],x.value="",h.value=""},onError:l=>{console.error("Assignment failed:",l),alert("Failed to assign users. Please try again.")}})},ie=()=>{D.value="",P.value="",F.value="",m.value=1},de=r=>{x.value=r==="select"?"":r},ue=r=>{h.value=r==="select"?"":r},oe=r=>{P.value=r==="all"?"":r},me=r=>{F.value=r==="all"?"":r},fe=r=>{switch(r){case"active":return"default";case"inactive":return"destructive";default:return"secondary"}},ce=[{name:"Dashboard",href:route("dashboard")},{name:"User Management",href:"#"},{name:"User Assignment",href:route("admin.users.assignment")}];return(r,l)=>(o(),_(xe,{breadcrumbs:ce},{default:s(()=>[n("div",De,[l[33]||(l[33]=n("div",null,[n("h1",{class:"text-xl sm:text-2xl font-bold text-foreground"},"User Assignment"),n("p",{class:"text-sm text-muted-foreground mt-1"},"Assign users to departments and organizational levels with bulk operations")],-1)),n("div",Pe,[t(e(w),null,{default:s(()=>[t(e(A),{class:"p-6"},{default:s(()=>{var a;return[n("div",Fe,[n("div",Ve,[n("div",je,[t(e(J),{class:"h-5 w-5 text-primary-foreground"})])]),n("div",Me,[l[6]||(l[6]=n("div",{class:"text-sm font-medium text-muted-foreground"},"Total Users",-1)),n("div",Ne,u(((a=c.stats)==null?void 0:a.total_users)||0),1)])])]}),_:1})]),_:1}),t(e(w),null,{default:s(()=>[t(e(A),{class:"p-6"},{default:s(()=>{var a;return[n("div",ze,[n("div",Be,[n("div",Ee,[t(e($e),{class:"h-5 w-5 text-white"})])]),n("div",Te,[l[7]||(l[7]=n("div",{class:"text-sm font-medium text-muted-foreground"},"With Departments",-1)),n("div",We,u(((a=c.stats)==null?void 0:a.with_departments)||0),1)])])]}),_:1})]),_:1}),t(e(w),null,{default:s(()=>[t(e(A),{class:"p-6"},{default:s(()=>{var a;return[n("div",Ie,[n("div",Oe,[n("div",qe,[t(e(Ce),{class:"h-5 w-5 text-white"})])]),n("div",Qe,[l[8]||(l[8]=n("div",{class:"text-sm font-medium text-muted-foreground"},"With Levels",-1)),n("div",Re,u(((a=c.stats)==null?void 0:a.with_levels)||0),1)])])]}),_:1})]),_:1}),t(e(w),null,{default:s(()=>[t(e(A),{class:"p-6"},{default:s(()=>{var a;return[n("div",Xe,[n("div",Ge,[n("div",He,[t(e(Se),{class:"h-5 w-5 text-white"})])]),n("div",Je,[l[9]||(l[9]=n("div",{class:"text-sm font-medium text-muted-foreground"},"Unassigned",-1)),n("div",Ke,u(((a=c.stats)==null?void 0:a.without_assignments)||0),1)])])]}),_:1})]),_:1})]),t(e(w),null,{default:s(()=>[t(e(W),null,{default:s(()=>[t(e(I),{class:"flex items-center"},{default:s(()=>[t(e(K),{class:"mr-2 h-5 w-5"}),l[10]||(l[10]=d(" Bulk Assignment "))]),_:1}),t(e(T),null,{default:s(()=>l[11]||(l[11]=[d("Assign multiple users to departments and levels simultaneously")])),_:1})]),_:1}),t(e(A),null,{default:s(()=>[n("div",Ye,[n("div",Ze,[t(e(C),null,{default:s(()=>l[12]||(l[12]=[d("Department")])),_:1}),t(e(M),{"model-value":x.value||"select","onUpdate:modelValue":de},{default:s(()=>[t(e(N),null,{default:s(()=>[t(e(z),{placeholder:"Select Department"})]),_:1}),t(e(B),null,{default:s(()=>[t(e(g),{value:"select"},{default:s(()=>l[13]||(l[13]=[d("Select Department")])),_:1}),(o(!0),f(U,null,$(c.departments,a=>(o(),_(e(g),{key:a.id,value:a.id.toString()},{default:s(()=>[d(u(a.name)+" ("+u(a.department_code)+") ",1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),n("div",et,[t(e(C),null,{default:s(()=>l[14]||(l[14]=[d("User Level")])),_:1}),t(e(M),{"model-value":h.value||"select","onUpdate:modelValue":ue},{default:s(()=>[t(e(N),null,{default:s(()=>[t(e(z),{placeholder:"Select Level"})]),_:1}),t(e(B),null,{default:s(()=>[t(e(g),{value:"select"},{default:s(()=>l[15]||(l[15]=[d("Select Level")])),_:1}),(o(!0),f(U,null,$(c.userLevels,a=>(o(),_(e(g),{key:a.id,value:a.id.toString()},{default:s(()=>[d(u(a.code)+" - "+u(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),n("div",tt,[t(e(p),{onClick:re,disabled:!Array.isArray(i.value)||i.value.length===0||!x.value&&!h.value,class:"w-full"},{default:s(()=>[t(e(K),{class:"mr-2 h-4 w-4"}),d(" Assign "+u(Array.isArray(i.value)?i.value.length:0)+" User(s) ",1)]),_:1},8,["disabled"])]),n("div",lt,[t(e(O),{variant:"secondary"},{default:s(()=>[d(u(Array.isArray(i.value)?i.value.length:0),1)]),_:1}),n("span",st,"of "+u(y.value.length)+" users selected",1)])])]),_:1})]),_:1}),t(e(w),null,{default:s(()=>[t(e(W),null,{default:s(()=>[t(e(I),{class:"flex items-center"},{default:s(()=>[t(e(Y),{class:"mr-2 h-5 w-5"}),l[16]||(l[16]=d(" Filters & Search "))]),_:1}),t(e(T),null,{default:s(()=>l[17]||(l[17]=[d("Filter and search users by various criteria")])),_:1})]),_:1}),t(e(A),null,{default:s(()=>[n("div",at,[n("div",nt,[t(e(C),null,{default:s(()=>l[18]||(l[18]=[d("Search")])),_:1}),n("div",rt,[t(e(Y),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),t(e(he),{modelValue:D.value,"onUpdate:modelValue":l[0]||(l[0]=a=>D.value=a),placeholder:"Name, email, or employee ID...",class:"pl-10"},null,8,["modelValue"])])]),n("div",it,[t(e(C),null,{default:s(()=>l[19]||(l[19]=[d("Filter by Department")])),_:1}),t(e(M),{"model-value":P.value||"all","onUpdate:modelValue":oe},{default:s(()=>[t(e(N),null,{default:s(()=>[t(e(z),{placeholder:"All Departments"})]),_:1}),t(e(B),null,{default:s(()=>[t(e(g),{value:"all"},{default:s(()=>l[20]||(l[20]=[d("All Departments")])),_:1}),(o(!0),f(U,null,$(c.departments,a=>(o(),_(e(g),{key:a.name,value:a.name},{default:s(()=>[d(u(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),n("div",dt,[t(e(C),null,{default:s(()=>l[21]||(l[21]=[d("Filter by Level")])),_:1}),t(e(M),{"model-value":F.value||"all","onUpdate:modelValue":me},{default:s(()=>[t(e(N),null,{default:s(()=>[t(e(z),{placeholder:"All Levels"})]),_:1}),t(e(B),null,{default:s(()=>[t(e(g),{value:"all"},{default:s(()=>l[22]||(l[22]=[d("All Levels")])),_:1}),(o(!0),f(U,null,$(c.userLevels,a=>(o(),_(e(g),{key:a.code,value:a.code},{default:s(()=>[d(u(a.code)+" - "+u(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),n("div",ut,[t(e(p),{onClick:ie,variant:"outline",class:"w-full"},{default:s(()=>[t(e(Ue),{class:"mr-2 h-4 w-4"}),l[23]||(l[23]=d(" Clear Filters "))]),_:1})])])]),_:1})]),_:1}),t(e(w),null,{default:s(()=>[t(e(W),null,{default:s(()=>[n("div",ot,[n("div",null,[t(e(I),{class:"flex items-center"},{default:s(()=>[t(e(J),{class:"mr-2 h-5 w-5"}),l[24]||(l[24]=d(" Users "))]),_:1}),t(e(T),null,{default:s(()=>l[25]||(l[25]=[d("Manage user assignments and organizational structure")])),_:1})]),n("div",mt,[n("div",ft,[t(e(q),{checked:E.value,"onUpdate:checked":l[1]||(l[1]=a=>{E.value=a,ne()})},null,8,["checked"]),t(e(C),{class:"text-sm"},{default:s(()=>[d("Select all "+u(y.value.length)+" users",1)]),_:1})])])])]),_:1}),t(e(A),null,{default:s(()=>[n("div",ct,[t(e(ye),null,{default:s(()=>[t(e(ke),null,{default:s(()=>[t(e(G),null,{default:s(()=>[t(e(S),{class:"w-12"},{default:s(()=>[t(e(q),{checked:Q.value,"onUpdate:checked":se,indeterminate:ae.value},null,8,["checked","indeterminate"])]),_:1}),t(e(S),null,{default:s(()=>l[26]||(l[26]=[d("User")])),_:1}),t(e(S),null,{default:s(()=>l[27]||(l[27]=[d("Level")])),_:1}),t(e(S),null,{default:s(()=>l[28]||(l[28]=[d("Department")])),_:1}),t(e(S),null,{default:s(()=>l[29]||(l[29]=[d("Status")])),_:1}),t(e(S),{class:"text-right"},{default:s(()=>l[30]||(l[30]=[d("Actions")])),_:1})]),_:1})]),_:1}),t(e(we),null,{default:s(()=>[(o(!0),f(U,null,$(k.value,a=>(o(),_(e(G),{key:a.id,class:"hover:bg-muted/50"},{default:s(()=>[t(e(L),null,{default:s(()=>[t(e(q),{checked:le(a.id),"onUpdate:checked":R=>te(a.id,R)},null,8,["checked","onUpdate:checked"])]),_:2},1024),t(e(L),null,{default:s(()=>[n("div",vt,[t(e(Ae),null,{default:s(()=>[t(e(be),{class:"bg-muted text-muted-foreground"},{default:s(()=>[d(u(a.name.charAt(0).toUpperCase()),1)]),_:2},1024)]),_:2},1024),n("div",null,[n("div",_t,u(a.name),1),n("div",pt,u(a.email),1),a.employee_code?(o(),f("div",gt,"ID: "+u(a.employee_code),1)):X("",!0)])])]),_:2},1024),t(e(L),null,{default:s(()=>[a.level?(o(),_(e(O),{key:0,variant:"secondary"},{default:s(()=>[d(u(a.level),1)]),_:2},1024)):(o(),f("span",xt,"No level"))]),_:2},1024),t(e(L),null,{default:s(()=>[a.department?(o(),f("span",ht,u(a.department),1)):(o(),f("span",yt,"No department"))]),_:2},1024),t(e(L),null,{default:s(()=>[t(e(O),{variant:fe(a.status)},{default:s(()=>[d(u(a.status),1)]),_:2},1032,["variant"])]),_:2},1024),t(e(L),{class:"text-right"},{default:s(()=>[t(e(p),{as:e(pe),href:r.route("admin.users.organizational",a.id),variant:"ghost",size:"sm"},{default:s(()=>[t(e(Le),{class:"h-4 w-4"})]),_:2},1032,["as","href"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),b.value>1?(o(),f("div",kt,[n("div",wt,[t(e(p),{onClick:l[2]||(l[2]=a=>m.value=Math.max(1,m.value-1)),disabled:m.value===1,variant:"outline"},{default:s(()=>[t(e(Z),{class:"mr-2 h-4 w-4"}),l[31]||(l[31]=d(" Previous "))]),_:1},8,["disabled"]),t(e(p),{onClick:l[3]||(l[3]=a=>m.value=Math.min(b.value,m.value+1)),disabled:m.value===b.value,variant:"outline"},{default:s(()=>[l[32]||(l[32]=d(" Next ")),t(e(H),{class:"ml-2 h-4 w-4"})]),_:1},8,["disabled"])]),n("div",At,[n("div",bt," Showing "+u((m.value-1)*j+1)+" to "+u(Math.min(m.value*j,y.value.length))+" of "+u(y.value.length)+" results ",1),n("div",Ut,[t(e(p),{onClick:l[4]||(l[4]=a=>m.value=Math.max(1,m.value-1)),disabled:m.value===1,variant:"outline",size:"sm"},{default:s(()=>[t(e(Z),{class:"h-4 w-4"})]),_:1},8,["disabled"]),(o(!0),f(U,null,$(Math.min(b.value,5),a=>(o(),_(e(p),{key:a,onClick:R=>m.value=a,variant:m.value===a?"default":"outline",size:"sm"},{default:s(()=>[d(u(a),1)]),_:2},1032,["onClick","variant"]))),128)),t(e(p),{onClick:l[5]||(l[5]=a=>m.value=Math.min(b.value,m.value+1)),disabled:m.value===b.value,variant:"outline",size:"sm"},{default:s(()=>[t(e(H),{class:"h-4 w-4"})]),_:1},8,["disabled"])])])])):X("",!0)])]),_:1})]),_:1})])]),_:1}))}});export{fl as default};
