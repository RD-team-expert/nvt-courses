import{d as E,r as z,c as G,C as L,a as c,o as n,b as l,u as t,m as W,w as i,e,P as I,f as u,t as o,g as p,h as _,F as h,i as C,n as X,W as $}from"./app-L8j0MxNq.js";import{f as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-D2dFfq6G.js";import{_ as y}from"./Button.vue_vue_type_script_setup_true_lang-CMvPfmOG.js";import{_ as S}from"./Card.vue_vue_type_script_setup_true_lang-mn2V_iBJ.js";import{_ as M}from"./CardContent.vue_vue_type_script_setup_true_lang-pp5_gIEr.js";import{_ as J}from"./CardDescription.vue_vue_type_script_setup_true_lang-CGH0efqP.js";import{_ as U}from"./CardHeader.vue_vue_type_script_setup_true_lang-CEavsptw.js";import{_ as T}from"./CardTitle.vue_vue_type_script_setup_true_lang-B8nisaQb.js";import{_ as f}from"./index-DdLnSGR7.js";import{_ as K}from"./Input.vue_vue_type_script_setup_true_lang-hj_S7N8O.js";import{_ as Y}from"./Label.vue_vue_type_script_setup_true_lang-Co9AyGFx.js";import{A as Z}from"./arrow-left-Be5TsHgD.js";import{R as q}from"./rotate-ccw-Bw5oVsTh.js";import{C as k}from"./circle-check-big-nbx_d-SI.js";import{C as V}from"./circle-x-Blxv4rgt.js";import{U as ee}from"./user-DfkOHcMc.js";import{T as te}from"./target-Cs-4L_YZ.js";import{A as se}from"./award-32MYDNb6.js";import{C as re}from"./clock-CHGnBdYY.js";import{S as ae}from"./save-BadujdLm.js";import"./index-DXAQBJhw.js";import"./index-PNOpA7EU.js";import"./_plugin-vue_export-helper-DKoqRaDP.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C6lbyBHx.js";const le={class:"max-w-5xl mx-auto space-y-6 pb-12"},oe={class:"flex items-center justify-between gap-4"},de={class:"flex items-center gap-4"},ie={class:"text-muted-foreground"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ue={class:"space-y-3"},me={class:"flex items-center gap-3"},ce={class:"font-medium"},pe={class:"text-sm text-muted-foreground"},fe={class:"flex items-center gap-3"},_e={class:"font-medium"},ge={class:"space-y-3"},xe={class:"flex items-center gap-3"},ve={class:"font-medium text-lg"},be={class:"text-muted-foreground text-base"},we={key:0,class:"text-xs text-muted-foreground"},he={class:"flex items-center gap-3"},ye={class:"font-medium"},ke={class:"flex items-start justify-between gap-4"},Ae={class:"flex items-start gap-3 flex-1"},ze={class:"flex-1"},Ce={class:"font-medium text-base"},$e={class:"flex items-center gap-2 mt-2"},Se={class:"text-right"},Me={key:0,class:"space-y-2 pl-12"},Ue={class:"flex items-center gap-2 flex-1"},Te=["type","checked"],Ve={class:"flex items-center gap-2"},Pe={key:1,class:"pl-12 space-y-3"},Be={class:"bg-muted/50 p-4 rounded-lg border"},Ne={class:"whitespace-pre-wrap"},je={key:0,class:"bg-yellow-50 dark:bg-yellow-950 p-4 rounded-lg border border-yellow-200 dark:border-yellow-800"},De={class:"flex items-end gap-3"},Fe={class:"flex-1"},Oe={key:2,class:"pl-12 mt-4"},Qe={class:"bg-blue-50 dark:bg-blue-950 p-4 rounded-lg border border-blue-200 dark:border-blue-800"},Re={class:"text-sm text-blue-800 dark:text-blue-200"},Ee={key:0,class:"flex justify-end pt-4 border-t"},pt=E({__name:"AttemptDetail",props:{attempt:{},user:{},quiz:{},module:{},course:{},questions:{}},setup(P){const d=P,B=[{title:"Course Online",href:"/admin/course-online"},{title:d.course.name,href:`/admin/course-online/${d.course.id}`},{title:d.quiz.title,href:"#"},{title:"Attempts",href:`/admin/course-online/${d.course.id}/modules/${d.module.id}/quiz/${d.quiz.id}/attempts`},{title:`Attempt #${d.attempt.attempt_number}`,href:"#"}],N=d.quiz.total_points>0?(d.attempt.total_score/d.quiz.total_points*100).toFixed(1):0,A=d.questions.filter(s=>s.type==="text"),g=z({});A.forEach(s=>{s.answer_id&&(g.value[s.answer_id]=s.points_earned)});const j=G(()=>A.length>0),x=L({grades:g.value});function D(){x.put(route("admin.module-quiz.grade-attempt",{courseOnline:d.course.id,courseModule:d.module.id,quiz:d.quiz.id,attempt:d.attempt.id}),{preserveScroll:!0})}function v(s,a){return s.correct_answer.includes(a)}function b(s,a){return s.user_answer?Array.isArray(s.user_answer)?s.user_answer.includes(a):s.user_answer===a:!1}function F(s){return s.user_answer?Array.isArray(s.user_answer)?s.user_answer.join(", "):s.user_answer:"No answer provided"}const w=z(!1);function O(){confirm(`Are you sure you want to reset ALL quiz attempts for ${d.user.name}?

This will:
- Delete all their attempts
- Delete all their answers
- Allow them to retake the quiz from scratch

This action cannot be undone!`)&&(w.value=!0,$.post(route("admin.module-quiz.reset-attempts",{courseOnline:d.course.id,courseModule:d.module.id,quiz:d.quiz.id}),{user_id:d.user.id},{onSuccess:()=>{$.visit(route("admin.module-quiz.attempts",{courseOnline:d.course.id,courseModule:d.module.id,quiz:d.quiz.id}))},onError:()=>{w.value=!1,alert("Failed to reset attempts. Please try again.")}}))}return(s,a)=>(n(),c(h,null,[l(t(W),{title:`Attempt #${s.attempt.attempt_number} - ${s.user.name}`},null,8,["title"]),l(H,{breadcrumbs:B},{default:i(()=>[e("div",le,[e("div",oe,[e("div",de,[l(t(y),{"as-child":"",variant:"ghost",size:"sm"},{default:i(()=>[l(t(I),{href:s.route("admin.module-quiz.attempts",{courseOnline:s.course.id,courseModule:s.module.id,quiz:s.quiz.id})},{default:i(()=>[l(t(Z),{class:"h-4 w-4 mr-2"}),a[0]||(a[0]=u(" Back to Attempts "))]),_:1},8,["href"])]),_:1}),e("div",null,[a[1]||(a[1]=e("h1",{class:"text-2xl font-bold"},"Quiz Attempt Details",-1)),e("p",ie,o(s.quiz.title),1)])]),l(t(y),{variant:"destructive",onClick:O,disabled:w.value},{default:i(()=>[l(t(q),{class:"h-4 w-4 mr-2"}),u(" "+o(w.value?"Resetting...":"Reset All Attempts"),1)]),_:1},8,["disabled"])]),l(t(S),null,{default:i(()=>[l(t(U),null,{default:i(()=>[l(t(T),{class:"flex items-center justify-between"},{default:i(()=>[a[2]||(a[2]=e("span",null,"Attempt Summary",-1)),l(t(f),{variant:s.attempt.passed?"default":"destructive",class:"text-base px-4 py-1"},{default:i(()=>[s.attempt.passed?(n(),p(t(k),{key:0,class:"h-4 w-4 mr-2"})):(n(),p(t(V),{key:1,class:"h-4 w-4 mr-2"})),u(" "+o(s.attempt.passed?"Passed":"Failed"),1)]),_:1},8,["variant"])]),_:1})]),_:1}),l(t(M),{class:"space-y-4"},{default:i(()=>[e("div",ne,[e("div",ue,[e("div",me,[l(t(ee),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[a[3]||(a[3]=e("p",{class:"text-sm text-muted-foreground"},"Student",-1)),e("p",ce,o(s.user.name),1),e("p",pe,o(s.user.email),1)])]),e("div",fe,[l(t(te),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[a[4]||(a[4]=e("p",{class:"text-sm text-muted-foreground"},"Attempt Number",-1)),e("p",_e,"#"+o(s.attempt.attempt_number),1)])])]),e("div",ge,[e("div",xe,[l(t(se),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[a[5]||(a[5]=e("p",{class:"text-sm text-muted-foreground"},"Score",-1)),e("p",ve,[u(o(s.attempt.total_score)+" / "+o(s.quiz.total_points)+" ",1),e("span",be,"("+o(t(N))+"%)",1)]),s.attempt.manual_score?(n(),c("p",we," Auto: "+o(s.attempt.score)+" | Manual: "+o(s.attempt.manual_score),1)):_("",!0)])]),e("div",he,[l(t(re),{class:"h-5 w-5 text-muted-foreground"}),e("div",null,[a[6]||(a[6]=e("p",{class:"text-sm text-muted-foreground"},"Completed",-1)),e("p",ye,o(s.attempt.completed_at||"In Progress"),1)])])])])]),_:1})]),_:1}),l(t(S),null,{default:i(()=>[l(t(U),null,{default:i(()=>[l(t(T),null,{default:i(()=>a[7]||(a[7]=[u("Questions & Answers")])),_:1}),l(t(J),null,{default:i(()=>a[8]||(a[8]=[u("Review all questions and user responses")])),_:1})]),_:1}),l(t(M),{class:"space-y-6"},{default:i(()=>[(n(!0),c(h,null,C(s.questions,(r,Q)=>(n(),c("div",{key:r.id,class:"border rounded-lg p-5 space-y-4"},[e("div",ke,[e("div",Ae,[l(t(f),{variant:"outline",class:"mt-1"},{default:i(()=>[u("Q"+o(Q+1),1)]),_:2},1024),e("div",ze,[e("p",Ce,o(r.question_text),1),e("div",$e,[r.type!=="text"?(n(),p(t(f),{key:0,variant:"secondary",class:"text-xs"},{default:i(()=>[u(o(r.points)+" pts ",1)]),_:2},1024)):_("",!0),l(t(f),{variant:"outline",class:"text-xs"},{default:i(()=>[u(o(r.type==="radio"?"Single Choice":r.type==="checkbox"?"Multiple Choice":"Text Answer"),1)]),_:2},1024)])])]),e("div",Se,[r.type!=="text"?(n(),p(t(f),{key:0,variant:r.is_correct?"default":"destructive",class:"text-sm"},{default:i(()=>[r.is_correct?(n(),p(t(k),{key:0,class:"h-3 w-3 mr-1"})):(n(),p(t(V),{key:1,class:"h-3 w-3 mr-1"})),u(" "+o(r.points_earned)+" / "+o(r.points),1)]),_:2},1032,["variant"])):(n(),p(t(f),{key:1,variant:"outline",class:"text-sm"},{default:i(()=>a[9]||(a[9]=[u(" Manual Grading ")])),_:1}))])]),r.type!=="text"?(n(),c("div",Me,[(n(!0),c(h,null,C(r.options,(m,R)=>(n(),c("div",{key:R,class:X(["flex items-center gap-3 p-3 rounded-lg border",{"bg-green-50 dark:bg-green-950 border-green-300 dark:border-green-700":v(r,m),"bg-red-50 dark:bg-red-950 border-red-300 dark:border-red-700":b(r,m)&&!v(r,m),"bg-muted/30":!b(r,m)&&!v(r,m)}])},[e("div",Ue,[e("input",{type:r.type==="radio"?"radio":"checkbox",checked:b(r,m),disabled:"",class:"h-4 w-4"},null,8,Te),e("span",null,o(m),1)]),e("div",Ve,[b(r,m)?(n(),p(t(f),{key:0,variant:"outline",class:"text-xs"},{default:i(()=>a[10]||(a[10]=[u(" User's Answer ")])),_:1})):_("",!0),v(r,m)?(n(),p(t(k),{key:1,class:"h-5 w-5 text-green-600 dark:text-green-400"})):_("",!0)])],2))),128))])):(n(),c("div",Pe,[e("div",Be,[a[11]||(a[11]=e("p",{class:"text-sm text-muted-foreground mb-1"},"User's Answer:",-1)),e("p",Ne,o(F(r)),1)]),r.answer_id?(n(),c("div",je,[e("div",De,[e("div",Fe,[l(t(Y),{for:`grade-${r.answer_id}`,class:"text-sm font-medium text-yellow-900 dark:text-yellow-100"},{default:i(()=>[u(" Assign Points (Max: "+o(r.points)+") ",1)]),_:2},1032,["for"]),l(t(K),{id:`grade-${r.answer_id}`,modelValue:g.value[r.answer_id],"onUpdate:modelValue":m=>g.value[r.answer_id]=m,modelModifiers:{number:!0},type:"number",min:0,max:r.points,class:"mt-1",disabled:t(x).processing},null,8,["id","modelValue","onUpdate:modelValue","max","disabled"])]),l(t(f),{variant:"outline",class:"mb-2"},{default:i(()=>[u(" Current: "+o(r.points_earned)+" pts ",1)]),_:2},1024)])])):_("",!0)])),r.correct_answer_explanation?(n(),c("div",Oe,[e("div",Qe,[a[12]||(a[12]=e("p",{class:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-1"},"Explanation:",-1)),e("p",Re,o(r.correct_answer_explanation),1)])])):_("",!0)]))),128)),j.value?(n(),c("div",Ee,[l(t(y),{onClick:D,disabled:t(x).processing},{default:i(()=>[l(t(ae),{class:"h-4 w-4 mr-2"}),u(" "+o(t(x).processing?"Saving...":"Save Manual Grades"),1)]),_:1},8,["disabled"])])):_("",!0)]),_:1})]),_:1})])]),_:1})],64))}});export{pt as default};
