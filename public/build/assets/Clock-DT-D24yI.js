import{r as u,c as I,x as U,H as E,l as H,o as n,w as g,e as t,b as f,a as r,f as d,t as l,n as m,j as h,F as O,h as P,u as _,P as w,W as $}from"./app-CGpEa2Rf.js";import{_ as R}from"./AttendanceLayout-CUF9POnL.js";import{_ as W,a as q}from"./ClockInModal-BZxc7cGg.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-joK0Vy2g.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Ci9BpTpo.js";import"./index-BYhRPgLx.js";const G={class:"flex h-full flex-1 flex-col gap-4 p-0 md:p-4"},J={class:"grid auto-rows-min gap-4 md:grid-cols-2 max-w-5xl mx-auto w-full"},K={class:"flex flex-col items-center justify-center rounded-xl border border-sidebar-border/70 p-6 bg-white dark:bg-dark-800 shadow-sm"},Q={class:"text-5xl md:text-6xl font-mono font-bold text-gray-800 dark:text-dark-50 transition-all duration-300 transform hover:scale-105"},X={class:"mt-4 text-center text-gray-600 dark:text-dark-300"},Y={class:"flex flex-col rounded-xl border border-sidebar-border/70 p-6 bg-white dark:bg-dark-800 shadow-sm"},Z={class:"flex items-center justify-center mb-4"},ee={key:0,class:"text-sm text-gray-500 mb-2 text-center"},te={key:1,class:"text-sm text-gray-500 mb-2 text-center"},oe={key:2,class:"text-sm text-gray-500 mb-4 text-center"},se={class:"mt-auto"},ne=["disabled"],re={key:0,class:"mr-2"},le=["disabled"],ae={key:0,class:"relative flex-1 rounded-lg border border-gray-200 p-6 bg-white shadow-sm max-w-5xl mx-auto w-full"},ie={class:"grid gap-4 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4"},ce={class:"flex justify-between items-start mb-2"},ue={class:"text-sm font-medium text-gray-900"},de={key:0,class:"mt-2 text-sm text-gray-700"},me={class:"flex items-center"},ge={class:"mt-2 text-sm text-gray-700"},fe={class:"flex items-center"},xe={key:0},ve={key:1},ke={key:1,class:"mt-2 flex items-center"},he={class:"flex text-yellow-400"},be={class:"mt-6"},ye={class:"flex justify-center"},pe={class:"flex items-center space-x-2"},_e={class:"text-sm text-gray-700"},Be={__name:"Clock",props:{clockings:{type:Object,required:!0,default:()=>({data:[],current_page:1,last_page:1,prev_page_url:null,next_page_url:null})},activeSession:{type:Object,default:null},userCourses:{type:Array,default:()=>[]}},setup(a){const C=a,b=u(!1),i=u(!1),x=u(!1),v=u(!1),S=u({rating:3,comment:""}),j=u(""),D=u("");let y=null;const c=I(()=>C.activeSession!==null),k=I(()=>C.activeSession||{});function M(){const o=new Date;j.value=o.toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"}),D.value=o.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function F(o){return o?new Date(o).toLocaleString():"—"}function L(o){return o?new Date(o).toLocaleString("en-US",{hour12:!1,month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}function p(o){if(!o||o<0)return"0 minutes";const e=Math.floor(o/60),s=Math.floor(o%60);return e>0?`${e}h ${s}m`:`${s}m`}function V(){v.value=!0}async function z(o){try{i.value=!0,$.post("/clock-in",{course_id:o.course_id},{onSuccess:()=>{console.log("Clock in successful"),v.value=!1},onError:e=>{console.error("Clock in failed:",e),alert("Failed to clock in. Please try again.")},onFinish:()=>{i.value=!1}})}catch(e){console.error("Clock in exception:",e),i.value=!1}}function N(){x.value=!0,S.value={rating:3,comment:""}}async function A(o){if(!o.rating){alert("Please provide a rating");return}try{i.value=!0,$.post("/clock-out",{rating:o.rating,comment:o.comment},{onSuccess:()=>{console.log("Clock out successful"),x.value=!1},onError:e=>{console.error("Clock out failed:",e),alert("Failed to clock out. Please try again.")},onFinish:()=>{i.value=!1}})}catch(e){console.error("Clock out exception:",e),i.value=!1}}return U(()=>{M(),y=setInterval(M,1e3)}),E(()=>{y&&clearInterval(y)}),(o,e)=>(n(),H(R,{title:"Attendance Clock"},{actions:g(()=>[f(_(w),{href:"/attendance",class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200"},{default:g(()=>e[2]||(e[2]=[h(" View Records ")])),_:1})]),default:g(()=>[t("div",G,[t("div",J,[t("div",K,[t("div",Q,l(j.value),1),t("div",X,l(D.value),1)]),t("div",Y,[e[5]||(e[5]=t("h2",{class:"text-xl font-medium text-gray-900 dark:text-dark-50 mb-4 text-center"},"Current Status",-1)),t("div",Z,[t("div",{class:m(["h-3 w-3 rounded-full mr-2",c.value?"bg-green-500 animate-pulse":"bg-gray-400"])},null,2),t("span",{class:m(["font-medium",c.value?"text-green-600":"text-gray-600"])},l(c.value?"Clocked In":"Clocked Out"),3)]),c.value?(n(),r("div",ee," Clocked in at: "+l(F(k.value.clock_in)),1)):d("",!0),c.value&&k.value.course?(n(),r("div",te," Course: "+l(k.value.course.name),1)):d("",!0),c.value?(n(),r("div",oe," Duration: "+l(p(k.value.current_duration||0)),1)):d("",!0),t("div",se,[c.value?(n(),r("button",{key:1,onClick:N,class:"w-full inline-flex justify-center items-center px-4 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-200",disabled:b.value}," Clock Out ",8,le)):(n(),r("button",{key:0,onClick:V,class:"w-full inline-flex justify-center items-center px-4 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",disabled:b.value},[b.value?(n(),r("span",re,e[3]||(e[3]=[t("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):d("",!0),e[4]||(e[4]=h(" Clock In "))],8,ne))])])]),a.clockings.data&&a.clockings.data.length>0?(n(),r("div",ae,[e[11]||(e[11]=t("h3",{class:"text-xl font-bold text-gray-900 mb-4"},"Recent Activity",-1)),t("div",ie,[(n(!0),r(O,null,P(a.clockings.data,(s,T)=>(n(),r("div",{key:T,class:"border border-gray-200 rounded-lg p-4 bg-white shadow-sm"},[t("div",ce,[t("div",ue,l(L(s.clock_in)),1),t("span",{class:m(["px-2 py-1 text-xs font-semibold rounded-full",s.clock_out?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"])},l(s.clock_out?"Completed":"In Progress"),3)]),s.course_name?(n(),r("div",de,[t("div",me,[e[6]||(e[6]=t("svg",{class:"h-4 w-4 text-gray-500 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5s3.332.477 4.5 1.253v13c-1.168-.776-2.754-1.253-4.5-1.253s-3.332.477-4.5 1.253"})],-1)),t("span",null,l(s.course_name),1)])])):d("",!0),t("div",ge,[t("div",fe,[e[7]||(e[7]=t("svg",{class:"h-4 w-4 text-gray-500 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",null,[s.clock_out?(n(),r("span",xe,l(p(s.duration_in_minutes)),1)):(n(),r("span",ve,l(p(s.current_duration||0))+" (ongoing) ",1))])])]),s.rating?(n(),r("div",ke,[t("div",he,[(n(),r(O,null,P(5,B=>t("svg",{key:B,class:m([[B<=s.rating?"text-yellow-400":"text-gray-300"],"h-4 w-4"]),fill:"currentColor",viewBox:"0 0 20 20"},e[8]||(e[8]=[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"},null,-1)]),2)),64))])])):d("",!0)]))),128))]),t("div",be,[t("div",ye,[t("nav",pe,[f(_(w),{href:a.clockings.prev_page_url,class:m(["px-3 py-1 rounded border border-gray-300 text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition",!a.clockings.prev_page_url&&"opacity-50 cursor-not-allowed pointer-events-none"])},{default:g(()=>e[9]||(e[9]=[h(" Previous ")])),_:1},8,["href","class"]),t("span",_e," Page "+l(a.clockings.current_page)+" of "+l(a.clockings.last_page),1),f(_(w),{href:a.clockings.next_page_url,class:m(["px-3 py-1 rounded border border-gray-300 text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition",!a.clockings.next_page_url&&"opacity-50 cursor-not-allowed pointer-events-none"])},{default:g(()=>e[10]||(e[10]=[h(" Next ")])),_:1},8,["href","class"])])])])])):d("",!0)]),f(W,{show:v.value,courses:a.userCourses,"is-submitting":i.value,onClose:e[0]||(e[0]=s=>v.value=!1),onSubmit:z},null,8,["show","courses","is-submitting"]),f(q,{show:x.value,"initial-form":S.value,"is-submitting":i.value,onClose:e[1]||(e[1]=s=>x.value=!1),onSubmit:A},null,8,["show","initial-form","is-submitting"])]),_:1}))}};export{Be as default};
