import{d as Q,C as H,r as C,l as K,a as m,o as n,b as s,u as e,m as O,w as o,e as l,P as U,f as r,j as X,h as c,n as p,t as u,F as D,i as Y,g as T,W as Z}from"./app-C__QVaju.js";import{m as ee,f as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-B2Dge6gk.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-3wUGolNO.js";import{_ as x}from"./Card.vue_vue_type_script_setup_true_lang-C6NTCksb.js";import{_ as h}from"./CardContent.vue_vue_type_script_setup_true_lang-CVVI4jBC.js";import{_ as y}from"./CardDescription.vue_vue_type_script_setup_true_lang-uH9K1n7e.js";import{_ as w}from"./CardHeader.vue_vue_type_script_setup_true_lang-EmAvtNmd.js";import{_ as V}from"./CardTitle.vue_vue_type_script_setup_true_lang-D-QOz8Vl.js";import{_ as S}from"./Input.vue_vue_type_script_setup_true_lang-aF8VS1eW.js";import{_ as v}from"./Label.vue_vue_type_script_setup_true_lang-B_8So5-r.js";import{_ as se}from"./Textarea.vue_vue_type_script_setup_true_lang-pTkEcb9U.js";import{_ as oe}from"./Switch.vue_vue_type_script_setup_true_lang-CsJCTOPg.js";import{_ as ie,a as le,b as re,c as ae,d as A}from"./SelectValue.vue_vue_type_script_setup_true_lang-CwE9uTNb.js";import{_ as de}from"./Separator.vue_vue_type_script_setup_true_lang-BmbCCT5w.js";import{A as ne}from"./arrow-left-BMTkwTtm.js";import{C as M}from"./chart-column-DnDZxk8r.js";import{S as ue}from"./square-play-CmFnd1QI.js";import{L as me}from"./link-2-Cwn8UPJF.js";import{L as fe}from"./loader-circle-DKQC5p7r.js";import{T as ve}from"./test-tube-DwhQNGcp.js";import{I as N}from"./image-CaHv1HB1.js";import{T as j}from"./trash-2-Cox1oXJh.js";import{S as ce}from"./save-CLavzdjt.js";import"./index-Eaggz7Xa.js";import"./index-DU9IJCLr.js";import"./_plugin-vue_export-helper-DTeMU56P.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B2uDP-vU.js";import"./clock-8P7QZ8ho.js";import"./useForwardPropsEmits-BEVKN6n0.js";import"./useForwardExpose-BLcFDH4t.js";import"./VisuallyHidden-cBIp1Q_A.js";import"./VisuallyHiddenInput-mXSm1HTg.js";import"./usePrimitiveElement-kCWVBnpO.js";import"./Presence-BKN0Rp2q.js";import"./ConfigProvider-CTQWQfDl.js";import"./Teleport-C5XQXQh9.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-jLbl18n9.js";import"./Collection-t8rO_nU0.js";import"./check-CTP6ugNR.js";import"./useSize-B7neWAfJ.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";const _e={class:"max-w-4xl mx-auto space-y-6"},pe={class:"flex items-center gap-4"},ge={class:"space-y-2"},be={key:0,class:"text-sm text-destructive"},xe={class:"space-y-2"},he={key:0,class:"text-sm text-destructive"},ye={class:"space-y-2"},we={key:0,class:"text-sm text-destructive"},Ve={class:"space-y-2"},ke={class:"flex gap-2"},$e={key:0,class:"text-sm text-destructive"},Se={class:"space-y-2"},Ce={class:"flex gap-2"},Ue={class:"flex items-center px-3 py-2 bg-muted rounded-md text-sm text-muted-foreground min-w-0"},Te={key:0,class:"text-sm text-destructive"},Le={key:0,class:"space-y-4"},Pe={class:"mt-2 flex items-start gap-4"},Re={class:"w-48 h-32 rounded-lg overflow-hidden bg-muted"},De=["src","alt"],Ae={class:"flex-1 space-y-2"},Me={class:"flex gap-2"},Ne={class:"space-y-2"},je={class:"flex items-start gap-4"},Be={class:"w-32 h-24 rounded-lg border-2 border-dashed border-muted-foreground/25 bg-muted/50 flex items-center justify-center overflow-hidden shrink-0"},Ee=["src"],Fe={key:1,class:"text-center"},Ge={class:"flex-1"},qe={key:0,class:"text-sm text-destructive mt-1"},ze={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ie={class:"flex items-center justify-between"},We={class:"space-y-1"},Je={class:"grid grid-cols-2 gap-4"},Qe={class:"text-center"},He={class:"text-2xl font-bold text-blue-600"},Ke={class:"text-center"},Oe={class:"text-2xl font-bold text-green-600"},Xe={class:"flex justify-between items-center"},Ye={class:"flex gap-2"},qt=Q({__name:"Edit",props:{video:{},categories:{}},setup(B){var L;const f=B,E=[{title:"Video Management",href:"/admin/videos"},{title:"Edit Video",href:""}],i=H({name:f.video.name,description:f.video.description||"",google_drive_url:f.video.google_drive_url,duration:f.video.duration,thumbnail:null,video_category_id:((L=f.video.video_category_id)==null?void 0:L.toString())||null,is_active:f.video.is_active,remove_thumbnail:!1}),k=C(!1),$=C(!1),g=C(null),F=a=>{var b;const d=(b=a.target.files)==null?void 0:b[0];if(d){i.thumbnail=d,i.remove_thumbnail=!1;const P=new FileReader;P.onload=J=>{var R;g.value=(R=J.target)==null?void 0:R.result},P.readAsDataURL(d)}else i.thumbnail=null,g.value=null},G=()=>{i.remove_thumbnail=!0,i.thumbnail=null,g.value=null},q=async()=>{if(i.google_drive_url){$.value=!0;try{console.log("Testing URL:",i.google_drive_url),await new Promise(a=>setTimeout(a,2e3)),alert("Video URL is valid!")}catch(a){console.error("URL test failed:",a),alert("Failed to validate video URL. Please check the link.")}finally{$.value=!1}}},z=a=>{if(!a)return"00:00";const t=Math.floor(a/3600),d=Math.floor(a%3600/60),b=a%60;return t>0?`${t.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`:`${d.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`},I=async()=>{k.value=!0,i.put(`/admin/videos/${f.video.id}`,{onFinish:()=>{k.value=!1}})},W=()=>{confirm(`Are you sure you want to delete "${f.video.name}"? This action cannot be undone and will remove all associated progress data.`)&&Z.delete(`/admin/videos/${f.video.id}`)};return K(()=>i.thumbnail,a=>{a&&(i.remove_thumbnail=!1)}),(a,t)=>(n(),m(D,null,[s(e(O),{title:`Edit ${a.video.name}`},null,8,["title"]),s(te,{breadcrumbs:E},{default:o(()=>[l("div",_e,[l("div",pe,[s(e(_),{"as-child":"",variant:"ghost"},{default:o(()=>[s(e(U),{href:"/admin/videos"},{default:o(()=>[s(e(ne),{class:"h-4 w-4 mr-2"}),t[6]||(t[6]=r(" Back to Videos "))]),_:1})]),_:1}),t[8]||(t[8]=l("div",{class:"flex-1"},[l("h1",{class:"text-2xl font-bold"},"Edit Video Course"),l("p",{class:"text-muted-foreground"},"Update video course details and settings")],-1)),s(e(_),{"as-child":"",variant:"outline"},{default:o(()=>[s(e(U),{href:`/admin/videos/${a.video.id}`},{default:o(()=>[s(e(M),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=r(" View Analytics "))]),_:1},8,["href"])]),_:1})]),l("form",{onSubmit:X(I,["prevent"]),class:"space-y-6"},[s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(ue),{class:"h-5 w-5"}),t[9]||(t[9]=r(" Video Information "))]),_:1}),s(e(y),null,{default:o(()=>t[10]||(t[10]=[r(" Update the basic details for your video course ")])),_:1})]),_:1}),s(e(h),{class:"space-y-4"},{default:o(()=>[l("div",ge,[s(e(v),{for:"name"},{default:o(()=>t[11]||(t[11]=[r("Video Title")])),_:1}),s(e(S),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":t[0]||(t[0]=d=>e(i).name=d),type:"text",placeholder:"Enter video course title...",class:p({"border-destructive":e(i).errors.name}),required:""},null,8,["modelValue","class"]),e(i).errors.name?(n(),m("div",be,u(e(i).errors.name),1)):c("",!0)]),l("div",xe,[s(e(v),{for:"description"},{default:o(()=>t[12]||(t[12]=[r("Description")])),_:1}),s(e(se),{id:"description",modelValue:e(i).description,"onUpdate:modelValue":t[1]||(t[1]=d=>e(i).description=d),placeholder:"Describe what students will learn from this video course...",rows:"5",class:p({"border-destructive":e(i).errors.description})},null,8,["modelValue","class"]),e(i).errors.description?(n(),m("div",he,u(e(i).errors.description),1)):c("",!0)]),l("div",ye,[s(e(v),{for:"video_category_id"},{default:o(()=>t[13]||(t[13]=[r("Category")])),_:1}),s(e(ie),{modelValue:e(i).video_category_id,"onUpdate:modelValue":t[2]||(t[2]=d=>e(i).video_category_id=d)},{default:o(()=>[s(e(le),{class:p({"border-destructive":e(i).errors.video_category_id})},{default:o(()=>[s(e(re),{placeholder:"Select a category..."})]),_:1},8,["class"]),s(e(ae),null,{default:o(()=>[s(e(A),{value:""},{default:o(()=>t[14]||(t[14]=[r("No Category")])),_:1}),(n(!0),m(D,null,Y(a.categories,d=>(n(),T(e(A),{key:d.id,value:d.id.toString()},{default:o(()=>[r(u(d.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(i).errors.video_category_id?(n(),m("div",we,u(e(i).errors.video_category_id),1)):c("",!0)])]),_:1})]),_:1}),s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(me),{class:"h-5 w-5"}),t[15]||(t[15]=r(" Video Source "))]),_:1}),s(e(y),null,{default:o(()=>t[16]||(t[16]=[r(" Update the video source and metadata ")])),_:1})]),_:1}),s(e(h),{class:"space-y-4"},{default:o(()=>[l("div",Ve,[s(e(v),{for:"google_drive_url"},{default:o(()=>t[17]||(t[17]=[r("Google Drive Video URL")])),_:1}),l("div",ke,[s(e(S),{id:"google_drive_url",modelValue:e(i).google_drive_url,"onUpdate:modelValue":t[3]||(t[3]=d=>e(i).google_drive_url=d),type:"url",placeholder:"https://drive.google.com/file/d/...",class:p({"border-destructive":e(i).errors.google_drive_url}),required:""},null,8,["modelValue","class"]),s(e(_),{type:"button",variant:"outline",size:"icon",onClick:q,disabled:!e(i).google_drive_url||$.value},{default:o(()=>[$.value?(n(),T(e(fe),{key:0,class:"h-4 w-4 animate-spin"})):(n(),T(e(ve),{key:1,class:"h-4 w-4"}))]),_:1},8,["disabled"])]),e(i).errors.google_drive_url?(n(),m("div",$e,u(e(i).errors.google_drive_url),1)):c("",!0),t[18]||(t[18]=l("div",{class:"text-sm text-muted-foreground"},' Paste the shareable link from Google Drive. Make sure the video is set to "Anyone with the link can view" ',-1))]),l("div",Se,[s(e(v),{for:"duration"},{default:o(()=>t[19]||(t[19]=[r("Duration (seconds)")])),_:1}),l("div",Ce,[s(e(S),{id:"duration",modelValue:e(i).duration,"onUpdate:modelValue":t[4]||(t[4]=d=>e(i).duration=d),type:"number",min:"1",max:"86400",placeholder:"e.g., 3600 for 1 hour",class:p({"border-destructive":e(i).errors.duration})},null,8,["modelValue","class"]),l("div",Ue,u(z(e(i).duration)),1)]),e(i).errors.duration?(n(),m("div",Te,u(e(i).errors.duration),1)):c("",!0)])]),_:1})]),_:1}),s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(N),{class:"h-5 w-5"}),t[20]||(t[20]=r(" Thumbnail "))]),_:1}),s(e(y),null,{default:o(()=>t[21]||(t[21]=[r(" Update or remove the video thumbnail ")])),_:1})]),_:1}),s(e(h),{class:"space-y-4"},{default:o(()=>[a.video.thumbnail_url?(n(),m("div",Le,[l("div",null,[s(e(v),null,{default:o(()=>t[22]||(t[22]=[r("Current Thumbnail")])),_:1}),l("div",Pe,[l("div",Re,[l("img",{src:a.video.thumbnail_url,alt:a.video.name,class:"w-full h-full object-cover"},null,8,De)]),l("div",Ae,[t[24]||(t[24]=l("p",{class:"text-sm text-muted-foreground"}," Current thumbnail for this video course ",-1)),l("div",Me,[s(e(_),{type:"button",variant:"outline",size:"sm",onClick:G},{default:o(()=>[s(e(j),{class:"h-4 w-4 mr-2"}),t[23]||(t[23]=r(" Remove Thumbnail "))]),_:1})])])])]),s(e(de))])):c("",!0),l("div",Ne,[s(e(v),{for:"thumbnail"},{default:o(()=>[r(u(a.video.thumbnail_url?"Replace":"Upload")+" Thumbnail",1)]),_:1}),l("div",je,[l("div",Be,[g.value?(n(),m("img",{key:0,src:g.value,class:"w-full h-full object-cover",alt:"New thumbnail preview"},null,8,Ee)):(n(),m("div",Fe,[s(e(N),{class:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),t[25]||(t[25]=l("div",{class:"text-xs text-muted-foreground"},"Preview",-1))]))]),l("div",Ge,[s(e(S),{id:"thumbnail",type:"file",accept:"image/*",class:p({"border-destructive":e(i).errors.thumbnail}),onChange:F},null,8,["class"]),e(i).errors.thumbnail?(n(),m("div",qe,u(e(i).errors.thumbnail),1)):c("",!0),t[26]||(t[26]=l("div",{class:"text-sm text-muted-foreground mt-1"}," Recommended: 1280x720px (16:9 ratio), JPG or PNG, max 2MB ",-1))])])])]),_:1})]),_:1}),l("div",ze,[s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(ee),{class:"h-5 w-5"}),t[27]||(t[27]=r(" Settings "))]),_:1}),s(e(y),null,{default:o(()=>t[28]||(t[28]=[r(" Configure the video course settings ")])),_:1})]),_:1}),s(e(h),null,{default:o(()=>[l("div",Ie,[l("div",We,[s(e(v),null,{default:o(()=>t[29]||(t[29]=[r("Active Status")])),_:1}),t[30]||(t[30]=l("div",{class:"text-sm text-muted-foreground"}," Make this video course available to students ",-1))]),s(e(oe),{checked:e(i).is_active,"onUpdate:checked":t[5]||(t[5]=d=>e(i).is_active=d)},null,8,["checked"])])]),_:1})]),_:1}),s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(M),{class:"h-5 w-5"}),t[31]||(t[31]=r(" Quick Statistics "))]),_:1}),s(e(y),null,{default:o(()=>t[32]||(t[32]=[r(" Current performance metrics ")])),_:1})]),_:1}),s(e(h),null,{default:o(()=>[l("div",Je,[l("div",Qe,[l("div",He,u(a.video.total_viewers),1),t[33]||(t[33]=l("div",{class:"text-xs text-muted-foreground"},"Viewers",-1))]),l("div",Ke,[l("div",Oe,u(Math.round(a.video.avg_completion))+"%",1),t[34]||(t[34]=l("div",{class:"text-xs text-muted-foreground"},"Avg Progress",-1))])])]),_:1})]),_:1})]),l("div",Xe,[l("div",Ye,[s(e(_),{"as-child":"",variant:"outline"},{default:o(()=>[s(e(U),{href:"/admin/videos"},{default:o(()=>t[35]||(t[35]=[r("Cancel")])),_:1})]),_:1}),s(e(_),{type:"button",variant:"destructive",onClick:W},{default:o(()=>[s(e(j),{class:"h-4 w-4 mr-2"}),t[36]||(t[36]=r(" Delete Video "))]),_:1})]),s(e(_),{type:"submit",disabled:k.value||e(i).processing},{default:o(()=>[s(e(ce),{class:"h-4 w-4 mr-2"}),r(" "+u(k.value?"Updating...":"Update Video Course"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{qt as default};
