import{a as d,o as c,e,f as y,t as a,j as v,F as Z,h as $,l as te,r as ee,c as se,B as ae}from"./app-iYB6CK9s.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={name:"MonthlyKpiScreenshot",props:{kpiData:{type:Object,required:!0},currentFilters:{type:Object,required:!0},departments:{type:Array,default:()=>[]},courses:{type:Array,default:()=>[]},lastUpdated:{type:String,required:!0}},setup(m){const t=ee(!1),s=ee(null),n=se(()=>`/admin/reports/monthly-kpi?${new URLSearchParams(m.currentFilters).toString()}`),w=async()=>{try{if(t.value=!0,!window.html2canvas){const l=document.createElement("script");l.src="https://html2canvas.hertzen.com/dist/html2canvas.min.js",document.head.appendChild(l),await new Promise(h=>{l.onload=h})}const o=document.getElementById("screenshot-content");if(!o)throw new Error("Screenshot content not found");(await window.html2canvas(o,{backgroundColor:"#ffffff",scale:1.5,useCORS:!0,allowTaint:!0,width:o.scrollWidth,height:o.scrollHeight,scrollX:0,scrollY:0})).toBlob(l=>{l&&(s.value=URL.createObjectURL(l),console.log("✅ Screenshot captured successfully"))},"image/png",.9)}catch(o){console.error("❌ Screenshot failed:",o),alert("Screenshot failed. Please try using your browser's built-in screenshot (Ctrl/Cmd + Shift + S)")}finally{t.value=!1}},D=()=>{if(!s.value)return;const o=document.createElement("a");o.href=s.value,o.download=`KPI_Report_${m.currentFilters.month}_${m.currentFilters.year}.png`,document.body.appendChild(o),o.click(),document.body.removeChild(o)},_=async()=>{if(s.value)try{const r=await(await fetch(s.value)).blob();await navigator.clipboard.write([new ClipboardItem({"image/png":r})]),alert("📋 Screenshot copied to clipboard!")}catch(o){console.error("Copy failed:",o),alert("Copy failed. Please download instead.")}},u=()=>{s.value&&(URL.revokeObjectURL(s.value),s.value=null)},g=o=>new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),p=o=>new Date(o).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),b=(o,r)=>o>=r?"✅ Good":o>=r*.7?"⚠️ Fair":"❌ Poor",k=o=>{switch(o){case"up":return"↗️";case"down":return"↘️";default:return"➡️"}};return ae(()=>{console.log("📸 KPI Screenshot page loaded")}),{capturing:t,screenshotUrl:s,backUrl:n,captureScreenshot:w,downloadScreenshot:D,copyToClipboard:_,closePreview:u,formatDate:g,formatDateTime:p,getStatus:b,getTrendArrow:k}}},ie={class:"kpi-screenshot-page"},le={class:"screenshot-toolbar"},re={class:"toolbar-content"},de={class:"toolbar-actions"},ce=["disabled"],ve=["href"],me={id:"screenshot-content",class:"report-container"},_e={class:"report-header"},ue={class:"report-subtitle"},ge={class:"report-date"},pe={class:"kpi-overview"},be={class:"kpi-grid"},ke={class:"kpi-card"},he={class:"kpi-info"},fe={class:"kpi-value"},ye={class:"kpi-card"},we={class:"kpi-info"},De={class:"kpi-value"},Se={class:"kpi-card"},Ce={class:"kpi-info"},Pe={class:"kpi-value"},Re={class:"kpi-card highlight"},Te={class:"kpi-info"},Ue={class:"kpi-value"},Fe={class:"engagement-section"},Me={class:"metrics-table"},Ae={class:"table-row"},Ie={class:"cell"},Le={class:"cell"},je={class:"table-row"},qe={class:"cell"},Ee={class:"cell"},Ke={class:"table-row"},Be={class:"cell"},Ne={class:"cell"},ze={class:"table-row"},Oe={class:"cell"},xe={class:"cell"},Ve={class:"learning-section"},Ge={class:"outcome-cards"},Qe={class:"outcome-card success"},He={class:"outcome-value"},We={class:"outcome-card warning"},Xe={class:"outcome-value"},Ye={class:"outcome-card"},Je={class:"outcome-value"},Ze={class:"outcome-card"},$e={class:"outcome-value"},et={class:"feedback-section"},tt={class:"feedback-overview"},st={class:"feedback-summary"},at={class:"summary-item"},ot={class:"summary-value large"},nt={class:"summary-item"},it={class:"summary-value"},lt={class:"sentiment-breakdown"},rt={class:"sentiment-item positive"},dt={class:"sentiment-percent"},ct={class:"sentiment-item neutral"},vt={class:"sentiment-percent"},mt={class:"sentiment-item negative"},_t={class:"sentiment-percent"},ut={class:"performance-section"},gt={class:"performance-grid"},pt={class:"performance-table"},bt={class:"simple-table"},kt={class:"table-cell"},ht={class:"rank"},ft={class:"table-cell"},yt={class:"table-cell"},wt={key:0,class:"table-row empty"},Dt={class:"performance-table"},St={class:"simple-table"},Ct={class:"table-cell"},Pt={class:"rank"},Rt={class:"table-cell"},Tt={class:"table-cell"},Ut={key:0,class:"table-row empty"},Ft={class:"trend-section"},Mt={class:"trend-comparison"},At={class:"trend-card current"},It={class:"trend-value"},Lt={class:"trend-label"},jt={class:"trend-arrow"},qt={class:"arrow-icon"},Et={class:"trend-text"},Kt={class:"trend-card previous"},Bt={class:"trend-value"},Nt={class:"trend-change"},zt={class:"report-footer"},Ot={class:"footer-info"},xt={class:"footer-line"},Vt={class:"footer-line"},Gt={class:"preview-header"},Qt={class:"preview-body"},Ht=["src"],Wt={class:"preview-actions"};function Xt(m,t,s,n,w,D){var _,u,g,p,b,k,o,r,l,h,S,C,P,R,T,U,F,M,A,I,L,j,q,E,K,B,N,z,O,x,V,G,Q,H,W,X,Y,J;return c(),d("div",ie,[e("div",le,[e("div",re,[t[6]||(t[6]=e("h1",null,"📸 KPI Report Screenshot",-1)),e("div",de,[e("button",{onClick:t[0]||(t[0]=(...i)=>n.captureScreenshot&&n.captureScreenshot(...i)),class:"screenshot-btn",disabled:n.capturing},a(n.capturing?"⏳ Capturing...":"📸 Take Screenshot"),9,ce),e("a",{href:n.backUrl,class:"back-btn"},"← Back to Dashboard",8,ve)])])]),e("div",me,[e("div",_e,[t[7]||(t[7]=e("div",{class:"company-logo"},[e("div",{class:"logo-placeholder"},"🏢")],-1)),t[8]||(t[8]=e("h1",{class:"report-title"},"Monthly Training KPI Report",-1)),e("div",ue,a(((_=s.kpiData.period)==null?void 0:_.period_name)||"Current Period"),1),e("div",ge,"Generated: "+a(n.formatDate(new Date)),1)]),e("div",pe,[t[17]||(t[17]=e("h2",{class:"section-title"},"📈 Key Performance Indicators",-1)),e("div",be,[e("div",ke,[t[10]||(t[10]=e("div",{class:"kpi-icon"},"📚",-1)),e("div",he,[t[9]||(t[9]=e("div",{class:"kpi-label"},"Courses Delivered",-1)),e("div",fe,a(((u=s.kpiData.delivery_overview)==null?void 0:u.courses_delivered)||0),1)])]),e("div",ye,[t[12]||(t[12]=e("div",{class:"kpi-icon"},"👥",-1)),e("div",we,[t[11]||(t[11]=e("div",{class:"kpi-label"},"Total Enrolled",-1)),e("div",De,a(((g=s.kpiData.delivery_overview)==null?void 0:g.total_enrolled)||0),1)])]),e("div",Se,[t[14]||(t[14]=e("div",{class:"kpi-icon"},"🎯",-1)),e("div",Ce,[t[13]||(t[13]=e("div",{class:"kpi-label"},"Active Participants",-1)),e("div",Pe,a(((p=s.kpiData.delivery_overview)==null?void 0:p.active_participants)||0),1)])]),e("div",Re,[t[16]||(t[16]=e("div",{class:"kpi-icon"},"✅",-1)),e("div",Te,[t[15]||(t[15]=e("div",{class:"kpi-label"},"Completion Rate",-1)),e("div",Ue,a(((b=s.kpiData.delivery_overview)==null?void 0:b.completion_rate)||0)+"%",1)])])])]),e("div",Fe,[t[23]||(t[23]=e("h2",{class:"section-title"},"🎯 Engagement & Attendance Metrics",-1)),e("div",Me,[t[22]||(t[22]=e("div",{class:"table-row header"},[e("div",{class:"cell"},"Metric"),e("div",{class:"cell"},"Current Value"),e("div",{class:"cell"},"Status")],-1)),e("div",Ae,[t[18]||(t[18]=e("div",{class:"cell"},"📋 Attendance Rate",-1)),e("div",Ie,a(((k=s.kpiData.attendance_engagement)==null?void 0:k.average_attendance_rate)||0)+"%",1),e("div",Le,a(n.getStatus(((o=s.kpiData.attendance_engagement)==null?void 0:o.average_attendance_rate)||0,80)),1)]),e("div",je,[t[19]||(t[19]=e("div",{class:"cell"},"⏱️ Average Time Spent",-1)),e("div",qe,a(((r=s.kpiData.attendance_engagement)==null?void 0:r.average_time_spent)||0)+" hours",1),e("div",Ee,a(n.getStatus(((l=s.kpiData.attendance_engagement)==null?void 0:l.average_time_spent)||0,20)),1)]),e("div",Ke,[t[20]||(t[20]=e("div",{class:"cell"},"💯 Engagement Score",-1)),e("div",Be,a(((h=s.kpiData.attendance_engagement)==null?void 0:h.engagement_score)||0)+"%",1),e("div",Ne,a(n.getStatus(((S=s.kpiData.attendance_engagement)==null?void 0:S.engagement_score)||0,75)),1)]),e("div",ze,[t[21]||(t[21]=e("div",{class:"cell"},"🔄 Login Frequency",-1)),e("div",Oe,a(((C=s.kpiData.attendance_engagement)==null?void 0:C.login_frequency)||0)+"%",1),e("div",xe,a(n.getStatus(((P=s.kpiData.attendance_engagement)==null?void 0:P.login_frequency)||0,70)),1)])])]),e("div",Ve,[t[28]||(t[28]=e("h2",{class:"section-title"},"📈 Learning Outcomes",-1)),e("div",Ge,[e("div",Qe,[t[24]||(t[24]=e("div",{class:"outcome-header"},[e("span",{class:"outcome-icon"},"✅"),e("span",{class:"outcome-label"},"Quiz Pass Rate")],-1)),e("div",He,a(((R=s.kpiData.learning_outcomes)==null?void 0:R.quiz_pass_rate)||0)+"%",1)]),e("div",We,[t[25]||(t[25]=e("div",{class:"outcome-header"},[e("span",{class:"outcome-icon"},"❌"),e("span",{class:"outcome-label"},"Quiz Fail Rate")],-1)),e("div",Xe,a(((T=s.kpiData.learning_outcomes)==null?void 0:T.quiz_fail_rate)||0)+"%",1)]),e("div",Ye,[t[26]||(t[26]=e("div",{class:"outcome-header"},[e("span",{class:"outcome-icon"},"📊"),e("span",{class:"outcome-label"},"Average Score")],-1)),e("div",Je,a(((U=s.kpiData.learning_outcomes)==null?void 0:U.average_quiz_score)||0)+"%",1)]),e("div",Ze,[t[27]||(t[27]=e("div",{class:"outcome-header"},[e("span",{class:"outcome-icon"},"📈"),e("span",{class:"outcome-label"},"Improvement Rate")],-1)),e("div",$e,a(((F=s.kpiData.learning_outcomes)==null?void 0:F.improvement_rate)||0)+"%",1)])])]),e("div",et,[t[38]||(t[38]=e("h2",{class:"section-title"},"⭐ Course Quality & Feedback",-1)),e("div",tt,[e("div",st,[e("div",at,[t[30]||(t[30]=e("div",{class:"summary-label"},"Average Rating",-1)),e("div",ot,[v(a(((M=s.kpiData.feedback_analysis)==null?void 0:M.average_rating)||0),1),t[29]||(t[29]=e("span",{class:"unit"},"/5",-1))])]),e("div",nt,[t[31]||(t[31]=e("div",{class:"summary-label"},"Total Feedback",-1)),e("div",it,a(((A=s.kpiData.feedback_analysis)==null?void 0:A.total_feedback_count)||0),1)])]),e("div",lt,[e("div",rt,[t[32]||(t[32]=e("span",{class:"sentiment-emoji"},"😊",-1)),t[33]||(t[33]=e("span",{class:"sentiment-label"},"Positive",-1)),e("span",dt,a(((L=(I=s.kpiData.feedback_analysis)==null?void 0:I.feedback_sentiment)==null?void 0:L.positive)||0)+"%",1)]),e("div",ct,[t[34]||(t[34]=e("span",{class:"sentiment-emoji"},"😐",-1)),t[35]||(t[35]=e("span",{class:"sentiment-label"},"Neutral",-1)),e("span",vt,a(((q=(j=s.kpiData.feedback_analysis)==null?void 0:j.feedback_sentiment)==null?void 0:q.neutral)||0)+"%",1)]),e("div",mt,[t[36]||(t[36]=e("span",{class:"sentiment-emoji"},"😞",-1)),t[37]||(t[37]=e("span",{class:"sentiment-label"},"Negative",-1)),e("span",_t,a(((K=(E=s.kpiData.feedback_analysis)==null?void 0:E.feedback_sentiment)==null?void 0:K.negative)||0)+"%",1)])])])]),e("div",ut,[e("div",gt,[e("div",pt,[t[41]||(t[41]=e("h3",{class:"table-title"},"🏆 Top Performing Courses",-1)),e("div",bt,[t[40]||(t[40]=e("div",{class:"table-header"},[e("div",{class:"header-cell"},"Course"),e("div",{class:"header-cell"},"Rating"),e("div",{class:"header-cell"},"Completion")],-1)),(c(!0),d(Z,null,$((((B=s.kpiData.performance_analysis)==null?void 0:B.top_performing_courses)||[]).slice(0,5),(i,f)=>(c(),d("div",{key:i.id,class:"table-row"},[e("div",kt,[e("span",ht,a(f+1)+".",1),v(" "+a(i.name),1)]),e("div",ft,a(i.rating)+"/5",1),e("div",yt,a(i.completion_rate)+"%",1)]))),128)),(z=(N=s.kpiData.performance_analysis)==null?void 0:N.top_performing_courses)!=null&&z.length?y("",!0):(c(),d("div",wt,t[39]||(t[39]=[e("div",{class:"table-cell"},"No data available",-1),e("div",{class:"table-cell"},"-",-1),e("div",{class:"table-cell"},"-",-1)])))])]),e("div",Dt,[t[44]||(t[44]=e("h3",{class:"table-title"},"🌟 Top Performing Users",-1)),e("div",St,[t[43]||(t[43]=e("div",{class:"table-header"},[e("div",{class:"header-cell"},"User"),e("div",{class:"header-cell"},"Score"),e("div",{class:"header-cell"},"Completed")],-1)),(c(!0),d(Z,null,$((((O=s.kpiData.performance_analysis)==null?void 0:O.top_performing_users)||[]).slice(0,5),(i,f)=>(c(),d("div",{key:i.name,class:"table-row"},[e("div",Ct,[e("span",Pt,a(f+1)+".",1),v(" "+a(i.name),1)]),e("div",Rt,a(i.score)+"%",1),e("div",Tt,a(i.courses_completed||0),1)]))),128)),(V=(x=s.kpiData.performance_analysis)==null?void 0:x.top_performing_users)!=null&&V.length?y("",!0):(c(),d("div",Ut,t[42]||(t[42]=[e("div",{class:"table-cell"},"No data available",-1),e("div",{class:"table-cell"},"-",-1),e("div",{class:"table-cell"},"-",-1)])))])])])]),e("div",Ft,[t[47]||(t[47]=e("h2",{class:"section-title"},"📊 Monthly Engagement Trend",-1)),e("div",Mt,[e("div",At,[t[45]||(t[45]=e("div",{class:"trend-header"},"Current Month",-1)),e("div",It,a(((G=s.kpiData.engagement_trends)==null?void 0:G.current_month_engagement)||0)+"%",1),e("div",Lt,a((Q=s.kpiData.period)==null?void 0:Q.period_name),1)]),e("div",jt,[e("span",qt,a(n.getTrendArrow((H=s.kpiData.engagement_trends)==null?void 0:H.trend_direction)),1),e("span",Et,a(((W=s.kpiData.engagement_trends)==null?void 0:W.trend_direction)||"stable"),1)]),e("div",Kt,[t[46]||(t[46]=e("div",{class:"trend-header"},"Previous Month",-1)),e("div",Bt,a(((X=s.kpiData.engagement_trends)==null?void 0:X.previous_month_engagement)||0)+"%",1),e("div",Nt,a(((Y=s.kpiData.engagement_trends)==null?void 0:Y.trend_percentage)||0)+"% change",1)])])]),e("div",zt,[e("div",Ot,[e("div",xt,[t[48]||(t[48]=e("strong",null,"Report Period:",-1)),v(" "+a(((J=s.kpiData.period)==null?void 0:J.period_name)||"Current Period"),1)]),e("div",Vt,[t[49]||(t[49]=e("strong",null,"Generated:",-1)),v(" "+a(n.formatDateTime(new Date)),1)]),t[50]||(t[50]=e("div",{class:"footer-line"},[e("strong",null,"System:"),v(" Training Management Platform ")],-1))])])]),n.screenshotUrl?(c(),d("div",{key:0,class:"preview-modal",onClick:t[5]||(t[5]=(...i)=>n.closePreview&&n.closePreview(...i))},[e("div",{class:"preview-content",onClick:t[4]||(t[4]=te(()=>{},["stop"]))},[e("div",Gt,[t[51]||(t[51]=e("h3",null,"📸 Screenshot Preview",-1)),e("button",{onClick:t[1]||(t[1]=(...i)=>n.closePreview&&n.closePreview(...i)),class:"close-btn"},"×")]),e("div",Qt,[e("img",{src:n.screenshotUrl,alt:"KPI Report Screenshot",class:"preview-image"},null,8,Ht),e("div",Wt,[e("button",{onClick:t[2]||(t[2]=(...i)=>n.downloadScreenshot&&n.downloadScreenshot(...i)),class:"action-btn download"}," 📥 Download "),e("button",{onClick:t[3]||(t[3]=(...i)=>n.copyToClipboard&&n.copyToClipboard(...i)),class:"action-btn copy"}," 📋 Copy to Clipboard ")])])])])):y("",!0)])}const Zt=oe(ne,[["render",Xt],["__scopeId","data-v-5dad4f34"]]);export{Zt as default};
