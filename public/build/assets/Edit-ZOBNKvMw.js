import{d as J,C as Q,r as C,l as H,a as m,o as n,b as s,u as e,m as K,w as o,e as r,P as U,f as l,j as O,h as v,n as p,t as u,F as R,i as X,g as T,W as Y}from"./app-B5QCrb6m.js";import{m as Z,f as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-DJEC7YWG.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-HglPE9Uv.js";import{_ as x}from"./Card.vue_vue_type_script_setup_true_lang-rG1y8srZ.js";import{_ as h}from"./CardContent.vue_vue_type_script_setup_true_lang-ByYzS1sI.js";import{_ as y}from"./CardDescription.vue_vue_type_script_setup_true_lang-Oz1CiL0m.js";import{_ as w}from"./CardHeader.vue_vue_type_script_setup_true_lang-i8h8wdgE.js";import{_ as V}from"./CardTitle.vue_vue_type_script_setup_true_lang-DIcnVnqd.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-BlrxH3n2.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-EtyyyGjz.js";import{_ as te}from"./Textarea.vue_vue_type_script_setup_true_lang-C5pU3-Wp.js";import{_ as se}from"./Switch.vue_vue_type_script_setup_true_lang-9hp-lYeE.js";import{_ as oe,a as ie,b as re,c as le,d as ae}from"./SelectValue.vue_vue_type_script_setup_true_lang-Dh59Np6e.js";import{_ as de}from"./Separator.vue_vue_type_script_setup_true_lang-pyQkjo-d.js";import{A as ne}from"./arrow-left-B0hvCoSc.js";import{C as A}from"./chart-column-jPOcDNnG.js";import{S as ue}from"./square-play-A86c4a24.js";import{L as me}from"./link-2-CZWntw17.js";import{L as fe}from"./loader-circle-2q0_yo-4.js";import{T as ce}from"./test-tube-DSyGYggB.js";import{I as M}from"./image-Cm7mPWG1.js";import{T as E}from"./trash-2-DS26tH46.js";import{S as ve}from"./save-BEx-_sRt.js";import"./index-Wv3lFKee.js";import"./index-DwxW3oru.js";import"./_plugin-vue_export-helper-De2CCZJH.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BsvRm7AT.js";import"./clock-Bxh51ez1.js";import"./useForwardPropsEmits-XLtpt7jX.js";import"./useForwardExpose-CdWF3mxt.js";import"./VisuallyHidden-DFMZRLOE.js";import"./VisuallyHiddenInput-D4a6WLgo.js";import"./usePrimitiveElement-BCH5APh8.js";import"./Presence-90U5lUsH.js";import"./ConfigProvider-Ck7rlyMT.js";import"./Teleport-CDIEPvRZ.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-BElrq5kp.js";import"./Collection-gYpN21x9.js";import"./check-CsM0Sj6i.js";import"./useSize--YsBV0yD.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";const _e={class:"max-w-4xl mx-auto space-y-6"},pe={class:"flex items-center gap-4"},ge={class:"space-y-2"},be={key:0,class:"text-sm text-destructive"},xe={class:"space-y-2"},he={key:0,class:"text-sm text-destructive"},ye={class:"space-y-2"},we={key:0,class:"text-sm text-destructive"},Ve={class:"space-y-2"},ke={class:"flex gap-2"},Se={key:0,class:"text-sm text-destructive"},$e={class:"space-y-2"},Ce={class:"flex gap-2"},Ue={class:"flex items-center px-3 py-2 bg-muted rounded-md text-sm text-muted-foreground min-w-0"},Te={key:0,class:"text-sm text-destructive"},Le={key:0,class:"space-y-4"},Pe={class:"mt-2 flex items-start gap-4"},De={class:"w-48 h-32 rounded-lg overflow-hidden bg-muted"},Re=["src","alt"],Ae={class:"flex-1 space-y-2"},Me={class:"flex gap-2"},Ee={class:"space-y-2"},je={class:"flex items-start gap-4"},Be={class:"w-32 h-24 rounded-lg border-2 border-dashed border-muted-foreground/25 bg-muted/50 flex items-center justify-center overflow-hidden shrink-0"},Fe=["src"],Ne={key:1,class:"text-center"},Ge={class:"flex-1"},qe={key:0,class:"text-sm text-destructive mt-1"},ze={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Ie={class:"flex items-center justify-between"},We={class:"space-y-1"},Je={class:"grid grid-cols-2 gap-4"},Qe={class:"text-center"},He={class:"text-2xl font-bold text-blue-600"},Ke={class:"text-center"},Oe={class:"text-2xl font-bold text-green-600"},Xe={class:"flex justify-between items-center"},Ye={class:"flex gap-2"},qt=J({__name:"Edit",props:{video:{},categories:{}},setup(j){var L;const f=j,B=[{title:"Video Management",href:"/admin/videos"},{title:"Edit Video",href:""}],i=Q({name:f.video.name,description:f.video.description||"",google_drive_url:f.video.google_drive_url,duration:f.video.duration,thumbnail:null,content_category_id:((L=f.video.content_category_id)==null?void 0:L.toString())||null,is_active:f.video.is_active,remove_thumbnail:!1}),k=C(!1),S=C(!1),g=C(null),F=a=>{var b;const d=(b=a.target.files)==null?void 0:b[0];if(d){i.thumbnail=d,i.remove_thumbnail=!1;const P=new FileReader;P.onload=W=>{var D;g.value=(D=W.target)==null?void 0:D.result},P.readAsDataURL(d)}else i.thumbnail=null,g.value=null},N=()=>{i.remove_thumbnail=!0,i.thumbnail=null,g.value=null},G=async()=>{if(i.google_drive_url){S.value=!0;try{console.log("Testing URL:",i.google_drive_url),await new Promise(a=>setTimeout(a,2e3)),alert("Video URL is valid!")}catch(a){console.error("URL test failed:",a),alert("Failed to validate video URL. Please check the link.")}finally{S.value=!1}}},q=a=>{if(!a)return"00:00";const t=Math.floor(a/3600),d=Math.floor(a%3600/60),b=a%60;return t>0?`${t.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`:`${d.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`},z=async()=>{k.value=!0,i.post(`/admin/videos/${f.video.id}/update`,{forceFormData:!0,onFinish:()=>{k.value=!1},onSuccess:()=>{console.log("Video updated successfully")},onError:a=>{console.error("Update failed:",a)}})},I=()=>{confirm(`Are you sure you want to delete "${f.video.name}"? This action cannot be undone and will remove all associated progress data.`)&&Y.delete(`/admin/videos/${f.video.id}`)};return H(()=>i.thumbnail,a=>{a&&(i.remove_thumbnail=!1)}),(a,t)=>(n(),m(R,null,[s(e(K),{title:`Edit ${a.video.name}`},null,8,["title"]),s(ee,{breadcrumbs:B},{default:o(()=>[r("div",_e,[r("div",pe,[s(e(_),{"as-child":"",variant:"ghost"},{default:o(()=>[s(e(U),{href:"/admin/videos"},{default:o(()=>[s(e(ne),{class:"h-4 w-4 mr-2"}),t[6]||(t[6]=l(" Back to Videos "))]),_:1})]),_:1}),t[8]||(t[8]=r("div",{class:"flex-1"},[r("h1",{class:"text-2xl font-bold"},"Edit Video Course"),r("p",{class:"text-muted-foreground"},"Update video course details and settings")],-1)),s(e(_),{"as-child":"",variant:"outline"},{default:o(()=>[s(e(U),{href:`/admin/videos/${a.video.id}`},{default:o(()=>[s(e(A),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=l(" View Analytics "))]),_:1},8,["href"])]),_:1})]),r("form",{onSubmit:O(z,["prevent"]),class:"space-y-6"},[s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(ue),{class:"h-5 w-5"}),t[9]||(t[9]=l(" Video Information "))]),_:1}),s(e(y),null,{default:o(()=>t[10]||(t[10]=[l(" Update the basic details for your video course ")])),_:1})]),_:1}),s(e(h),{class:"space-y-4"},{default:o(()=>[r("div",ge,[s(e(c),{for:"name"},{default:o(()=>t[11]||(t[11]=[l("Video Title")])),_:1}),s(e($),{id:"name",modelValue:e(i).name,"onUpdate:modelValue":t[0]||(t[0]=d=>e(i).name=d),type:"text",placeholder:"Enter video course title...",class:p({"border-destructive":e(i).errors.name}),required:""},null,8,["modelValue","class"]),e(i).errors.name?(n(),m("div",be,u(e(i).errors.name),1)):v("",!0)]),r("div",xe,[s(e(c),{for:"description"},{default:o(()=>t[12]||(t[12]=[l("Description")])),_:1}),s(e(te),{id:"description",modelValue:e(i).description,"onUpdate:modelValue":t[1]||(t[1]=d=>e(i).description=d),placeholder:"Describe what students will learn from this video course...",rows:"5",class:p({"border-destructive":e(i).errors.description})},null,8,["modelValue","class"]),e(i).errors.description?(n(),m("div",he,u(e(i).errors.description),1)):v("",!0)]),r("div",ye,[s(e(c),{for:"content_category_id"},{default:o(()=>t[13]||(t[13]=[l("Category")])),_:1}),s(e(oe),{modelValue:e(i).content_category_id,"onUpdate:modelValue":t[2]||(t[2]=d=>e(i).content_category_id=d)},{default:o(()=>[s(e(ie),{class:p({"border-destructive":e(i).errors.content_category_id})},{default:o(()=>[s(e(re),{placeholder:"Select a category..."})]),_:1},8,["class"]),s(e(le),null,{default:o(()=>[(n(!0),m(R,null,X(a.categories,d=>(n(),T(e(ae),{key:d.id,value:d.id.toString()},{default:o(()=>[l(u(d.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(i).errors.content_category_id?(n(),m("div",we,u(e(i).errors.content_category_id),1)):v("",!0),t[14]||(t[14]=r("div",{class:"text-sm text-muted-foreground"}," Select a category or leave unset for no category ",-1))])]),_:1})]),_:1}),s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(me),{class:"h-5 w-5"}),t[15]||(t[15]=l(" Video Source "))]),_:1}),s(e(y),null,{default:o(()=>t[16]||(t[16]=[l(" Update the video source and metadata ")])),_:1})]),_:1}),s(e(h),{class:"space-y-4"},{default:o(()=>[r("div",Ve,[s(e(c),{for:"google_drive_url"},{default:o(()=>t[17]||(t[17]=[l("Google Drive Video URL")])),_:1}),r("div",ke,[s(e($),{id:"google_drive_url",modelValue:e(i).google_drive_url,"onUpdate:modelValue":t[3]||(t[3]=d=>e(i).google_drive_url=d),type:"url",placeholder:"https://drive.google.com/file/d/...",class:p({"border-destructive":e(i).errors.google_drive_url}),required:""},null,8,["modelValue","class"]),s(e(_),{type:"button",variant:"outline",size:"icon",onClick:G,disabled:!e(i).google_drive_url||S.value},{default:o(()=>[S.value?(n(),T(e(fe),{key:0,class:"h-4 w-4 animate-spin"})):(n(),T(e(ce),{key:1,class:"h-4 w-4"}))]),_:1},8,["disabled"])]),e(i).errors.google_drive_url?(n(),m("div",Se,u(e(i).errors.google_drive_url),1)):v("",!0),t[18]||(t[18]=r("div",{class:"text-sm text-muted-foreground"},' Paste the shareable link from Google Drive. Make sure the video is set to "Anyone with the link can view" ',-1))]),r("div",$e,[s(e(c),{for:"duration"},{default:o(()=>t[19]||(t[19]=[l("Duration (seconds)")])),_:1}),r("div",Ce,[s(e($),{id:"duration",modelValue:e(i).duration,"onUpdate:modelValue":t[4]||(t[4]=d=>e(i).duration=d),type:"number",min:"1",max:"86400",placeholder:"e.g., 3600 for 1 hour",class:p({"border-destructive":e(i).errors.duration})},null,8,["modelValue","class"]),r("div",Ue,u(q(e(i).duration)),1)]),e(i).errors.duration?(n(),m("div",Te,u(e(i).errors.duration),1)):v("",!0)])]),_:1})]),_:1}),s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(M),{class:"h-5 w-5"}),t[20]||(t[20]=l(" Thumbnail "))]),_:1}),s(e(y),null,{default:o(()=>t[21]||(t[21]=[l(" Update or remove the video thumbnail ")])),_:1})]),_:1}),s(e(h),{class:"space-y-4"},{default:o(()=>[a.video.thumbnail_url?(n(),m("div",Le,[r("div",null,[s(e(c),null,{default:o(()=>t[22]||(t[22]=[l("Current Thumbnail")])),_:1}),r("div",Pe,[r("div",De,[r("img",{src:a.video.thumbnail_url,alt:a.video.name,class:"w-full h-full object-cover"},null,8,Re)]),r("div",Ae,[t[24]||(t[24]=r("p",{class:"text-sm text-muted-foreground"}," Current thumbnail for this video course ",-1)),r("div",Me,[s(e(_),{type:"button",variant:"outline",size:"sm",onClick:N},{default:o(()=>[s(e(E),{class:"h-4 w-4 mr-2"}),t[23]||(t[23]=l(" Remove Thumbnail "))]),_:1})])])])]),s(e(de))])):v("",!0),r("div",Ee,[s(e(c),{for:"thumbnail"},{default:o(()=>[l(u(a.video.thumbnail_url?"Replace":"Upload")+" Thumbnail",1)]),_:1}),r("div",je,[r("div",Be,[g.value?(n(),m("img",{key:0,src:g.value,class:"w-full h-full object-cover",alt:"New thumbnail preview"},null,8,Fe)):(n(),m("div",Ne,[s(e(M),{class:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),t[25]||(t[25]=r("div",{class:"text-xs text-muted-foreground"},"Preview",-1))]))]),r("div",Ge,[s(e($),{id:"thumbnail",type:"file",accept:"image/*",class:p({"border-destructive":e(i).errors.thumbnail}),onChange:F},null,8,["class"]),e(i).errors.thumbnail?(n(),m("div",qe,u(e(i).errors.thumbnail),1)):v("",!0),t[26]||(t[26]=r("div",{class:"text-sm text-muted-foreground mt-1"}," Recommended: 1280x720px (16:9 ratio), JPG or PNG, max 2MB ",-1))])])])]),_:1})]),_:1}),r("div",ze,[s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(Z),{class:"h-5 w-5"}),t[27]||(t[27]=l(" Settings "))]),_:1}),s(e(y),null,{default:o(()=>t[28]||(t[28]=[l(" Configure the video course settings ")])),_:1})]),_:1}),s(e(h),null,{default:o(()=>[r("div",Ie,[r("div",We,[s(e(c),null,{default:o(()=>t[29]||(t[29]=[l("Active Status")])),_:1}),t[30]||(t[30]=r("div",{class:"text-sm text-muted-foreground"}," Make this video course available to students ",-1))]),s(e(se),{checked:e(i).is_active,"onUpdate:checked":t[5]||(t[5]=d=>e(i).is_active=d)},null,8,["checked"])])]),_:1})]),_:1}),s(e(x),null,{default:o(()=>[s(e(w),null,{default:o(()=>[s(e(V),{class:"flex items-center gap-2"},{default:o(()=>[s(e(A),{class:"h-5 w-5"}),t[31]||(t[31]=l(" Quick Statistics "))]),_:1}),s(e(y),null,{default:o(()=>t[32]||(t[32]=[l(" Current performance metrics ")])),_:1})]),_:1}),s(e(h),null,{default:o(()=>[r("div",Je,[r("div",Qe,[r("div",He,u(a.video.total_viewers||0),1),t[33]||(t[33]=r("div",{class:"text-xs text-muted-foreground"},"Viewers",-1))]),r("div",Ke,[r("div",Oe,u(Math.round(a.video.avg_completion||0))+"%",1),t[34]||(t[34]=r("div",{class:"text-xs text-muted-foreground"},"Avg Progress",-1))])])]),_:1})]),_:1})]),r("div",Xe,[r("div",Ye,[s(e(_),{"as-child":"",variant:"outline"},{default:o(()=>[s(e(U),{href:"/admin/videos"},{default:o(()=>t[35]||(t[35]=[l("Cancel")])),_:1})]),_:1}),s(e(_),{type:"button",variant:"destructive",onClick:I},{default:o(()=>[s(e(E),{class:"h-4 w-4 mr-2"}),t[36]||(t[36]=l(" Delete Video "))]),_:1})]),s(e(_),{type:"submit",disabled:k.value||e(i).processing},{default:o(()=>[s(e(ve),{class:"h-4 w-4 mr-2"}),l(" "+u(k.value?"Updating...":"Update Video Course"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{qt as default};
