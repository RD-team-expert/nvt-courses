import{d as re,r as w,W as A,l as ie,g as _,o as i,w as o,e as n,b as s,u as t,f as r,a as u,F as $,i as S,t as d,k as de,h as v,n as me}from"./app-DvESifdT.js";import{_ as ue}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CTHgpUi1.js";import{l as ce}from"./lodash-BhFWMS62.js";import{_ as fe}from"./Pagination.vue_vue_type_script_setup_true_lang-DI35y5Fx.js";import{_ as C}from"./Button.vue_vue_type_script_setup_true_lang-CEpF3qtW.js";import{_ as N}from"./Input.vue_vue_type_script_setup_true_lang-D191Tqzq.js";import{_ as F}from"./Label.vue_vue_type_script_setup_true_lang-CZ_I_hBh.js";import{_ as P}from"./Card.vue_vue_type_script_setup_true_lang-BiCDAzlM.js";import{_ as _e}from"./CardContent.vue_vue_type_script_setup_true_lang-smW2hG8u.js";import{_ as pe}from"./CardDescription.vue_vue_type_script_setup_true_lang-CnjjdY-Q.js";import{_ as ve}from"./CardHeader.vue_vue_type_script_setup_true_lang-DlYXJLS4.js";import{_ as he}from"./CardTitle.vue_vue_type_script_setup_true_lang-DXaAOkkZ.js";import{_ as xe,a as ge,b as ye,c as we,d as R}from"./SelectValue.vue_vue_type_script_setup_true_lang-CLPxRvMl.js";import{_ as Ce,a as be,b as V,c as p,d as ke,e as f}from"./TableHeader.vue_vue_type_script_setup_true_lang-DXNujWhE.js";import{_ as B}from"./index-Bdi3z1dZ.js";import{_ as $e,a as Se,b as Fe,c as Ve}from"./DialogTitle.vue_vue_type_script_setup_true_lang-csUOpZJi.js";import{D as Ue}from"./download-CIc-_j2G.js";import{F as De}from"./filter-CbyEU9OF.js";import{R as Le}from"./rotate-ccw-E0Bs7NlF.js";import{U as E}from"./user-CXc_RSns.js";import{G as je}from"./graduation-cap-B8REQSx-.js";import{C as ze}from"./calendar-days-BVelaQk6.js";import{C as Te}from"./calendar-BD71jGan.js";import{C as U}from"./circle-check-big-DFMqv-MZ.js";import{S as M}from"./star-CZ7UprS2.js";import{M as q}from"./message-square-BdXdnDj4.js";import{F as Ae}from"./file-text-Clu00e0q.js";import{C as O}from"./circle-alert-BqvXWZ4F.js";import{P as Ne}from"./pause-C4xivdqb.js";import{C as Pe}from"./circle-x-CX0fkgDJ.js";import{C as Re}from"./clock-BiVRP5oK.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-BjRKJUfr.js";import"./index-C83yD4X2.js";import"./index-B3ghWQKD.js";import"./_plugin-vue_export-helper-BD6AW0L4.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BwZx7090.js";import"./useForwardPropsEmits-BEnXobQf.js";import"./Presence-Bhij4dqb.js";import"./ConfigProvider-DUGoRN6f.js";import"./useForwardExpose-DZczOEf-.js";import"./Teleport-BmvAeIE_.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-CGEVTIxO.js";import"./Collection-CKgbHBNW.js";import"./usePrimitiveElement-e9xeZsi3.js";import"./check-BVRAykfv.js";import"./useSize-CKxgQ-7v.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./VisuallyHidden-8dt5TWF3.js";const Be={class:"px-4 sm:px-0 space-y-6"},Ee={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Me={class:"flex items-center"},qe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Oe={class:"space-y-2"},Ie={class:"space-y-2"},We={class:"space-y-2"},Ge={class:"flex justify-end mt-4"},He={class:"overflow-x-auto"},Ke={class:"flex items-center"},Xe={class:"flex items-center"},Je={class:"flex items-center"},Qe={class:"flex items-center"},Ye={class:"flex items-center"},Ze={class:"flex items-center"},et={class:"flex items-center"},tt={class:"flex items-center"},st={class:"flex flex-col items-center"},at={class:"space-y-1"},ot={class:"font-medium text-foreground"},lt={class:"text-xs text-muted-foreground hidden sm:block"},nt={class:"text-xs text-muted-foreground sm:hidden"},rt={class:"space-y-1 max-w-xs"},it={key:0,class:"text-sm text-foreground"},dt={key:1,class:"text-xs text-muted-foreground"},mt={key:2,class:"text-xs text-muted-foreground"},ut={key:0},ct={key:3,class:"text-muted-foreground text-sm"},ft={class:"text-sm text-foreground"},_t={class:"text-sm text-foreground"},pt={key:0,class:"flex items-center space-x-2"},vt={class:"text-sm font-medium"},ht={class:"flex"},xt={key:1,class:"text-muted-foreground"},gt={class:"max-w-xs"},yt={key:1,class:"text-muted-foreground"},wt={class:"max-w-xs"},Ct={key:1,class:"text-muted-foreground"},bt={class:"px-4 sm:px-6 py-3 border-t"},kt={key:1,class:"text-sm text-muted-foreground mt-2"},$t={class:"mt-4"},St={class:"text-sm text-muted-foreground whitespace-pre-wrap break-words max-h-96 overflow-y-auto p-4 bg-muted/50 rounded-lg"},bs=re({__name:"CourseCompletion",props:{completions:Object,courses:Array,filters:Object,debug:Object},setup(m){var j,z,T;const b=m,I=[{name:"Dashboard",href:route("dashboard")},{name:"Reports & Analytics",href:route("admin.reports.index")},{name:"Course Completion",href:route("admin.reports.course-completion")}],c=w({course_id:((j=b.filters)==null?void 0:j.course_id)||"",date_from:((z=b.filters)==null?void 0:z.date_from)||"",date_to:((T=b.filters)==null?void 0:T.date_to)||""}),h=w(!1),x=w(""),g=w(""),W=l=>{c.value.course_id=l==="all"?"":l},G=l=>{switch(l?l.toLowerCase():"unknown"){case"completed":return"default";case"enrolled":return"secondary";case"in_progress":case"in-progress":case"active":return"outline";case"pending":return"secondary";case"cancelled":case"canceled":return"destructive";case"on_hold":case"on-hold":return"outline";default:return"secondary"}},H=l=>{switch(l?l.toLowerCase():"unknown"){case"completed":return U;case"enrolled":return E;case"in_progress":case"in-progress":case"active":return Re;case"pending":return O;case"cancelled":case"canceled":return Pe;case"on_hold":case"on-hold":return Ne;default:return O}},K=l=>{if(!l)return"Unknown";switch(l.toLowerCase()){case"completed":return"Completed";case"enrolled":return"Enrolled";case"in_progress":case"in-progress":return"In Progress";case"active":return"Active";case"pending":return"Pending";case"cancelled":case"canceled":return"Cancelled";case"on_hold":case"on-hold":return"On Hold";default:return l.charAt(0).toUpperCase()+l.slice(1).toLowerCase()}},X=()=>{c.value={course_id:"",date_from:"",date_to:""},D()},D=ce.debounce(()=>{A.get(route("admin.reports.course-completion"),c.value,{preserveState:!0,replace:!0})},500);ie(c,()=>{D()},{deep:!0});const J=()=>{const l=new URLSearchParams(c.value).toString();window.location.href=route("admin.reports.export.course-completion")+"?"+l},L=l=>l?new Date(l).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"â€”",Q=l=>{if(!l)return"";const e={monday:"Mon",tuesday:"Tue",wednesday:"Wed",thursday:"Thu",friday:"Fri",saturday:"Sat",sunday:"Sun"};return l.split(",").map(y=>e[y.trim().toLowerCase()]||y).join(", ")},Y=l=>{if(!l)return"";try{return new Date(`2000-01-01 ${l}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}catch{return l}},Z=l=>{if(!l)return"";const e=Math.floor(l/60),a=l%60;return e>0&&a>0?`${e}h ${a}m`:e>0?`${e} hour${e>1?"s":""}`:`${a} minute${a>1?"s":""}`},ee=l=>{A.get(route("admin.reports.course-completion"),{...c.value,page:l},{preserveState:!0,replace:!0,preserveScroll:!0,onSuccess:()=>{var e;(e=document.querySelector(".bg-white.rounded-lg.shadow"))==null||e.scrollIntoView({behavior:"smooth",block:"start"})}})},te=(l,e)=>{x.value=`Feedback from ${e}`,g.value=l||"No feedback provided",h.value=!0},se=(l,e)=>{x.value=`Comment from ${e}`,g.value=l||"No comment provided",h.value=!0},ae=()=>{h.value=!1,x.value="",g.value=""},oe=l=>{l.key==="Escape"&&h.value&&ae()};typeof window<"u"&&window.addEventListener("keydown",oe);const le=l=>{const e=[];for(let a=1;a<=5;a++)e.push(a<=l?"filled":"empty");return e};return(l,e)=>(i(),_(ue,{breadcrumbs:I},{default:o(()=>[n("div",Be,[n("div",Ee,[e[4]||(e[4]=n("div",null,[n("h1",{class:"text-xl sm:text-2xl font-bold text-foreground"},"Course Completion Report"),n("p",{class:"text-sm text-muted-foreground mt-1"},"Comprehensive reporting interface for tracking course completion status and statistics")],-1)),s(t(C),{onClick:J,class:"w-full sm:w-auto"},{default:o(()=>[s(t(Ue),{class:"mr-2 h-4 w-4"}),e[3]||(e[3]=r(" Export to CSV "))]),_:1})]),s(t(P),null,{default:o(()=>[s(t(ve),null,{default:o(()=>[n("div",Me,[s(t(De),{class:"mr-2 h-5 w-5 text-primary"}),n("div",null,[s(t(he),null,{default:o(()=>e[5]||(e[5]=[r("Filter Completions")])),_:1}),s(t(pe),null,{default:o(()=>e[6]||(e[6]=[r("Use the filters below to narrow down the completion records")])),_:1})])])]),_:1}),s(t(_e),null,{default:o(()=>[n("div",qe,[n("div",Oe,[s(t(F),{for:"course_filter"},{default:o(()=>e[7]||(e[7]=[r("Course")])),_:1}),s(t(xe),{"model-value":c.value.course_id||"all","onUpdate:modelValue":W},{default:o(()=>[s(t(ge),{id:"course_filter"},{default:o(()=>[s(t(ye),{placeholder:"All Courses"})]),_:1}),s(t(we),null,{default:o(()=>[s(t(R),{value:"all"},{default:o(()=>e[8]||(e[8]=[r("All Courses")])),_:1}),(i(!0),u($,null,S(m.courses,a=>(i(),_(t(R),{key:a.id,value:a.id.toString()},{default:o(()=>[r(d(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),n("div",Ie,[s(t(F),{for:"date_from"},{default:o(()=>e[9]||(e[9]=[r("Completed From")])),_:1}),s(t(N),{id:"date_from",type:"date",modelValue:c.value.date_from,"onUpdate:modelValue":e[0]||(e[0]=a=>c.value.date_from=a)},null,8,["modelValue"])]),n("div",We,[s(t(F),{for:"date_to"},{default:o(()=>e[10]||(e[10]=[r("Completed To")])),_:1}),s(t(N),{id:"date_to",type:"date",modelValue:c.value.date_to,"onUpdate:modelValue":e[1]||(e[1]=a=>c.value.date_to=a)},null,8,["modelValue"])])]),n("div",Ge,[s(t(C),{onClick:X,variant:"outline"},{default:o(()=>[s(t(Le),{class:"mr-2 h-4 w-4"}),e[11]||(e[11]=r(" Reset Filters "))]),_:1})])]),_:1})]),_:1}),s(t(P),null,{default:o(()=>[n("div",He,[s(t(Ce),null,{default:o(()=>[s(t(be),null,{default:o(()=>[s(t(V),null,{default:o(()=>[s(t(p),null,{default:o(()=>[n("div",Ke,[s(t(E),{class:"mr-2 h-4 w-4"}),e[12]||(e[12]=r(" User "))])]),_:1}),s(t(p),{class:"hidden sm:table-cell"},{default:o(()=>[n("div",Xe,[s(t(je),{class:"mr-2 h-4 w-4"}),e[13]||(e[13]=r(" Course "))])]),_:1}),s(t(p),null,{default:o(()=>e[14]||(e[14]=[r("Status")])),_:1}),s(t(p),{class:"hidden lg:table-cell"},{default:o(()=>[n("div",Je,[s(t(ze),{class:"mr-2 h-4 w-4"}),e[15]||(e[15]=r(" Course Schedule "))])]),_:1}),s(t(p),{class:"hidden md:table-cell"},{default:o(()=>[n("div",Qe,[s(t(Te),{class:"mr-2 h-4 w-4"}),e[16]||(e[16]=r(" Registered "))])]),_:1}),s(t(p),null,{default:o(()=>[n("div",Ye,[s(t(U),{class:"mr-2 h-4 w-4"}),e[17]||(e[17]=r(" Completed "))])]),_:1}),s(t(p),{class:"hidden md:table-cell"},{default:o(()=>[n("div",Ze,[s(t(M),{class:"mr-2 h-4 w-4"}),e[18]||(e[18]=r(" Rating "))])]),_:1}),s(t(p),{class:"hidden lg:table-cell"},{default:o(()=>[n("div",et,[s(t(q),{class:"mr-2 h-4 w-4"}),e[19]||(e[19]=r(" Feedback "))])]),_:1}),s(t(p),{class:"hidden xl:table-cell"},{default:o(()=>[n("div",tt,[s(t(Ae),{class:"mr-2 h-4 w-4"}),e[20]||(e[20]=r(" Comment "))])]),_:1})]),_:1})]),_:1}),s(t(ke),null,{default:o(()=>[m.completions.data.length===0?(i(),_(t(V),{key:0},{default:o(()=>[s(t(f),{colspan:"9",class:"text-center text-muted-foreground py-8"},{default:o(()=>[n("div",st,[s(t(U),{class:"h-12 w-12 text-muted-foreground mb-2"}),e[21]||(e[21]=r(" No completion records found "))])]),_:1})]),_:1})):(i(!0),u($,{key:1},S(m.completions.data,(a,y)=>(i(),_(t(V),{key:y,class:"hover:bg-muted/50"},{default:o(()=>[s(t(f),null,{default:o(()=>[n("div",at,[n("div",ot,d(a.username),1),n("div",lt,d(a.useremail),1),n("div",nt,d(a.coursename),1)])]),_:2},1024),s(t(f),{class:"hidden sm:table-cell"},{default:o(()=>[s(t(B),{variant:"outline"},{default:o(()=>[r(d(a.coursename),1)]),_:2},1024)]),_:2},1024),s(t(f),null,{default:o(()=>[s(t(B),{variant:G(a.coursestatus),class:"flex items-center w-fit"},{default:o(()=>[(i(),_(de(H(a.coursestatus)),{class:"mr-1 h-3 w-3"})),r(" "+d(K(a.coursestatus)),1)]),_:2},1032,["variant"])]),_:2},1024),s(t(f),{class:"hidden lg:table-cell"},{default:o(()=>[n("div",rt,[a.availability_daterange?(i(),u("div",it,d(a.availability_daterange),1)):v("",!0),a.availability_days?(i(),u("div",dt,d(Q(a.availability_days)),1)):v("",!0),a.availability_sessiontime?(i(),u("div",mt,[r(d(Y(a.availability_sessiontime))+" ",1),a.availability_duration?(i(),u("span",ut," ("+d(Z(a.availability_duration))+") ",1)):v("",!0)])):v("",!0),a.availability_daterange?v("",!0):(i(),u("span",ct,"â€”"))])]),_:2},1024),s(t(f),{class:"hidden md:table-cell"},{default:o(()=>[n("div",ft,d(L(a.registeredat)),1)]),_:2},1024),s(t(f),null,{default:o(()=>[n("div",_t,d(L(a.completedat)),1)]),_:2},1024),s(t(f),{class:"hidden md:table-cell"},{default:o(()=>[a.rating?(i(),u("div",pt,[n("span",vt,d(a.rating)+"/5",1),n("div",ht,[(i(!0),u($,null,S(le(a.rating),(k,ne)=>(i(),_(t(M),{key:ne,class:me(["h-4 w-4",k==="filled"?"text-yellow-400 fill-yellow-400":"text-muted-foreground"])},null,8,["class"]))),128))])])):(i(),u("span",xt,"â€”"))]),_:2},1024),s(t(f),{class:"hidden lg:table-cell"},{default:o(()=>[n("div",gt,[a.feedback?(i(),_(t(C),{key:0,onClick:k=>te(a.feedback,a.username),variant:"link",size:"sm",class:"h-auto p-0 text-left justify-start",title:`Click to view full feedback from ${a.username}`},{default:o(()=>[r(d(a.feedback.length>30?a.feedback.substring(0,30)+"...":a.feedback),1)]),_:2},1032,["onClick","title"])):(i(),u("span",yt,"â€”"))])]),_:2},1024),s(t(f),{class:"hidden xl:table-cell"},{default:o(()=>[n("div",wt,[a.comment?(i(),_(t(C),{key:0,onClick:k=>se(a.comment,a.username),variant:"link",size:"sm",class:"h-auto p-0 text-left justify-start",title:`Click to view full comment from ${a.username}`},{default:o(()=>[r(d(a.comment.length>30?a.comment.substring(0,30)+"...":a.comment),1)]),_:2},1032,["onClick","title"])):(i(),u("span",Ct,"â€”"))])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),n("div",bt,[m.completions.data&&m.completions.data.length>0&&m.completions.last_page>1?(i(),_(fe,{key:0,links:m.completions.links,onPageChanged:ee,class:"mt-4"},null,8,["links"])):v("",!0),m.completions.data&&m.completions.data.length>0?(i(),u("div",kt," Showing "+d(m.completions.from)+" to "+d(m.completions.to)+" of "+d(m.completions.total)+" results ",1)):v("",!0)])]),_:1})]),s(t($e),{open:h.value,"onUpdate:open":e[2]||(e[2]=a=>h.value=a)},{default:o(()=>[s(t(Se),{class:"max-w-2xl"},{default:o(()=>[s(t(Fe),null,{default:o(()=>[s(t(Ve),{class:"flex items-center"},{default:o(()=>[s(t(q),{class:"mr-2 h-5 w-5 text-primary"}),r(" "+d(x.value),1)]),_:1})]),_:1}),n("div",$t,[n("div",St,d(g.value),1)])]),_:1})]),_:1},8,["open"])]),_:1}))}});export{bs as default};
