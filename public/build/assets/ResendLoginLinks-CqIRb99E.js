import{r as w,C as v,c as S,k as A,o,w as F,e,a as l,f as _,l as D,g as f,u as r,v as H,j as N,t as n,F as x,h as y,q as $,i as C,n as z,W as E}from"./app-n_cIwlLT.js";import{_ as q}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DEbUraED.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-Rz_S81Vw.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B9XjMpGI.js";import"./index-BgSmG8al.js";const O={class:"px-4 sm:px-6 lg:px-8"},R={class:"mb-6 bg-white rounded-lg shadow-sm border p-6"},W={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},G={class:"flex-1 max-w-md"},I={class:"relative"},J={class:"flex gap-3"},K={class:"bg-white rounded-lg shadow-sm border overflow-hidden"},P={class:"overflow-x-auto"},Q={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-gray-50"},Y={class:"px-6 py-3 text-left"},Z=["checked"],ee={class:"bg-white divide-y divide-gray-200"},se={class:"px-6 py-4"},te=["value"],oe={class:"px-6 py-4"},le={class:"flex items-center"},re={class:"flex-shrink-0 h-10 w-10"},ne={class:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"},ie={class:"text-sm font-medium text-gray-700"},de={class:"ml-4"},ae={class:"text-sm font-medium text-gray-900"},ue={class:"text-sm text-gray-500"},ce={class:"px-6 py-4 text-sm text-gray-500"},ge={class:"px-6 py-4 text-sm text-gray-500"},xe={class:"px-6 py-4"},pe={class:"flex items-center gap-2"},be=["value"],me=["onClick","disabled"],fe={key:0,class:"bg-white px-4 py-3 border-t border-gray-200"},ye={class:"flex items-center justify-between"},he={class:"text-sm text-gray-700"},ve={class:"flex space-x-2"},_e=["onClick","innerHTML"],ke=["innerHTML"],we={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Se={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Ce={class:"mb-4"},Le=["value"],Me={class:"text-sm text-gray-600 mb-6"},Ue={class:"flex gap-3"},je=["disabled"],Be={key:0},Te={key:1},Ne={__name:"ResendLoginLinks",props:{users:Object,courses:Array,filters:Object},setup(d){const p=d,i=w([]),b=w(!1),h=v({search:p.filters.search||""}),u=v({course_id:""}),c=v({user_ids:[],course_id:""}),L=S(()=>i.value.length>0),k=S(()=>i.value.length===p.users.data.length&&p.users.data.length>0);function M(){h.get(route("admin.resend-login-links.index"),{preserveState:!0,replace:!0})}function U(g,s){u.course_id=s,u.post(route("admin.resend-login-links.resend",g.id),{preserveScroll:!0,onSuccess:()=>{u.reset()}})}function j(){k.value?i.value=[]:i.value=p.users.data.map(g=>g.id)}function B(){c.user_ids=i.value,b.value=!0}function T(){c.post(route("admin.resend-login-links.bulk"),{preserveScroll:!0,onSuccess:()=>{i.value=[],b.value=!1,c.reset()}})}function V(g){return g?new Date(g).toLocaleDateString():"Never"}return(g,s)=>(o(),A(q,null,{default:F(()=>[e("div",O,[s[17]||(s[17]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Resend Login Links"),e("p",{class:"mt-2 text-gray-600"},"Send new secure login links to users with expired access")],-1)),e("div",R,[e("div",W,[e("div",G,[e("form",{onSubmit:D(M,["prevent"])},[e("div",I,[f(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>r(h).search=t),type:"text",placeholder:"Search users by name or email...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[H,r(h).search]]),s[5]||(s[5]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])],32)]),e("div",J,[L.value?(o(),l("button",{key:0,onClick:B,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"},[s[6]||(s[6]=e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 1.05c.39.05.78.05 1.17 0L20 8M3 8v8a2 2 0 002 2h14a2 2 0 002-2V8M3 8l2-5h14l2 5"})],-1)),N(" Send to "+n(i.value.length)+" Users ",1)])):_("",!0)])])]),e("div",K,[e("div",P,[e("table",Q,[e("thead",X,[e("tr",null,[e("th",Y,[e("input",{type:"checkbox",checked:k.value,onChange:j,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,40,Z)]),s[7]||(s[7]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"User",-1)),s[8]||(s[8]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status",-1)),s[9]||(s[9]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Last Login",-1)),s[10]||(s[10]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Courses",-1)),s[11]||(s[11]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions",-1))])]),e("tbody",ee,[(o(!0),l(x,null,y(d.users.data,t=>{var m;return o(),l("tr",{key:t.id,class:"hover:bg-gray-50"},[e("td",se,[f(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>i.value=a),value:t.id,type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,te),[[$,i.value]])]),e("td",oe,[e("div",le,[e("div",re,[e("div",ne,[e("span",ie,n(t.name.charAt(0)),1)])]),e("div",de,[e("div",ae,n(t.name),1),e("div",ue,n(t.email),1)])])]),s[13]||(s[13]=e("td",{class:"px-6 py-4"},[e("span",{class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800"}," Expired Access ")],-1)),e("td",ce,n(V(t.login_token_expires_at)),1),e("td",ge,n(((m=t.course_registrations)==null?void 0:m.length)||0)+" enrolled ",1),e("td",xe,[e("div",pe,[f(e("select",{"onUpdate:modelValue":s[2]||(s[2]=a=>r(u).course_id=a),class:"text-sm border border-gray-300 rounded px-3 py-1 focus:ring-2 focus:ring-blue-500"},[s[12]||(s[12]=e("option",{value:""},"Select Course",-1)),(o(!0),l(x,null,y(d.courses,a=>(o(),l("option",{key:a.id,value:a.id},n(a.name),9,be))),128))],512),[[C,r(u).course_id]]),e("button",{onClick:a=>U(t,r(u).course_id),disabled:!r(u).course_id||r(u).processing,class:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"}," Send Link ",8,me)])])])}),128))])])]),d.users.links?(o(),l("div",fe,[e("div",ye,[e("div",he," Showing "+n(d.users.from)+" to "+n(d.users.to)+" of "+n(d.users.total)+" results ",1),e("div",ve,[(o(!0),l(x,null,y(d.users.links,(t,m)=>(o(),l(x,{key:m},[t.url?(o(),l("button",{key:0,onClick:a=>r(E).get(t.url),class:z(["px-3 py-2 text-sm border rounded",t.active?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"]),innerHTML:t.label},null,10,_e)):(o(),l("span",{key:1,class:"px-3 py-2 text-sm text-gray-400 border border-gray-300 rounded bg-gray-100",innerHTML:t.label},null,8,ke))],64))),128))])])])):_("",!0)]),b.value?(o(),l("div",we,[e("div",Se,[s[16]||(s[16]=e("h3",{class:"text-lg font-semibold mb-4"},"Send Login Links to Multiple Users",-1)),e("div",Ce,[s[15]||(s[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select Course",-1)),f(e("select",{"onUpdate:modelValue":s[3]||(s[3]=t=>r(c).course_id=t),class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500",required:""},[s[14]||(s[14]=e("option",{value:""},"Choose a course...",-1)),(o(!0),l(x,null,y(d.courses,t=>(o(),l("option",{key:t.id,value:t.id},n(t.name),9,Le))),128))],512),[[C,r(c).course_id]])]),e("p",Me," This will send new login links to "+n(i.value.length)+" selected users. ",1),e("div",Ue,[e("button",{onClick:T,disabled:!r(c).course_id||r(c).processing,class:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"},[r(c).processing?(o(),l("span",Be,"Sending...")):(o(),l("span",Te,"Send Login Links"))],8,je),e("button",{onClick:s[4]||(s[4]=t=>b.value=!1),class:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors"}," Cancel ")])])])):_("",!0)])]),_:1}))}};export{Ne as default};
