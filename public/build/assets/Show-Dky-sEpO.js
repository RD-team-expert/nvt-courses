import{d as z,r as O,s as M,C as A,c as D,k as Y,o as n,w as v,e as s,a as o,f as u,t as a,n as m,j as x,b as p,u as l,P as w,F as T,h as j,g as B,x as $,v as q,W as S}from"./app-n_cIwlLT.js";import{_ as H}from"./AppLayout.vue_vue_type_script_setup_true_lang-Rz_S81Vw.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B9XjMpGI.js";import"./index-BgSmG8al.js";const I={class:"container px-4 mx-auto py-6 sm:py-8 max-w-7xl"},G={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6 sm:mb-8"},K={class:"text-2xl sm:text-3xl font-bold text-gray-800"},W={key:0,class:"mb-6"},J={class:"flex items-start justify-between"},Q={class:"flex"},X={class:"flex-shrink-0"},Z={class:"ml-3"},_={class:"text-sm font-medium"},ee={key:0},se={key:1},te={key:2},ne={key:3},oe={class:"mt-1 text-sm text-gray-600"},re={key:0},ie={key:0,class:"mt-4 flex gap-3"},le={class:"course-details-grid grid grid-cols-1 lg:grid-cols-3 gap-6 sm:gap-8"},ae={class:"lg:col-span-2 bg-white rounded-xl shadow-sm overflow-hidden transition-shadow duration-200 hover:shadow-md"},de={class:"course-image-container"},ue=["src","alt"],ce={key:1,class:"absolute inset-0 flex items-center justify-center bg-gray-100"},me={class:"p-6 sm:p-8"},ge=["innerHTML"],be={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm"},xe={class:"bg-gray-50 p-4 rounded-lg transition-colors duration-200 hover:bg-gray-100"},ye={class:"font-semibold text-gray-900"},fe={class:"bg-gray-50 p-4 rounded-lg transition-colors duration-200 hover:bg-gray-100"},he={class:"font-semibold text-gray-900"},ve={key:0,class:"bg-gray-50 p-4 rounded-lg transition-colors duration-200 hover:bg-gray-100"},ke={class:"font-semibold text-gray-900 capitalize"},Ae={key:1,class:"bg-gray-50 p-4 rounded-lg transition-colors duration-200 hover:bg-gray-100"},pe={class:"font-semibold text-gray-900"},we={class:"enrollment-card bg-white rounded-xl shadow-sm overflow-hidden"},Se={class:"p-6 sm:p-8"},Ce={key:0,class:"mb-6"},Ee={key:0},Re={key:1},Me={key:2},De={key:3},Te={class:"flex items-start justify-between"},je={class:"flex items-start"},Be=["value","disabled"],Le={class:"font-medium text-gray-900"},Pe={class:"text-sm text-gray-600 mt-1"},Fe={key:0,class:"text-sm text-gray-500 mt-1"},Ve={class:"session-details mt-2"},Ne={class:"text-blue-600 font-medium"},Ue={key:0},ze={class:"text-right ml-4"},Oe={key:0},Ye={key:1},$e={key:2},qe={class:"text-xs text-gray-500 mt-1"},He={key:5},Ie=["disabled"],Ge={key:0},Ke={key:1},We={key:2},Je={key:3},Qe={key:4,class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Xe={class:"space-y-4"},Ze={class:"flex items-center p-4 bg-gray-50 rounded-lg transition-colors duration-200"},_e={class:"font-medium text-gray-800"},es={key:0,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},ss={class:"mb-4"},ts={class:"flex space-x-1"},ns=["onClick"],os={class:"mb-4"},rs={key:0,class:"text-red-500 text-sm mt-1"},is=["disabled"],ls={key:0},as={key:1},ds={key:1,class:"bg-green-50 border border-green-200 rounded-lg p-4"},us={key:0,class:"text-xs text-green-600 mb-4"},cs={class:"text-yellow-500"},ms=["disabled"],gs={key:0},bs={key:1},xs={key:2,class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ys={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4"},fs={class:"mt-4 space-y-4"},hs={key:3,class:"session-info-card"},vs={class:"font-semibold text-blue-900"},ks={class:"text-sm text-blue-700 mt-1"},As={class:"text-xs text-blue-600 mt-2"},Es=z({__name:"Show",props:{course:Object,isEnrolled:Boolean,userStatus:String,selectedAvailability:Object,availabilities:Array,userAssignment:Object,completion:Object},setup(e){const d=e,k=O(0);M(()=>d.completion,(r,t)=>{console.log("Completion changed:",t,"->",r),k.value+=1},{deep:!0}),M(()=>d.userStatus,(r,t)=>{console.log("UserStatus changed:",t,"->",r),k.value+=1});const c=A({rating:0,feedback:""}),y=D(()=>{const r=d.completion&&d.completion.rating!==null;return console.log("hasRated computed:",r,"completion:",d.completion),r});D(()=>d.isEnrolled&&(d.userStatus==="pending"||d.userStatus==="in_progress")&&y.value);function L(){console.log("=== VUE SUBMIT RATING START ==="),console.log("Rating form data:",c.data()),console.log("Props before rating:",{completion:d.completion,userStatus:d.userStatus,isEnrolled:d.isEnrolled}),c.post(route("courses.submitRating",d.course.id),{onSuccess:r=>{console.log("âœ… Rating submitted successfully"),console.log("Server response:",r),console.log("New props:",r.props),S.reload({only:["completion","userStatus","isEnrolled"]})},onError:r=>{console.error("âŒ Rating submission failed:",r)}})}const g=A({course_availability_id:null});function P(){if(console.log("=== ENROLLMENT DEBUG START ==="),d.availabilities&&d.availabilities.length>0&&!g.course_availability_id){alert("Please select a date range before enrolling.");return}g.post(route("courses.enroll",d.course.id),{preserveState:!0,onSuccess:r=>{console.log("âœ… Enrollment SUCCESS!"),S.reload({only:["isEnrolled","userStatus","selectedAvailability"]})},onError:r=>{console.error("âŒ Enrollment FAILED!",r)}})}const f=A({});function F(){console.log("=== VUE MARK COMPLETED START ==="),console.log("Current props:",{completion:d.completion,userStatus:d.userStatus,hasRated:y.value}),f.post(route("courses.markCompleted",d.course.id),{onSuccess:r=>{console.log("âœ… Course marked as completed"),console.log("Server response:",r),S.reload({only:["userStatus"]})},onError:r=>{console.error("âŒ Failed to mark course as completed:",r)}})}const V=r=>({pending:"Pending",in_progress:"In Progress",completed:"Completed"})[r]||r,h=r=>{if(!r)return"â€”";const t=new Date(r);return t.toLocaleDateString()+" at "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},C=r=>r?new Date(r).toLocaleDateString():"â€”",E=r=>r?r===1?"1 Session":`${r} Sessions`:"â€”",N=(r,t)=>{if(!t)return"Sessions not specified";const b=t-r;return b<=0?"All sessions booked":b===1?"1 session available":`${b} sessions available`},U=[{name:"Dashboard",href:route("dashboard")},{name:"Courses",href:route("courses.index")},{name:d.course.name,href:route("courses.show",d.course.id)}];return(r,t)=>(n(),Y(H,{breadcrumbs:U},{default:v(()=>{var b;return[s("div",I,[s("div",G,[s("h1",K,a(e.course.name),1),s("span",{class:m(["px-3 py-1.5 text-sm rounded-full shadow-sm transition-colors duration-200",{"bg-green-100 text-green-800":e.course.status==="in_progress","bg-yellow-100 text-yellow-800":e.course.status==="pending","bg-blue-100 text-blue-800":e.course.status==="completed"}])},a(V(e.course.status)),3)]),e.userAssignment?(n(),o("div",W,[s("div",{class:m(["bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 shadow-sm",{"from-yellow-50 to-orange-50 border-yellow-200":e.userAssignment.status==="pending","from-green-50 to-emerald-50 border-green-200":e.userAssignment.status==="accepted","from-red-50 to-pink-50 border-red-200":e.userAssignment.status==="declined"}])},[s("div",J,[s("div",Q,[s("div",X,[(n(),o("svg",{class:m(["h-5 w-5 mt-0.5",{"text-yellow-500":e.userAssignment.status==="pending","text-green-500":e.userAssignment.status==="accepted","text-blue-500":e.userAssignment.status!=="pending"&&e.userAssignment.status!=="accepted","text-red-500":e.userAssignment.status==="declined"}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t[2]||(t[2]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]),2))]),s("div",Z,[s("h3",_,[e.userAssignment.status==="pending"?(n(),o("span",ee,"ðŸ“‹ Course Assignment - Action Required")):e.userAssignment.status==="accepted"?(n(),o("span",se,"âœ… Course Assignment - Accepted")):e.userAssignment.status==="declined"?(n(),o("span",te,"âŒ Course Assignment - Declined")):e.userAssignment.status==="completed"?(n(),o("span",ne,"ðŸŽ‰ Course Assignment - Completed")):u("",!0)]),s("div",oe,[e.userAssignment.assigned_by?(n(),o("p",re,[t[3]||(t[3]=s("span",{class:"font-medium"},"Assigned by:",-1)),x(" "+a(e.userAssignment.assigned_by),1)])):u("",!0)])])]),e.userAssignment.status?(n(),o("span",{key:0,class:m(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":e.userAssignment.status==="pending","bg-green-100 text-green-800":e.userAssignment.status==="accepted","bg-red-100 text-red-800":e.userAssignment.status==="declined","bg-blue-100 text-blue-800":e.userAssignment.status==="completed"}])},a(e.userAssignment.status.charAt(0).toUpperCase()+e.userAssignment.status.slice(1)),3)):u("",!0)]),e.userAssignment.status==="pending"?(n(),o("div",ie,[p(l(w),{href:r.route("assignments.accept",e.userAssignment.id),method:"post",class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-green-600 hover:bg-green-700 transition-colors duration-200"},{default:v(()=>t[4]||(t[4]=[x(" Accept Assignment ")])),_:1},8,["href"]),p(l(w),{href:r.route("assignments.decline",e.userAssignment.id),method:"post",class:"inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200"},{default:v(()=>t[5]||(t[5]=[x(" Decline Assignment ")])),_:1},8,["href"])])):u("",!0)],2)])):u("",!0),s("div",le,[s("div",ae,[s("div",de,[e.course.image_path?(n(),o("img",{key:0,src:`/storage/${e.course.image_path}`,alt:e.course.name,class:"w-full h-full object-cover",loading:"lazy"},null,8,ue)):(n(),o("div",ce,t[6]||(t[6]=[s("svg",{class:"w-12 h-12 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))]),s("div",me,[s("div",{class:"prose max-w-none mb-8",innerHTML:e.course.description},null,8,ge),s("div",be,[s("div",xe,[t[7]||(t[7]=s("p",{class:"text-gray-500 mb-1.5 font-medium"},"Start Date",-1)),s("p",ye,a(C(e.course.start_date)),1)]),s("div",fe,[t[8]||(t[8]=s("p",{class:"text-gray-500 mb-1.5 font-medium"},"End Date",-1)),s("p",he,a(C(e.course.end_date)),1)]),e.course.level?(n(),o("div",ve,[t[9]||(t[9]=s("p",{class:"text-gray-500 mb-1.5 font-medium"},"Level",-1)),s("p",ke,a(e.course.level),1)])):u("",!0),e.course.duration?(n(),o("div",Ae,[t[10]||(t[10]=s("p",{class:"text-gray-500 mb-1.5 font-medium"},"Duration",-1)),s("p",pe,a(e.course.duration)+" hours",1)])):u("",!0)])])]),s("div",we,[s("div",Se,[t[31]||(t[31]=s("h2",{class:"text-xl sm:text-2xl font-semibold mb-6 text-gray-800"},"Course Enrollment",-1)),e.isEnrolled?(n(),o("div",{class:"space-y-6",key:k.value},[s("div",Xe,[s("div",Ze,[s("div",{class:m(["w-3 h-3 rounded-full mr-3",{"bg-green-500":e.userStatus==="completed","bg-blue-500":e.userStatus==="pending"||e.userStatus==="in_progress"}])},null,2),s("span",_e," Status: "+a(e.userStatus==="completed"?"Completed":"Enrolled"),1)]),(e.userStatus==="pending"||e.userStatus==="in_progress")&&!y.value?(n(),o("div",es,[t[21]||(t[21]=s("h3",{class:"font-semibold text-yellow-800 mb-3"},"ðŸ“‹ Rate This Course First",-1)),t[22]||(t[22]=s("p",{class:"text-yellow-700 text-sm mb-4"},"Please rate this course before marking it as complete.",-1)),s("div",ss,[t[18]||(t[18]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Your Rating",-1)),s("div",ts,[(n(),o(T,null,j(5,i=>s("button",{key:i,type:"button",onClick:R=>l(c).rating=i,class:m(["text-2xl transition-colors duration-200",{"text-yellow-400":i<=l(c).rating,"text-gray-300 hover:text-yellow-400":i>l(c).rating}])}," â˜… ",10,ns)),64))])]),s("div",os,[t[19]||(t[19]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[x(" Feedback "),s("span",{class:"text-red-500"},"*")],-1)),B(s("textarea",{"onUpdate:modelValue":t[1]||(t[1]=i=>l(c).feedback=i),rows:"3",class:m(["w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",{"border-red-500":l(c).errors.feedback}]),placeholder:"Please share your thoughts about this course... (required)",required:""},null,2),[[q,l(c).feedback]]),l(c).errors.feedback?(n(),o("div",rs,a(l(c).errors.feedback),1)):u("",!0),t[20]||(t[20]=s("p",{class:"text-xs text-gray-500 mt-1"},"Minimum 10 characters required",-1))]),s("button",{onClick:L,disabled:l(c).processing||l(c).rating===0||!((b=l(c).feedback)!=null&&b.trim())||l(c).feedback.trim().length<10,class:"bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition-colors duration-200 w-full"},[l(c).processing?(n(),o("span",ls,"Submitting Rating...")):(n(),o("span",as,"Submit Rating"))],8,is)])):(e.userStatus==="pending"||e.userStatus==="in_progress")&&y.value?(n(),o("div",ds,[t[25]||(t[25]=s("h3",{class:"font-semibold text-green-800 mb-3"},"âœ… Ready to Complete",-1)),t[26]||(t[26]=s("p",{class:"text-green-700 text-sm mb-4"}," Thank you for rating! You can now mark this course as completed. ",-1)),e.completion&&e.completion.rating?(n(),o("p",us,[t[23]||(t[23]=x(" Your rating: ")),s("span",cs,a("â˜…".repeat(e.completion.rating))+a("â˜†".repeat(5-e.completion.rating)),1)])):u("",!0),s("button",{onClick:F,disabled:l(f).processing,class:"button-success w-full flex items-center justify-center gap-2"},[l(f).processing?(n(),o("span",gs,"Processing...")):(n(),o("span",bs,"Mark as Completed")),l(f).processing?u("",!0):(n(),o("svg",xs,t[24]||(t[24]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])))],8,ms)])):e.userStatus==="completed"?(n(),o("div",ys,[t[28]||(t[28]=s("h3",{class:"font-semibold text-green-800 mb-3"},"ðŸŽ‰ Course Completed!",-1)),t[29]||(t[29]=s("p",{class:"text-green-700 font-medium"}," Congratulations! You've successfully completed all sessions in this course. ",-1)),s("div",fs,[p(l(w),{href:"/courses",class:"button-primary w-full flex items-center justify-center gap-2"},{default:v(()=>t[27]||(t[27]=[x(" Browse More Courses "),s("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])),_:1})])])):u("",!0),e.selectedAvailability?(n(),o("div",hs,[t[30]||(t[30]=s("p",{class:"text-sm text-blue-600 font-medium mb-1"},"Your Selected Session Schedule:",-1)),s("p",vs,a(e.selectedAvailability.formatted_date_range),1),s("p",ks,a(h(e.selectedAvailability.start_date))+" - "+a(h(e.selectedAvailability.end_date)),1),s("p",As,a(E(e.selectedAvailability.capacity))+" in this schedule ",1)])):u("",!0)])])):(n(),o("div",Ce,[e.userAssignment&&e.userAssignment.status==="accepted"?(n(),o("div",Ee,t[11]||(t[11]=[s("p",{class:"text-gray-600 mb-6 leading-relaxed"}," This course has been assigned to you. Select a session schedule to complete your enrollment. ",-1)]))):e.userAssignment&&e.userAssignment.status==="pending"?(n(),o("div",Re,t[12]||(t[12]=[s("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6"},[s("p",{class:"text-yellow-800 font-medium mb-2"},"Assignment Pending"),s("p",{class:"text-yellow-700 text-sm"}," Please accept your course assignment above to proceed with enrollment. ")],-1)]))):e.userAssignment&&e.userAssignment.status==="declined"?(n(),o("div",Me,t[13]||(t[13]=[s("div",{class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},[s("p",{class:"text-red-800 font-medium mb-2"},"Assignment Declined"),s("p",{class:"text-red-700 text-sm"}," You have declined this course assignment. Contact your administrator if you'd like to reconsider. ")],-1)]))):(n(),o("div",De,t[14]||(t[14]=[s("p",{class:"text-gray-600 mb-6 leading-relaxed"}," Select a session schedule and enroll in this course to track your progress. ",-1)]))),e.availabilities&&e.availabilities.length>0?(n(),o("div",{key:4,class:m(["mb-6",{"opacity-50":e.userAssignment&&e.userAssignment.status==="pending"}])},[t[15]||(t[15]=s("h3",{class:"font-semibold mb-4 text-gray-800"},"Available Session Schedules:",-1)),s("div",{class:m(["space-y-3",{"pointer-events-none":e.userAssignment&&e.userAssignment.status==="pending"}])},[(n(!0),o(T,null,j(e.availabilities,i=>(n(),o("label",{key:i.id,class:"block cursor-pointer"},[s("div",{class:m(["border rounded-lg p-4 transition-colors",{"border-blue-500 bg-blue-50":l(g).course_availability_id===i.id,"border-gray-300 hover:border-gray-400":l(g).course_availability_id!==i.id&&i.is_available&&(!e.userAssignment||e.userAssignment.status==="accepted"),"border-gray-200 bg-gray-50 cursor-not-allowed":!i.is_available||e.userAssignment&&e.userAssignment.status==="pending"}])},[s("div",Te,[s("div",je,[B(s("input",{type:"radio",value:i.id,"onUpdate:modelValue":t[0]||(t[0]=R=>l(g).course_availability_id=R),disabled:!i.is_available||e.userAssignment&&e.userAssignment.status==="pending",class:"mt-1 mr-3 h-4 w-4 text-blue-600 focus:ring-blue-500"},null,8,Be),[[$,l(g).course_availability_id]]),s("div",null,[s("p",Le,a(i.formatted_date_range),1),s("p",Pe,a(h(i.start_date))+" - "+a(h(i.end_date)),1),i.notes?(n(),o("p",Fe,a(i.notes),1)):u("",!0),s("div",Ve,[s("p",Ne,a(E(i.capacity)),1),i.enrolled_count>0?(n(),o("p",Ue,a(i.enrolled_count)+" sessions already booked ",1)):u("",!0)])])]),s("div",ze,[s("span",{class:m(["session-status",{"bg-green-100 text-green-800":i.is_available&&!i.is_full,"bg-yellow-100 text-yellow-800":i.is_available&&i.available_spots<=5,"bg-red-100 text-red-800":i.is_full,"bg-gray-100 text-gray-800":i.is_expired}])},[i.is_expired?(n(),o("span",Oe,"Expired")):i.is_full?(n(),o("span",Ye,"All Sessions Booked")):(n(),o("span",$e,a(N(i.enrolled_count,i.capacity)),1))],2),s("p",qe,a(i.enrolled_count)+"/"+a(i.capacity)+" sessions ",1)])])],2)]))),128))],2)],2)):!e.availabilities||e.availabilities.length===0?(n(),o("div",He,t[16]||(t[16]=[s("p",{class:"text-gray-600 mb-6 leading-relaxed"}," Enroll in this course to track your progress and get access to course materials. ",-1)]))):u("",!0),s("button",{onClick:P,class:"button-primary w-full flex items-center justify-center gap-2",disabled:l(g).processing||e.availabilities&&e.availabilities.length>0&&!l(g).course_availability_id||e.userAssignment&&e.userAssignment.status==="pending"},[l(g).processing?(n(),o("span",Ge,"Enrolling...")):e.userAssignment&&e.userAssignment.status==="pending"?(n(),o("span",Ke,"Accept Assignment First")):e.userAssignment&&e.userAssignment.status==="declined"?(n(),o("span",We,"Assignment Declined")):(n(),o("span",Je,"Enroll Now")),!l(g).processing&&(!e.userAssignment||e.userAssignment.status==="accepted")?(n(),o("svg",Qe,t[17]||(t[17]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 8l4 4m0 0l-4 4m4-4H3"},null,-1)]))):u("",!0)],8,Ie)]))])])])])]}),_:1}))}});export{Es as default};
