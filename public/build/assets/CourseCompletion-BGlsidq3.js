import{d as z,r as p,W as j,s as D,k as S,o,w as E,e,a as n,f as g,j as T,g as h,F as b,h as y,t as l,i as A,v as F,n as P}from"./app-n_cIwlLT.js";import{_ as O}from"./AdminLayout.vue_vue_type_script_setup_true_lang-DEbUraED.js";import{l as q}from"./lodash-D0FenYJT.js";import{_ as W}from"./Pagination.vue_vue_type_script_setup_true_lang-D4dbHMXX.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-Rz_S81Vw.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B9XjMpGI.js";import"./index-BgSmG8al.js";const H={class:"px-4 sm:px-0"},I={class:"bg-white p-4 sm:p-6 rounded-lg shadow mb-4 sm:mb-6"},K={class:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6"},G=["value"],J={class:"bg-white rounded-lg shadow overflow-hidden overflow-x-auto"},Q={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-white divide-y divide-gray-200"},Y={key:0},Z={class:"px-4 sm:px-6 py-4 whitespace-nowrap"},ee={class:"flex items-center"},te={class:"text-sm font-medium text-gray-900"},se={class:"text-xs text-gray-500 hidden sm:block"},oe={class:"text-xs text-gray-500 sm:hidden mt-1"},le={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900 hidden sm:table-cell"},ne={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900 hidden md:table-cell"},ae={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ie={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900 hidden md:table-cell"},re={key:0,class:"flex items-center"},de={class:"ml-1 flex"},me={key:1},ce={class:"px-4 sm:px-6 py-4 text-sm text-gray-900 hidden lg:table-cell"},ue={class:"max-w-xs truncate"},pe=["onClick","title"],xe={key:1,class:"text-gray-400"},fe={class:"px-4 sm:px-6 py-4 text-sm text-gray-900 hidden xl:table-cell"},ge={class:"max-w-xs truncate"},he=["onClick","title"],be={key:1,class:"text-gray-400"},ye={class:"px-4 sm:px-6 py-3 bg-white border-t border-gray-200"},ve={key:1,class:"text-sm text-gray-600 mt-2"},we={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},_e={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ke={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Ce={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},je={class:"sm:flex sm:items-start"},Se={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},Fe={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},Me={class:"mt-3"},Ve={class:"text-sm text-gray-700 whitespace-pre-wrap break-words max-h-96 overflow-y-auto"},De=z({__name:"CourseCompletion",props:{completions:Object,courses:Array,filters:Object,debug:Object},setup(a){var _,k,C;const x=a,M=[{name:"Dashboard",href:route("dashboard")},{name:"Reports & Analytics",href:route("admin.reports.index")},{name:"Course Completion",href:route("admin.reports.course-completion")}],r=p({course_id:((_=x.filters)==null?void 0:_.course_id)||"",date_from:((k=x.filters)==null?void 0:k.date_from)||"",date_to:((C=x.filters)==null?void 0:C.date_to)||""}),d=p(!1),m=p(""),c=p(""),v=q.debounce(()=>{j.get(route("admin.reports.course-completion"),r.value,{preserveState:!0,replace:!0})},500);D(r,()=>{v()},{deep:!0});const V=()=>{r.value={course_id:"",date_from:"",date_to:""},v()},B=()=>{const i=new URLSearchParams(r.value).toString();window.location.href=route("admin.reports.export.course-completion")+"?"+i},w=i=>i?new Date(i).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—",L=i=>{j.get(route("admin.reports.course-completion"),{...r.value,page:i},{preserveState:!0,replace:!0,preserveScroll:!0,onSuccess:()=>{var t;(t=document.querySelector(".bg-white.rounded-lg.shadow"))==null||t.scrollIntoView({behavior:"smooth",block:"start"})}})},N=(i,t)=>{m.value=`Feedback from ${t}`,c.value=i||"No feedback provided",d.value=!0},R=(i,t)=>{m.value=`Comment from ${t}`,c.value=i||"No comment provided",d.value=!0},f=()=>{d.value=!1,m.value="",c.value=""},U=i=>{i.key==="Escape"&&d.value&&f()};return typeof window<"u"&&window.addEventListener("keydown",U),(i,t)=>(o(),S(O,{breadcrumbs:M},{default:E(()=>[e("div",H,[e("div",{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 gap-4 sm:gap-0"},[t[4]||(t[4]=e("h1",{class:"text-xl sm:text-2xl font-bold"},"Course Completion Report",-1)),e("button",{onClick:B,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition flex items-center w-full sm:w-auto justify-center sm:justify-start"},t[3]||(t[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),T(" Export to CSV ")]))]),e("div",I,[t[9]||(t[9]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Filter Completions",-1)),e("div",K,[e("div",null,[t[6]||(t[6]=e("label",{for:"course_filter",class:"block text-sm font-medium text-gray-700 mb-1"},"Course",-1)),h(e("select",{id:"course_filter","onUpdate:modelValue":t[0]||(t[0]=s=>r.value.course_id=s),class:"border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},[t[5]||(t[5]=e("option",{value:""},"All Courses",-1)),(o(!0),n(b,null,y(a.courses,s=>(o(),n("option",{key:s.id,value:s.id},l(s.name),9,G))),128))],512),[[A,r.value.course_id]])]),e("div",null,[t[7]||(t[7]=e("label",{for:"date_from",class:"block text-sm font-medium text-gray-700 mb-1"},"Completed From",-1)),h(e("input",{id:"date_from",type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>r.value.date_from=s),class:"border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[F,r.value.date_from]])]),e("div",null,[t[8]||(t[8]=e("label",{for:"date_to",class:"block text-sm font-medium text-gray-700 mb-1"},"Completed To",-1)),h(e("input",{id:"date_to",type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>r.value.date_to=s),class:"border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[F,r.value.date_to]])]),e("div",{class:"flex items-end md:col-span-3"},[e("button",{onClick:V,class:"inline-flex items-center px-4 py-2 bg-gray-100 border border-transparent rounded-md font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition"}," Reset Filters ")])])]),e("div",J,[e("table",Q,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," User "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell"}," Course "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell"}," Registered "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Completed "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell"}," Rating "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden lg:table-cell"}," Feedback "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden xl:table-cell"}," Comment ")])],-1)),e("tbody",X,[a.completions.data.length===0?(o(),n("tr",Y,t[10]||(t[10]=[e("td",{colspan:"7",class:"px-4 sm:px-6 py-4 text-center text-gray-500"},"No completion records found",-1)]))):(o(!0),n(b,{key:1},y(a.completions.data,(s,$)=>(o(),n("tr",{key:$,class:"hover:bg-gray-50"},[e("td",Z,[e("div",ee,[e("div",null,[e("div",te,l(s.user_name),1),e("div",se,l(s.user_email),1),e("div",oe,l(s.course_name),1)])])]),e("td",le,l(s.course_name),1),e("td",ne,l(w(s.registered_at)),1),e("td",ae,l(w(s.completed_at)),1),e("td",ie,[s.rating?(o(),n("div",re,[e("span",null,l(s.rating)+"/5",1),e("div",de,[(o(),n(b,null,y(5,u=>e("svg",{key:u,class:P(["h-4 w-4",u<=s.rating?"text-yellow-400":"text-gray-300"]),fill:"currentColor",viewBox:"0 0 20 20"},t[11]||(t[11]=[e("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"},null,-1)]),2)),64))])])):(o(),n("span",me,"—"))]),e("td",ce,[e("div",ue,[s.feedback?(o(),n("button",{key:0,onClick:u=>N(s.feedback,s.user_name),class:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded px-1",title:"Click to view full feedback from "+s.user_name},l(s.feedback.length>30?s.feedback.substring(0,30)+"...":s.feedback),9,pe)):(o(),n("span",xe,"—"))])]),e("td",fe,[e("div",ge,[s.comment?(o(),n("button",{key:0,onClick:u=>R(s.comment,s.user_name),class:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded px-1",title:"Click to view full comment from "+s.user_name},l(s.comment.length>30?s.comment.substring(0,30)+"...":s.comment),9,he)):(o(),n("span",be,"—"))])])]))),128))])]),e("div",ye,[a.completions.data&&a.completions.data.length>0&&a.completions.last_page>1?(o(),S(W,{key:0,links:a.completions.links,onPageChanged:L,class:"mt-4"},null,8,["links"])):g("",!0),a.completions.data&&a.completions.data.length>0?(o(),n("div",ve," Showing "+l(a.completions.from)+" to "+l(a.completions.to)+" of "+l(a.completions.total)+" results ",1)):g("",!0)])])]),d.value?(o(),n("div",we,[e("div",_e,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:f}),e("div",ke,[e("div",Ce,[e("div",je,[t[13]||(t[13]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.959 8.959 0 01-4.906-1.476L3 21l2.476-5.094A8.959 8.959 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z"})])],-1)),e("div",Se,[e("h3",Fe,l(m.value),1),e("div",Me,[e("div",Ve,l(c.value),1)])])])]),e("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[e("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm transition",onClick:f}," Close ")])])])])):g("",!0)]),_:1}))}});export{De as default};
