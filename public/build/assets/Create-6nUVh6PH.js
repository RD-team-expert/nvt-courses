import{d as A,C as G,r as U,c as O,a as m,o as n,b as o,u as e,m as q,w as s,e as l,P as $,f as d,j as H,h as f,n as p,t as u,F as D,i as J,g as k}from"./app-BC6n8fRv.js";import{m as I,f as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-DLsmvHyL.js";import{T as Q,C as W}from"./ChunkUploader-CcN0Adit.js";import{_ as v}from"./Button.vue_vue_type_script_setup_true_lang-DfMEe0gp.js";import{_ as y}from"./Card.vue_vue_type_script_setup_true_lang-B7Mv47wR.js";import{_ as x}from"./CardContent.vue_vue_type_script_setup_true_lang-CLFS-8rM.js";import{_ as b}from"./CardDescription.vue_vue_type_script_setup_true_lang-CxAjZMeU.js";import{_ as V}from"./CardHeader.vue_vue_type_script_setup_true_lang-Bs-bQqCd.js";import{_ as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-KDz447Lo.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-BbfqqDwb.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-CVOjwGqu.js";import{_ as X}from"./Textarea.vue_vue_type_script_setup_true_lang-C6IPCHM6.js";import{_ as Y}from"./Switch.vue_vue_type_script_setup_true_lang-d6KEIr33.js";import{_ as Z,a as ee,b as te,c as oe,d as re}from"./SelectValue.vue_vue_type_script_setup_true_lang-BHc6_HZQ.js";import{_ as se,a as L}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-BVGinY2H.js";import{A as le}from"./arrow-left-C926mVy-.js";import{S as ie}from"./square-play-ClzPR4ZH.js";import{H as F,C as ae}from"./hard-drive-ClLhKwhv.js";import{L as de}from"./link-2-Dp3HBVBd.js";import{L as ne}from"./loader-circle-BGRobPPE.js";import{S as ue}from"./save-Bnwt2SQ_.js";import"./index-B9MCmdtc.js";import"./index-TP6oKz5a.js";import"./_plugin-vue_export-helper-DdW31YSB.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DcqPTA6d.js";import"./clock-CfYQ2E0O.js";import"./useForwardPropsEmits-flN6X4rE.js";import"./useForwardExpose-aXon0oPU.js";import"./VisuallyHidden-CNKeJIuR.js";import"./VisuallyHiddenInput-GQUyZkVz.js";import"./usePrimitiveElement-DSELQwQQ.js";import"./Presence-DYqhIJB5.js";import"./ConfigProvider-CDXrVWUh.js";import"./Teleport-F8uCW-4b.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-4PYc7j27.js";import"./Collection-BYfbXeh3.js";import"./check-CtR5xxCf.js";import"./useSize-CVFw8z_-.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./RovingFocusItem-DuZfwuWJ.js";import"./circle-BvmopLVe.js";const me={class:"max-w-4xl mx-auto space-y-6"},ce={class:"flex items-center gap-4"},fe={class:"space-y-2"},pe={key:0,class:"text-sm text-destructive"},_e={class:"space-y-2"},ge={key:0,class:"text-sm text-destructive"},ve={class:"space-y-2"},ye={key:0,class:"text-sm text-destructive"},xe={key:0,class:"space-y-2"},be={class:"flex gap-2"},Ve={key:0,class:"text-sm text-destructive"},Se={key:1,class:"space-y-2"},ke={key:0,class:"text-sm text-destructive"},he={class:"text-sm text-muted-foreground"},we={class:"space-y-2"},Ce={class:"flex gap-2"},Ue={class:"flex items-center px-3 py-2 bg-muted rounded-md text-sm text-muted-foreground min-w-0"},$e={key:0,class:"text-sm text-destructive"},De={class:"text-sm text-muted-foreground"},Le={class:"flex items-center justify-between"},Fe={class:"space-y-1"},Me={class:"flex justify-between items-center"},St=A({__name:"Create",props:{categories:{},maxFileSize:{}},setup(M){const P=M,B=[{title:"Video Management",href:"/admin/videos"},{title:"Create Video Course",href:""}],r=G({name:"",description:"",storage_type:"google_drive",google_drive_url:"",video_data:"",duration:null,content_category_id:null,is_active:!0}),_=U(!1),g=U(!1),w=O(()=>Math.round((P.maxFileSize||512e3)/1024)),T=i=>{if(console.log("✅ Chunk upload complete:",i),console.log("✅ Data type:",typeof i),console.log("✅ Data keys:",i?Object.keys(i):"null"),typeof i=="string"){console.log("⚠️ Data is already a string, parsing first");try{i=JSON.parse(i)}catch(t){console.error("❌ Failed to parse data string:",t)}}r.video_data=JSON.stringify(i),console.log("✅ Stored video_data:",r.video_data)},z=i=>{console.error("❌ Chunk upload error:",i),alert("Upload failed. Please try again.")},j=i=>{console.log("Upload progress:",i+"%")},E=async()=>{if(r.google_drive_url){g.value=!0;try{console.log("Testing URL:",r.google_drive_url),await new Promise(i=>setTimeout(i,2e3)),alert("Video URL is valid!")}catch(i){console.error("URL test failed:",i),alert("Failed to validate video URL. Please check the link.")}finally{g.value=!1}}},N=i=>{if(!i)return"00:00";const t=Math.floor(i/3600),a=Math.floor(i%3600/60),C=i%60;return t>0?`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`:`${a.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`},R=async()=>{_.value=!0,r.post("/admin/videos",{preserveScroll:!0,onFinish:()=>{_.value=!1},onSuccess:()=>{console.log("✅ Video created successfully")},onError:i=>{console.error("❌ Form errors:",i)}})};return(i,t)=>(n(),m(D,null,[o(e(q),{title:"Create Video Course"}),o(K,{breadcrumbs:B},{default:s(()=>[l("div",me,[l("div",ce,[o(e(v),{"as-child":"",variant:"ghost"},{default:s(()=>[o(e($),{href:"/admin/videos"},{default:s(()=>[o(e(le),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=d(" Back to Videos "))]),_:1})]),_:1}),t[8]||(t[8]=l("div",null,[l("h1",{class:"text-2xl font-bold"},"Create Video Course"),l("p",{class:"text-muted-foreground"},"Add a new video course to your library")],-1))]),l("form",{onSubmit:H(R,["prevent"]),class:"space-y-6"},[o(e(y),null,{default:s(()=>[o(e(V),null,{default:s(()=>[o(e(S),{class:"flex items-center gap-2"},{default:s(()=>[o(e(ie),{class:"h-5 w-5"}),t[9]||(t[9]=d(" Video Information "))]),_:1}),o(e(b),null,{default:s(()=>t[10]||(t[10]=[d(" Enter the basic details for your video course ")])),_:1})]),_:1}),o(e(x),{class:"space-y-4"},{default:s(()=>[l("div",fe,[o(e(c),{for:"name"},{default:s(()=>t[11]||(t[11]=[d("Video Title")])),_:1}),o(e(h),{id:"name",modelValue:e(r).name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(r).name=a),type:"text",placeholder:"Enter video course title...",class:p({"border-destructive":e(r).errors.name}),required:""},null,8,["modelValue","class"]),e(r).errors.name?(n(),m("div",pe,u(e(r).errors.name),1)):f("",!0)]),l("div",_e,[o(e(c),{for:"description"},{default:s(()=>t[12]||(t[12]=[d("Description")])),_:1}),o(e(X),{id:"description",modelValue:e(r).description,"onUpdate:modelValue":t[1]||(t[1]=a=>e(r).description=a),placeholder:"Describe what students will learn from this video course...",rows:"5",class:p({"border-destructive":e(r).errors.description})},null,8,["modelValue","class"]),e(r).errors.description?(n(),m("div",ge,u(e(r).errors.description),1)):f("",!0)]),l("div",ve,[o(e(c),{for:"content_category_id"},{default:s(()=>t[13]||(t[13]=[d("Category")])),_:1}),o(e(Z),{modelValue:e(r).content_category_id,"onUpdate:modelValue":t[2]||(t[2]=a=>e(r).content_category_id=a)},{default:s(()=>[o(e(ee),{class:p({"border-destructive":e(r).errors.content_category_id})},{default:s(()=>[o(e(te),{placeholder:"Select a category..."})]),_:1},8,["class"]),o(e(oe),null,{default:s(()=>[(n(!0),m(D,null,J(i.categories,a=>(n(),k(e(re),{key:a.id,value:a.id.toString()},{default:s(()=>[d(u(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(r).errors.content_category_id?(n(),m("div",ye,u(e(r).errors.content_category_id),1)):f("",!0)])]),_:1})]),_:1}),o(e(y),null,{default:s(()=>[o(e(V),null,{default:s(()=>[o(e(S),{class:"flex items-center gap-2"},{default:s(()=>[o(e(F),{class:"h-5 w-5"}),t[14]||(t[14]=d(" Storage Type "))]),_:1}),o(e(b),null,{default:s(()=>t[15]||(t[15]=[d(" Choose where to store your video ")])),_:1})]),_:1}),o(e(x),{class:"space-y-4"},{default:s(()=>[o(e(se),{modelValue:e(r).storage_type,"onUpdate:modelValue":t[3]||(t[3]=a=>e(r).storage_type=a),class:"grid grid-cols-2 gap-4"},{default:s(()=>[o(e(c),{for:"google_drive",class:p(["flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground cursor-pointer",{"border-primary":e(r).storage_type==="google_drive"}])},{default:s(()=>[o(e(L),{value:"google_drive",id:"google_drive",class:"sr-only"}),o(e(ae),{class:"mb-3 h-6 w-6"}),t[16]||(t[16]=l("div",{class:"space-y-1 text-center"},[l("p",{class:"text-sm font-medium leading-none"},"Google Drive"),l("p",{class:"text-xs text-muted-foreground"}," Store video on Google Drive ")],-1))]),_:1},8,["class"]),o(e(c),{for:"local",class:p(["flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground cursor-pointer",{"border-primary":e(r).storage_type==="local"}])},{default:s(()=>[o(e(L),{value:"local",id:"local",class:"sr-only"}),o(e(F),{class:"mb-3 h-6 w-6"}),t[17]||(t[17]=l("div",{class:"space-y-1 text-center"},[l("p",{class:"text-sm font-medium leading-none"},"Local Storage"),l("p",{class:"text-xs text-muted-foreground"}," Upload video to server ")],-1))]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(e(y),null,{default:s(()=>[o(e(V),null,{default:s(()=>[o(e(S),{class:"flex items-center gap-2"},{default:s(()=>[o(e(de),{class:"h-5 w-5"}),t[18]||(t[18]=d(" Video Source "))]),_:1}),o(e(b),null,{default:s(()=>[d(u(e(r).storage_type==="google_drive"?"Provide Google Drive URL":"Upload video file"),1)]),_:1})]),_:1}),o(e(x),{class:"space-y-4"},{default:s(()=>[e(r).storage_type==="google_drive"?(n(),m("div",xe,[o(e(c),{for:"google_drive_url"},{default:s(()=>t[19]||(t[19]=[d("Google Drive Video URL")])),_:1}),l("div",be,[o(e(h),{id:"google_drive_url",modelValue:e(r).google_drive_url,"onUpdate:modelValue":t[4]||(t[4]=a=>e(r).google_drive_url=a),type:"url",placeholder:"https://drive.google.com/file/d/...",class:p({"border-destructive":e(r).errors.google_drive_url})},null,8,["modelValue","class"]),o(e(v),{type:"button",variant:"outline",size:"icon",onClick:E,disabled:!e(r).google_drive_url||g.value},{default:s(()=>[g.value?(n(),k(e(ne),{key:0,class:"h-4 w-4 animate-spin"})):(n(),k(e(Q),{key:1,class:"h-4 w-4"}))]),_:1},8,["disabled"])]),e(r).errors.google_drive_url?(n(),m("div",Ve,u(e(r).errors.google_drive_url),1)):f("",!0),t[20]||(t[20]=l("div",{class:"text-sm text-muted-foreground"},' Paste the shareable link from Google Drive. Make sure the video is set to "Anyone with the link can view" ',-1))])):e(r).storage_type==="local"?(n(),m("div",Se,[o(e(c),{for:"video_file"},{default:s(()=>t[21]||(t[21]=[d("Video File")])),_:1}),o(W,{name:"file",accept:"video/*",maxFileSize:w.value+"MB",onUploaded:T,onError:z,onProgress:j},null,8,["maxFileSize"]),e(r).errors.video_file||e(r).errors.video_data?(n(),m("div",ke,u(e(r).errors.video_file||e(r).errors.video_data),1)):f("",!0),l("div",he," Video will be uploaded in 2MB chunks for reliability. Maximum "+u(w.value)+"MB ",1)])):f("",!0),l("div",we,[o(e(c),{for:"duration"},{default:s(()=>t[22]||(t[22]=[d("Duration (seconds)")])),_:1}),l("div",Ce,[o(e(h),{id:"duration",modelValue:e(r).duration,"onUpdate:modelValue":t[5]||(t[5]=a=>e(r).duration=a),type:"number",min:"1",max:"86400",placeholder:"e.g., 3600 for 1 hour",class:p({"border-destructive":e(r).errors.duration})},null,8,["modelValue","class"]),l("div",Ue,u(N(e(r).duration)),1)]),e(r).errors.duration?(n(),m("div",$e,u(e(r).errors.duration),1)):f("",!0),l("div",De,u(e(r).storage_type==="local"?"Optional - will be auto-detected from video file":"Video duration in seconds (optional)"),1)])]),_:1})]),_:1}),o(e(y),null,{default:s(()=>[o(e(V),null,{default:s(()=>[o(e(S),{class:"flex items-center gap-2"},{default:s(()=>[o(e(I),{class:"h-5 w-5"}),t[23]||(t[23]=d(" Settings "))]),_:1}),o(e(b),null,{default:s(()=>t[24]||(t[24]=[d(" Configure the video course settings ")])),_:1})]),_:1}),o(e(x),null,{default:s(()=>[l("div",Le,[l("div",Fe,[o(e(c),null,{default:s(()=>t[25]||(t[25]=[d("Active Status")])),_:1}),t[26]||(t[26]=l("div",{class:"text-sm text-muted-foreground"}," Make this video course available to students ",-1))]),o(e(Y),{checked:e(r).is_active,"onUpdate:checked":t[6]||(t[6]=a=>e(r).is_active=a)},null,8,["checked"])])]),_:1})]),_:1}),l("div",Me,[o(e(v),{"as-child":"",variant:"outline"},{default:s(()=>[o(e($),{href:"/admin/videos"},{default:s(()=>t[27]||(t[27]=[d("Cancel")])),_:1})]),_:1}),o(e(v),{type:"submit",disabled:_.value||e(r).processing||e(r).storage_type==="local"&&!e(r).video_data},{default:s(()=>[o(e(ue),{class:"h-4 w-4 mr-2"}),d(" "+u(_.value?"Creating...":"Create Video Course"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{St as default};
