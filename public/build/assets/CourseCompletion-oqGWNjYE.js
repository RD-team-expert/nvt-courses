import{d as $,r as p,W as S,s as D,k as j,o as l,w as T,e,a,f,j as O,g as h,F as b,h as y,t as n,i as q,v as F,n as L}from"./app-iYB6CK9s.js";import{_ as H}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BmAEUQ0k.js";import{l as I}from"./lodash-CAnG-Ugi.js";import{_ as W}from"./Pagination.vue_vue_type_script_setup_true_lang-CsQrSMli.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-BOHGZ_58.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B3PnW6xU.js";import"./index-BHiy4VMt.js";const K={class:"px-4 sm:px-0"},G={class:"bg-white p-4 sm:p-6 rounded-lg shadow mb-4 sm:mb-6"},J={class:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6"},Q=["value"],X={class:"bg-white rounded-lg shadow overflow-hidden overflow-x-auto"},Y={class:"min-w-full divide-y divide-gray-200"},Z={class:"bg-white divide-y divide-gray-200"},ee={key:0},te={class:"px-4 sm:px-6 py-4 whitespace-nowrap"},se={class:"flex items-center"},oe={class:"text-sm font-medium text-gray-900"},le={class:"text-xs text-gray-500 hidden sm:block"},ne={class:"text-xs text-gray-500 sm:hidden mt-1"},ae={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900 hidden sm:table-cell"},re={class:"px-4 sm:px-6 py-4 whitespace-nowrap"},ie={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900 hidden md:table-cell"},de={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ce={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900 hidden md:table-cell"},me={key:0,class:"flex items-center"},ue={class:"ml-1 flex"},pe={key:1},xe={class:"px-4 sm:px-6 py-4 text-sm text-gray-900 hidden lg:table-cell"},ge={class:"max-w-xs truncate"},fe=["onClick","title"],he={key:1,class:"text-gray-400"},be={class:"px-4 sm:px-6 py-4 text-sm text-gray-900 hidden xl:table-cell"},ye={class:"max-w-xs truncate"},we=["onClick","title"],ve={key:1,class:"text-gray-400"},_e={class:"px-4 sm:px-6 py-3 bg-white border-t border-gray-200"},ke={key:1,class:"text-sm text-gray-600 mt-2"},Ce={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Se={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},je={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Fe={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Le={class:"sm:flex sm:items-start"},Me={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},Ve={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},ze={class:"mt-3"},Be={class:"text-sm text-gray-700 whitespace-pre-wrap break-words max-h-96 overflow-y-auto"},De=$({__name:"CourseCompletion",props:{completions:Object,courses:Array,filters:Object,debug:Object},setup(r){var _,k,C;const x=r,M=[{name:"Dashboard",href:route("dashboard")},{name:"Reports & Analytics",href:route("admin.reports.index")},{name:"Course Completion",href:route("admin.reports.course-completion")}],i=p({course_id:((_=x.filters)==null?void 0:_.course_id)||"",date_from:((k=x.filters)==null?void 0:k.date_from)||"",date_to:((C=x.filters)==null?void 0:C.date_to)||""}),d=p(!1),c=p(""),m=p(""),V=o=>{switch(o?o.toLowerCase():"unknown"){case"completed":return"bg-green-100 text-green-800";case"enrolled":return"bg-blue-100 text-blue-800";case"in_progress":case"in-progress":case"active":return"bg-yellow-100 text-yellow-800";case"pending":return"bg-orange-100 text-orange-800";case"cancelled":case"canceled":return"bg-red-100 text-red-800";case"on_hold":case"on-hold":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},z=o=>{if(!o)return"Unknown";switch(o.toLowerCase()){case"completed":return"Completed";case"enrolled":return"Enrolled";case"in_progress":case"in-progress":return"In Progress";case"active":return"Active";case"pending":return"Pending";case"cancelled":case"canceled":return"Cancelled";case"on_hold":case"on-hold":return"On Hold";default:return o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()}},w=I.debounce(()=>{S.get(route("admin.reports.course-completion"),i.value,{preserveState:!0,replace:!0})},500);D(i,()=>{w()},{deep:!0});const B=()=>{i.value={course_id:"",date_from:"",date_to:""},w()},U=()=>{const o=new URLSearchParams(i.value).toString();window.location.href=route("admin.reports.export.course-completion")+"?"+o},v=o=>o?new Date(o).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—",A=o=>{S.get(route("admin.reports.course-completion"),{...i.value,page:o},{preserveState:!0,replace:!0,preserveScroll:!0,onSuccess:()=>{var t;(t=document.querySelector(".bg-white.rounded-lg.shadow"))==null||t.scrollIntoView({behavior:"smooth",block:"start"})}})},E=(o,t)=>{c.value=`Feedback from ${t}`,m.value=o||"No feedback provided",d.value=!0},N=(o,t)=>{c.value=`Comment from ${t}`,m.value=o||"No comment provided",d.value=!0},g=()=>{d.value=!1,c.value="",m.value=""},P=o=>{o.key==="Escape"&&d.value&&g()};return typeof window<"u"&&window.addEventListener("keydown",P),(o,t)=>(l(),j(H,{breadcrumbs:M},{default:T(()=>[e("div",K,[e("div",{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 gap-4 sm:gap-0"},[t[4]||(t[4]=e("h1",{class:"text-xl sm:text-2xl font-bold"},"Course Completion Report",-1)),e("button",{onClick:U,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition flex items-center w-full sm:w-auto justify-center sm:justify-start"},t[3]||(t[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),O(" Export to CSV ")]))]),e("div",G,[t[9]||(t[9]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Filter Completions",-1)),e("div",J,[e("div",null,[t[6]||(t[6]=e("label",{for:"course_filter",class:"block text-sm font-medium text-gray-700 mb-1"},"Course",-1)),h(e("select",{id:"course_filter","onUpdate:modelValue":t[0]||(t[0]=s=>i.value.course_id=s),class:"border px-3 py-2 rounded w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500"},[t[5]||(t[5]=e("option",{value:""},"All Courses",-1)),(l(!0),a(b,null,y(r.courses,s=>(l(),a("option",{key:s.id,value:s.id},n(s.name),9,Q))),128))],512),[[q,i.value.course_id]])]),e("div",null,[t[7]||(t[7]=e("label",{for:"date_from",class:"block text-sm font-medium text-gray-700 mb-1"},"Completed From",-1)),h(e("input",{id:"date_from",type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>i.value.date_from=s),class:"border px-3 py-2 rounded w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500"},null,512),[[F,i.value.date_from]])]),e("div",null,[t[8]||(t[8]=e("label",{for:"date_to",class:"block text-sm font-medium text-gray-700 mb-1"},"Completed To",-1)),h(e("input",{id:"date_to",type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>i.value.date_to=s),class:"border px-3 py-2 rounded w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500"},null,512),[[F,i.value.date_to]])]),e("div",{class:"flex items-end md:col-span-3"},[e("button",{onClick:B,class:"inline-flex items-center px-4 py-2 bg-gray-100 border border-transparent rounded-md font-medium text-gray-700 hover:bg-gray-200 focus:outline-hidden focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition"}," Reset Filters ")])])]),e("div",X,[e("table",Y,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," User "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell"}," Course "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell"}," Registered "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Completed "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell"}," Rating "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden lg:table-cell"}," Feedback "),e("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden xl:table-cell"}," Comment ")])],-1)),e("tbody",Z,[r.completions.data.length===0?(l(),a("tr",ee,t[10]||(t[10]=[e("td",{colspan:"8",class:"px-4 sm:px-6 py-4 text-center text-gray-500"},"No completion records found",-1)]))):(l(!0),a(b,{key:1},y(r.completions.data,(s,R)=>(l(),a("tr",{key:R,class:"hover:bg-gray-50"},[e("td",te,[e("div",se,[e("div",null,[e("div",oe,n(s.user_name),1),e("div",le,n(s.user_email),1),e("div",ne,n(s.course_name),1)])])]),e("td",ae,n(s.course_name),1),e("td",re,[e("span",{class:L(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",V(s.course_status)])},n(z(s.course_status)),3)]),e("td",ie,n(v(s.registered_at)),1),e("td",de,n(v(s.completed_at)),1),e("td",ce,[s.rating?(l(),a("div",me,[e("span",null,n(s.rating)+"/5",1),e("div",ue,[(l(),a(b,null,y(5,u=>e("svg",{key:u,class:L(["h-4 w-4",u<=s.rating?"text-yellow-400":"text-gray-300"]),fill:"currentColor",viewBox:"0 0 20 20"},t[11]||(t[11]=[e("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"},null,-1)]),2)),64))])])):(l(),a("span",pe,"—"))]),e("td",xe,[e("div",ge,[s.feedback?(l(),a("button",{key:0,onClick:u=>E(s.feedback,s.user_name),class:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded px-1",title:"Click to view full feedback from "+s.user_name},n(s.feedback.length>30?s.feedback.substring(0,30)+"...":s.feedback),9,fe)):(l(),a("span",he,"—"))])]),e("td",be,[e("div",ye,[s.comment?(l(),a("button",{key:0,onClick:u=>N(s.comment,s.user_name),class:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 rounded px-1",title:"Click to view full comment from "+s.user_name},n(s.comment.length>30?s.comment.substring(0,30)+"...":s.comment),9,we)):(l(),a("span",ve,"—"))])])]))),128))])]),e("div",_e,[r.completions.data&&r.completions.data.length>0&&r.completions.last_page>1?(l(),j(W,{key:0,links:r.completions.links,onPageChanged:A,class:"mt-4"},null,8,["links"])):f("",!0),r.completions.data&&r.completions.data.length>0?(l(),a("div",ke," Showing "+n(r.completions.from)+" to "+n(r.completions.to)+" of "+n(r.completions.total)+" results ",1)):f("",!0)])])]),d.value?(l(),a("div",Ce,[e("div",Se,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:g}),e("div",je,[e("div",Fe,[e("div",Le,[t[13]||(t[13]=e("div",{class:"mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.959 8.959 0 01-4.906-1.476L3 21l2.476-5.094A8.959 8.959 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z"})])],-1)),e("div",Me,[e("h3",Ve,n(c.value),1),e("div",ze,[e("div",Be,n(m.value),1)])])])]),e("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[e("button",{type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-hidden focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm transition",onClick:g}," Close ")])])])])):f("",!0)]),_:1}))}});export{De as default};
