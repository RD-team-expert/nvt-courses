import{d as z,r as m,c as L,k as F,o,w as M,e,t as l,g,a as d,F as b,h as f,i as C,v as $,q as j,f as A,n as V,b as H,u as W,P as T,j as q,W as E}from"./app-iYB6CK9s.js";import{_ as I}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BmAEUQ0k.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-BOHGZ_58.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B3PnW6xU.js";import"./index-BHiy4VMt.js";const O={class:"px-4 sm:px-0"},Q={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},G={class:"bg-white rounded-lg shadow p-6"},J={class:"flex items-center"},K={class:"ml-5 w-0 flex-1"},R={class:"text-lg font-medium text-gray-900"},X={class:"bg-white rounded-lg shadow p-6"},Y={class:"flex items-center"},Z={class:"ml-5 w-0 flex-1"},ee={class:"text-lg font-medium text-gray-900"},te={class:"bg-white rounded-lg shadow p-6"},se={class:"flex items-center"},le={class:"ml-5 w-0 flex-1"},oe={class:"text-lg font-medium text-gray-900"},ae={class:"bg-white rounded-lg shadow p-6"},ne={class:"flex items-center"},de={class:"ml-5 w-0 flex-1"},ie={class:"text-lg font-medium text-gray-900"},re={class:"bg-white rounded-lg shadow p-6 mb-6"},ue={class:"grid grid-cols-1 lg:grid-cols-4 gap-4"},me=["value"],ce=["value"],ve={class:"flex items-end"},xe=["disabled"],ge={class:"flex items-center text-sm text-gray-600"},pe={class:"bg-white rounded-lg shadow p-6 mb-6"},be={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},fe=["value"],ye=["value"],he={class:"flex items-end"},we={class:"bg-white rounded-lg shadow"},_e={class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},ke={class:"flex items-center space-x-4"},Ce={class:"flex items-center"},Ue={class:"ml-2 text-sm text-gray-700"},Le={class:"overflow-x-auto"},Me={class:"min-w-full divide-y divide-gray-200"},je={class:"bg-gray-50"},Ae={class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},Ve=["checked"],De={class:"bg-white divide-y divide-gray-200"},Pe={class:"px-6 py-4 whitespace-nowrap"},Se=["value"],Be={class:"px-6 py-4 whitespace-nowrap"},Ne={class:"flex items-center"},ze={class:"shrink-0 h-10 w-10"},Fe={class:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center"},$e={class:"text-sm font-medium text-gray-600"},He={class:"ml-4"},We={class:"text-sm font-medium text-gray-900"},Te={class:"text-sm text-gray-500"},qe={key:0,class:"text-xs text-gray-400"},Ee={class:"px-6 py-4 whitespace-nowrap"},Ie={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},Oe={key:1,class:"text-sm text-gray-400 italic"},Qe={class:"px-6 py-4 whitespace-nowrap"},Ge={key:0,class:"text-sm text-gray-900"},Je={key:1,class:"text-sm text-gray-400 italic"},Ke={class:"px-6 py-4 whitespace-nowrap"},Re={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Xe={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200"},Ye={class:"flex justify-between flex-1 sm:hidden"},Ze=["disabled"],et=["disabled"],tt={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},st={class:"text-sm text-gray-700"},lt={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},ot=["disabled"],at=["onClick"],nt=["disabled"],_=20,ct=z({__name:"Assignment",props:{users:Array,departments:Array,userLevels:Array,stats:Object},setup(r){const D=r,i=m([]),c=m(""),v=m(""),y=m(""),h=m(""),w=m(""),a=m(1),x=L(()=>{let n=D.users;if(y.value){const t=y.value.toLowerCase();n=n.filter(s=>s.name.toLowerCase().includes(t)||s.email.toLowerCase().includes(t)||s.employee_code&&s.employee_code.toLowerCase().includes(t))}return h.value&&(n=n.filter(t=>t.department===h.value)),w.value&&(n=n.filter(t=>t.level_code===w.value)),n}),k=L(()=>{const n=(a.value-1)*_,t=n+_;return x.value.slice(n,t)}),p=L(()=>Math.ceil(x.value.length/_)),P=()=>{if(i.value.length===0){alert("Please select at least one user");return}if(!c.value&&!v.value){alert("Please select a department or level to assign");return}const n={user_ids:i.value};c.value&&(n.department_id=c.value),v.value&&(n.user_level_id=v.value),E.post(route("admin.users.bulk-assign"),n,{preserveState:!0,onSuccess:()=>{i.value=[],c.value="",v.value=""},onError:t=>{console.error("Assignment failed:",t),alert("Failed to assign users. Please try again.")}})},U=m(!1),S=()=>{U.value?i.value=x.value.map(n=>n.id):i.value=[]},B=[{name:"Dashboard",href:route("dashboard")},{name:"User Management",href:"#"},{name:"User Assignment",href:route("admin.users.assignment")}];return(n,t)=>(o(),F(I,{breadcrumbs:B},{default:M(()=>[e("div",O,[t[38]||(t[38]=e("div",{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4"},[e("h1",{class:"text-xl sm:text-2xl font-bold"},"User Assignment")],-1)),e("div",Q,[e("div",G,[e("div",J,[t[14]||(t[14]=e("div",{class:"shrink-0"},[e("div",{class:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center"},[e("svg",{class:"h-5 w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 515 0z"})])])],-1)),e("div",K,[e("dl",null,[t[13]||(t[13]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Users",-1)),e("dd",R,l(r.stats.total_users),1)])])])]),e("div",X,[e("div",Y,[t[16]||(t[16]=e("div",{class:"shrink-0"},[e("div",{class:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center"},[e("svg",{class:"h-5 w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])])],-1)),e("div",Z,[e("dl",null,[t[15]||(t[15]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"With Departments",-1)),e("dd",ee,l(r.stats.with_departments),1)])])])]),e("div",te,[e("div",se,[t[18]||(t[18]=e("div",{class:"shrink-0"},[e("div",{class:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center"},[e("svg",{class:"h-5 w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})])])],-1)),e("div",le,[e("dl",null,[t[17]||(t[17]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"With Levels",-1)),e("dd",oe,l(r.stats.with_levels),1)])])])]),e("div",ae,[e("div",ne,[t[20]||(t[20]=e("div",{class:"shrink-0"},[e("div",{class:"w-8 h-8 bg-red-500 rounded-md flex items-center justify-center"},[e("svg",{class:"h-5 w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.728-.833-2.498 0L4.316 16.5c-.77.833.192 2.5 1.732 2.5z"})])])],-1)),e("div",de,[e("dl",null,[t[19]||(t[19]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Unassigned",-1)),e("dd",ie,l(r.stats.without_assignments),1)])])])])]),e("div",re,[t[25]||(t[25]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Bulk Assignment",-1)),e("div",ue,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Department",-1)),g(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"},[t[21]||(t[21]=e("option",{value:""},"Select Department",-1)),(o(!0),d(b,null,f(r.departments,s=>(o(),d("option",{key:s.id,value:s.id},l(s.name)+" ("+l(s.department_code)+") ",9,me))),128))],512),[[C,c.value]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"User Level",-1)),g(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"},[t[23]||(t[23]=e("option",{value:""},"Select Level",-1)),(o(!0),d(b,null,f(r.userLevels,s=>(o(),d("option",{key:s.id,value:s.id},l(s.code)+" - "+l(s.name),9,ce))),128))],512),[[C,v.value]])]),e("div",ve,[e("button",{onClick:P,disabled:i.value.length===0||!c.value&&!v.value,class:"w-full bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition"}," Assign "+l(i.value.length)+" User(s) ",9,xe)]),e("div",ge,l(i.value.length)+" of "+l(x.value.length)+" users selected ",1)])]),e("div",pe,[e("div",be,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Search",-1)),g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),type:"text",placeholder:"Name, email, or employee ID...",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[$,y.value]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Filter by Department",-1)),g(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>h.value=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"},[t[27]||(t[27]=e("option",{value:""},"All Departments",-1)),(o(!0),d(b,null,f(r.departments,s=>(o(),d("option",{key:s.name,value:s.name},l(s.name),9,fe))),128))],512),[[C,h.value]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Filter by Level",-1)),g(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>w.value=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-blue-500 focus:border-blue-500"},[t[29]||(t[29]=e("option",{value:""},"All Levels",-1)),(o(!0),d(b,null,f(r.userLevels,s=>(o(),d("option",{key:s.code,value:s.code},l(s.code)+" - "+l(s.name),9,ye))),128))],512),[[C,w.value]])]),e("div",he,[e("button",{onClick:t[5]||(t[5]=s=>{y.value="",h.value="",w.value=""}),class:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition"}," Clear Filters ")])])]),e("div",we,[e("div",_e,[t[31]||(t[31]=e("h2",{class:"text-lg font-medium text-gray-900"},"Users",-1)),e("div",ke,[e("label",Ce,[g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>U.value=s),onChange:S,type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,544),[[j,U.value]]),e("span",Ue,"Select all "+l(x.value.length)+" users",1)])])]),e("div",Le,[e("table",Me,[e("thead",je,[e("tr",null,[e("th",Ae,[e("input",{type:"checkbox",checked:k.value.every(s=>i.value.includes(s.id)),onChange:t[7]||(t[7]=s=>s.target.checked?i.value.push(...k.value.map(u=>u.id).filter(u=>!i.value.includes(u))):i.value=i.value.filter(u=>!k.value.map(N=>N.id).includes(u))),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,40,Ve)]),t[32]||(t[32]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," User ",-1)),t[33]||(t[33]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Level ",-1)),t[34]||(t[34]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Department ",-1)),t[35]||(t[35]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status ",-1)),t[36]||(t[36]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ",-1))])]),e("tbody",De,[(o(!0),d(b,null,f(k.value,s=>(o(),d("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Pe,[g(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=u=>i.value=u),value:s.id,class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,8,Se),[[j,i.value]])]),e("td",Be,[e("div",Ne,[e("div",ze,[e("div",Fe,[e("span",$e,l(s.name.charAt(0).toUpperCase()),1)])]),e("div",He,[e("div",We,l(s.name),1),e("div",Te,l(s.email),1),s.employee_code?(o(),d("div",qe,"ID: "+l(s.employee_code),1)):A("",!0)])])]),e("td",Ee,[s.level?(o(),d("span",Ie,l(s.level),1)):(o(),d("span",Oe,"No level"))]),e("td",Qe,[s.department?(o(),d("span",Ge,l(s.department),1)):(o(),d("span",Je,"No department"))]),e("td",Ke,[e("span",{class:V(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-green-100 text-green-800":s.status==="active","bg-red-100 text-red-800":s.status==="inactive"}])},l(s.status),3)]),e("td",Re,[H(W(T),{href:n.route("admin.users.organizational",s.id),class:"text-blue-600 hover:text-blue-900 transition-colors"},{default:M(()=>t[37]||(t[37]=[q(" View ")])),_:2},1032,["href"])])]))),128))])]),p.value>1?(o(),d("div",Xe,[e("div",Ye,[e("button",{onClick:t[9]||(t[9]=s=>a.value=Math.max(1,a.value-1)),disabled:a.value===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,Ze),e("button",{onClick:t[10]||(t[10]=s=>a.value=Math.min(p.value,a.value+1)),disabled:a.value===p.value,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"}," Next ",8,et)]),e("div",tt,[e("div",null,[e("p",st," Showing "+l((a.value-1)*_+1)+" to "+l(Math.min(a.value*_,x.value.length))+" of "+l(x.value.length)+" results ",1)]),e("div",null,[e("nav",lt,[e("button",{onClick:t[11]||(t[11]=s=>a.value=Math.max(1,a.value-1)),disabled:a.value===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,ot),(o(!0),d(b,null,f(Math.min(p.value,5),s=>(o(),d("button",{key:s,onClick:u=>a.value=s,class:V([{"bg-blue-50 border-blue-500 text-blue-600":a.value===s,"bg-white border-gray-300 text-gray-500 hover:bg-gray-50":a.value!==s},"relative inline-flex items-center px-4 py-2 border text-sm font-medium"])},l(s),11,at))),128)),e("button",{onClick:t[12]||(t[12]=s=>a.value=Math.min(p.value,a.value+1)),disabled:a.value===p.value,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"}," Next ",8,nt)])])])])):A("",!0)])])])]),_:1}))}});export{ct as default};
