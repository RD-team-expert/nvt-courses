import{d as U,r as V,W as R,k as $,l as F,o as a,w as M,e as t,j as S,g as u,a as l,F as m,h as c,t as n,i as w,v as h,n as j}from"./app-UYTjIL7K.js";import{_ as B}from"./AdminLayout.vue_vue_type_script_setup_true_lang-CVMNqIh0.js";import{l as N}from"./lodash-FgkEC9m7.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-CuKQ7c1n.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DXk8l_l7.js";import"./index-DN_WECjT.js";const L={class:"px-4 sm:px-0"},T={class:"bg-white p-4 sm:p-6 rounded-lg shadow mb-4 sm:mb-6"},z={class:"grid grid-cols-1 md:grid-cols-4 gap-4 sm:gap-6"},E=["value"],G=["value"],H={class:"bg-white rounded-lg shadow overflow-hidden overflow-x-auto"},O={class:"min-w-full divide-y divide-gray-200"},P={class:"bg-white divide-y divide-gray-200"},W={key:0},q={class:"px-4 sm:px-6 py-4 whitespace-nowrap"},I={class:"flex items-center"},J={class:"text-sm font-medium text-gray-900"},K={class:"text-xs text-gray-500 hidden sm:block"},Q={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900"},X={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Y={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900 hidden sm:table-cell"},Z={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900"},tt={class:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900 hidden md:table-cell"},et={key:0,class:"flex items-center"},st={class:"ml-1 flex"},ot={key:1},rt={class:"px-4 sm:px-6 py-4 text-sm text-gray-900 hidden lg:table-cell"},at={class:"max-w-xs truncate"},ct=U({__name:"Attendance",props:{attendance:Array,users:Array,courses:Array,filters:Object},setup(i){var f,g,y,v;const d=i,_=[{name:"Dashboard",href:route("dashboard")},{name:"Reports & Analytics",href:route("admin.reports.index")},{name:"Attendance Records",href:route("admin.reports.attendance")}],r=V({user_id:((f=d.filters)==null?void 0:f.user_id)||"",date_from:((g=d.filters)==null?void 0:g.date_from)||"",date_to:((y=d.filters)==null?void 0:y.date_to)||"",course_id:((v=d.filters)==null?void 0:v.course_id)||""}),p=N.debounce(()=>{R.get(route("admin.reports.attendance"),r.value,{preserveState:!0,replace:!0})},500);$(r,()=>{p()},{deep:!0});const k=()=>{r.value={user_id:"",date_from:"",date_to:"",course_id:""},p()},C=()=>{const o=new URLSearchParams(r.value).toString();window.location.href=route("admin.reports.export.attendance")+"?"+o},x=o=>o?new Date(o).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—",A=o=>{if(!o||isNaN(o)||o<0)return"—";o=Math.round(o);const e=Math.floor(o/60),s=o%60;return e>0?`${e} ${e===1?"hour":"hours"}${s>0?` ${s} ${s===1?"minute":"minutes"}`:""}`:`${s} ${s===1?"minute":"minutes"}`};return(o,e)=>(a(),F(B,{breadcrumbs:_},{default:M(()=>[t("div",L,[t("div",{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 gap-4 sm:gap-0"},[e[5]||(e[5]=t("h1",{class:"text-xl sm:text-2xl font-bold"},"Attendance Records Report",-1)),t("button",{onClick:C,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition flex items-center w-full sm:w-auto justify-center sm:justify-start"},e[4]||(e[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),S(" Export to CSV ")]))]),t("div",T,[e[13]||(e[13]=t("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"Filter Attendance Records",-1)),t("div",z,[t("div",null,[e[7]||(e[7]=t("label",{for:"user_filter",class:"block text-sm font-medium text-gray-700 mb-1"},"User",-1)),u(t("select",{id:"user_filter","onUpdate:modelValue":e[0]||(e[0]=s=>r.value.user_id=s),class:"border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},[e[6]||(e[6]=t("option",{value:""},"All Users",-1)),(a(!0),l(m,null,c(i.users,s=>(a(),l("option",{key:s.id,value:s.id},n(s.name),9,E))),128))],512),[[w,r.value.user_id]])]),t("div",null,[e[10]||(e[10]=t("label",{for:"course_filter",class:"block text-sm font-medium text-gray-700 mb-1"},"Course",-1)),u(t("select",{id:"course_filter","onUpdate:modelValue":e[1]||(e[1]=s=>r.value.course_id=s),class:"border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},[e[8]||(e[8]=t("option",{value:""},"All Courses",-1)),e[9]||(e[9]=t("option",{value:"general"},"General Attendance",-1)),(a(!0),l(m,null,c(i.courses,s=>(a(),l("option",{key:s.id,value:s.id},n(s.name),9,G))),128))],512),[[w,r.value.course_id]])]),t("div",null,[e[11]||(e[11]=t("label",{for:"date_from",class:"block text-sm font-medium text-gray-700 mb-1"},"Date From",-1)),u(t("input",{id:"date_from",type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>r.value.date_from=s),class:"border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[h,r.value.date_from]])]),t("div",null,[e[12]||(e[12]=t("label",{for:"date_to",class:"block text-sm font-medium text-gray-700 mb-1"},"Date To",-1)),u(t("input",{id:"date_to",type:"date","onUpdate:modelValue":e[3]||(e[3]=s=>r.value.date_to=s),class:"border px-3 py-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[h,r.value.date_to]])]),t("div",{class:"flex items-end md:col-span-4"},[t("button",{onClick:k,class:"inline-flex items-center px-4 py-2 bg-gray-100 border border-transparent rounded-md font-medium text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition"}," Reset Filters ")])])]),t("div",H,[t("table",O,[e[16]||(e[16]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," User "),t("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Course "),t("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Clock In "),t("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell"}," Clock Out "),t("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Duration "),t("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell"}," Rating "),t("th",{scope:"col",class:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden lg:table-cell"}," Comment ")])],-1)),t("tbody",P,[i.attendance.length===0?(a(),l("tr",W,e[14]||(e[14]=[t("td",{colspan:"7",class:"px-4 sm:px-6 py-4 text-center text-gray-500"},"No attendance records found",-1)]))):(a(!0),l(m,{key:1},c(i.attendance,(s,D)=>(a(),l("tr",{key:D,class:"hover:bg-gray-50"},[t("td",q,[t("div",I,[t("div",null,[t("div",J,n(s.user_name),1),t("div",K,n(s.user_email),1)])])]),t("td",Q,n(s.course_name||"General Attendance"),1),t("td",X,n(x(s.clock_in)),1),t("td",Y,n(s.clock_out?x(s.clock_out):"—"),1),t("td",Z,n(A(s.duration_in_minutes)),1),t("td",tt,[s.rating?(a(),l("div",et,[t("span",null,n(s.rating)+"/5",1),t("div",st,[(a(),l(m,null,c(5,b=>t("svg",{key:b,class:j(["h-4 w-4",b<=s.rating?"text-yellow-400":"text-gray-300"]),fill:"currentColor",viewBox:"0 0 20 20"},e[15]||(e[15]=[t("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"},null,-1)]),2)),64))])])):(a(),l("span",ot,"—"))]),t("td",rt,[t("div",at,n(s.comment||"—"),1)])]))),128))])])])])]),_:1}))}});export{ct as default};
