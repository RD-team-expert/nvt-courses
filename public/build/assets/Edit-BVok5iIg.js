import{d as H,C as Q,r as k,a as d,o as n,b as o,u as e,m as Z,w as s,e as i,P as E,f as a,t as f,j as ee,h as p,n as b,s as te,F,i as oe,v as le,x as se}from"./app-C__QVaju.js";import{V as ie,f as re}from"./AppLayout.vue_vue_type_script_setup_true_lang-B2Dge6gk.js";import{_ as v}from"./Button.vue_vue_type_script_setup_true_lang-3wUGolNO.js";import{_ as C}from"./Card.vue_vue_type_script_setup_true_lang-C6NTCksb.js";import{_ as U}from"./CardContent.vue_vue_type_script_setup_true_lang-CVVI4jBC.js";import{_ as T}from"./CardDescription.vue_vue_type_script_setup_true_lang-uH9K1n7e.js";import{_ as S}from"./CardHeader.vue_vue_type_script_setup_true_lang-EmAvtNmd.js";import{_ as V}from"./CardTitle.vue_vue_type_script_setup_true_lang-D-QOz8Vl.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-aF8VS1eW.js";import{_}from"./Label.vue_vue_type_script_setup_true_lang-B_8So5-r.js";import{_ as ae}from"./Textarea.vue_vue_type_script_setup_true_lang-pTkEcb9U.js";import{_ as ue}from"./Switch.vue_vue_type_script_setup_true_lang-CsJCTOPg.js";import{_ as N,a as z}from"./index-Dhf8RtHl.js";import{A as de}from"./arrow-left-BMTkwTtm.js";import{L as ne}from"./link-V3mBMCr5.js";import{I as me}from"./image-CaHv1HB1.js";import{U as I}from"./upload-ClDy97xy.js";import{T as G}from"./trash-2-Cox1oXJh.js";import{X as P}from"./_plugin-vue_export-helper-DTeMU56P.js";import{T as fe}from"./tag-DJzROhew.js";import{T as pe}from"./triangle-alert-C11pQW2R.js";import{S as ce}from"./save-CLavzdjt.js";import"./index-Eaggz7Xa.js";import"./index-DU9IJCLr.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B2uDP-vU.js";import"./clock-8P7QZ8ho.js";import"./useForwardPropsEmits-BEVKN6n0.js";import"./useForwardExpose-BLcFDH4t.js";import"./VisuallyHidden-cBIp1Q_A.js";import"./VisuallyHiddenInput-mXSm1HTg.js";import"./usePrimitiveElement-kCWVBnpO.js";const ve={class:"max-w-2xl mx-auto space-y-6"},_e={class:"flex items-center gap-4"},ge={class:"text-muted-foreground"},be={class:"space-y-2"},he={key:0,class:"text-sm text-destructive"},ye={class:"space-y-2"},xe={key:0,class:"text-sm text-destructive"},we={class:"space-y-2"},ke=["value","selected"],Ce={key:0,class:"text-sm text-destructive"},Ue={class:"space-y-2"},Te={key:0,class:"text-sm text-destructive"},Se={class:"space-y-2"},Ve={key:0,class:"text-sm text-destructive"},$e={key:0,class:"space-y-3"},Ie={class:"relative w-48 h-32 rounded-lg overflow-hidden border"},Re=["src"],Me={class:"flex gap-2"},De={key:1,class:"space-y-3"},Le={class:"flex gap-2"},Ae={class:"space-y-3"},Ee={key:1,class:"space-y-3"},Fe={class:"relative w-48 h-32 rounded-lg overflow-hidden border"},Ne=["src"],ze={class:"flex gap-2"},Ge={key:2,class:"text-sm text-destructive"},Pe={class:"space-y-2"},Be={key:0,class:"text-sm text-destructive"},je={class:"text-sm text-muted-foreground"},We={class:"flex items-center justify-between"},qe={class:"space-y-1"},Oe={class:"flex justify-between items-center"},Ct=H({__name:"Edit",props:{audio:{},categories:{}},setup(B){var D;const m=B,j=[{title:"Audio Management",href:"/admin/audio"},{title:m.audio.name,href:`/admin/audio/${m.audio.id}`},{title:"Edit",href:"#"}],W=u=>{if(!u)return"";const t=Math.floor(u/60),r=u%60;return`${t}:${r.toString().padStart(2,"0")}`},l=Q({name:m.audio.name||"",description:m.audio.description||"",google_cloud_url:m.audio.google_cloud_url||"",duration:W(m.audio.duration),thumbnail:null,thumbnail_url:m.audio.thumbnail_url||"",remove_thumbnail:!1,audio_category_id:((D=m.audio.audio_category_id)==null?void 0:D.toString())||"",is_active:m.audio.is_active??!0}),y=k(!1),g=k(null),h=k(null),c=k(!1),R=m.audio.thumbnail_url||m.audio.thumbnail_path,q=u=>{if(!u)return 0;const t=u.split(":");if(t.length===2){const r=parseInt(t[0])||0,w=parseInt(t[1])||0;return r*60+w}return 0},O=u=>Math.round(u*60);function J(u){var w;const t=u.target,r=(w=t.files)==null?void 0:w[0];if(r){if(r.size>2*1024*1024){alert("File size must be less than 2MB"),t.value="";return}if(!r.type.startsWith("image/")){alert("Please select an image file"),t.value="";return}l.thumbnail=r;const L=new FileReader;L.onload=Y=>{var A;g.value=(A=Y.target)==null?void 0:A.result},L.readAsDataURL(r),l.thumbnail_url="",l.remove_thumbnail=!1,c.value=!1}}function K(){l.thumbnail=null,g.value=null,h.value&&(h.value.value="")}function x(){var u;(u=h.value)==null||u.click()}function M(){c.value=!c.value,l.remove_thumbnail=c.value,c.value&&(l.thumbnail=null,g.value=null,h.value&&(h.value.value=""))}const X=async()=>{y.value=!0;let u=null;l.duration&&(l.duration.includes(":")?u=q(l.duration):u=O(parseFloat(l.duration))),await se(),l.transform(t=>({...t,_method:"PUT",duration:u,audio_category_id:t.audio_category_id||null})).post(`/admin/audio/${m.audio.id}`,{forceFormData:!0,onFinish:()=>{y.value=!1}})};return(u,t)=>(n(),d(F,null,[o(e(Z),{title:`Edit ${u.audio.name}`},null,8,["title"]),o(re,{breadcrumbs:j},{default:s(()=>[i("div",ve,[i("div",_e,[o(e(v),{asChild:"",variant:"ghost"},{default:s(()=>[o(e(E),{href:`/admin/audio/${u.audio.id}`},{default:s(()=>[o(e(de),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=a(" Back to Audio "))]),_:1},8,["href"])]),_:1}),i("div",null,[t[8]||(t[8]=i("h1",{class:"text-2xl font-bold"},"Edit Audio Course",-1)),i("p",ge,'Update the details for "'+f(u.audio.name)+'"',1)])]),i("form",{onSubmit:ee(X,["prevent"]),class:"space-y-6",enctype:"multipart/form-data"},[o(e(C),null,{default:s(()=>[o(e(S),null,{default:s(()=>[o(e(V),{class:"flex items-center gap-2"},{default:s(()=>[o(e(ie),{class:"h-5 w-5"}),t[9]||(t[9]=a(" Basic Information "))]),_:1}),o(e(T),null,{default:s(()=>t[10]||(t[10]=[a(" Update the basic details for your audio course ")])),_:1})]),_:1}),o(e(U),{class:"space-y-4"},{default:s(()=>[i("div",be,[o(e(_),{for:"name"},{default:s(()=>t[11]||(t[11]=[a("Course Name *")])),_:1}),o(e($),{id:"name",modelValue:e(l).name,"onUpdate:modelValue":t[0]||(t[0]=r=>e(l).name=r),type:"text",placeholder:"Enter audio course name",class:b({"border-destructive":e(l).errors.name}),required:""},null,8,["modelValue","class"]),e(l).errors.name?(n(),d("div",he,f(e(l).errors.name),1)):p("",!0)]),i("div",ye,[o(e(_),{for:"description"},{default:s(()=>t[12]||(t[12]=[a("Description")])),_:1}),o(e(ae),{id:"description",modelValue:e(l).description,"onUpdate:modelValue":t[1]||(t[1]=r=>e(l).description=r),placeholder:"Describe what this audio course covers...",rows:4,class:b({"border-destructive":e(l).errors.description})},null,8,["modelValue","class"]),e(l).errors.description?(n(),d("div",xe,f(e(l).errors.description),1)):p("",!0)]),i("div",we,[o(e(_),{for:"category"},{default:s(()=>t[13]||(t[13]=[a("Category")])),_:1}),te(i("select",{id:"category","onUpdate:modelValue":t[2]||(t[2]=r=>e(l).audio_category_id=r),class:b(["flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive":e(l).errors.audio_category_id}])},[t[14]||(t[14]=i("option",{value:""},"No Category",-1)),(n(!0),d(F,null,oe(u.categories,r=>(n(),d("option",{key:r.id,value:r.id.toString(),selected:r.id.toString()===e(l).audio_category_id},f(r.name),9,ke))),128))],2),[[le,e(l).audio_category_id]]),e(l).errors.audio_category_id?(n(),d("div",Ce,f(e(l).errors.audio_category_id),1)):p("",!0)])]),_:1})]),_:1}),o(e(C),null,{default:s(()=>[o(e(S),null,{default:s(()=>[o(e(V),{class:"flex items-center gap-2"},{default:s(()=>[o(e(ne),{class:"h-5 w-5"}),t[15]||(t[15]=a(" Media Information "))]),_:1}),o(e(T),null,{default:s(()=>t[16]||(t[16]=[a(" Update the Google Drive/Cloud Storage URL and media details ")])),_:1})]),_:1}),o(e(U),{class:"space-y-4"},{default:s(()=>[i("div",Ue,[o(e(_),{for:"google_cloud_url"},{default:s(()=>t[17]||(t[17]=[a("Google Drive/Cloud URL *")])),_:1}),o(e($),{id:"google_cloud_url",modelValue:e(l).google_cloud_url,"onUpdate:modelValue":t[3]||(t[3]=r=>e(l).google_cloud_url=r),type:"url",placeholder:"https://drive.google.com/file/d/YOUR_FILE_ID/view",class:b({"border-destructive":e(l).errors.google_cloud_url}),required:""},null,8,["modelValue","class"]),e(l).errors.google_cloud_url?(n(),d("div",Te,f(e(l).errors.google_cloud_url),1)):p("",!0),t[18]||(t[18]=i("div",{class:"text-sm text-muted-foreground"}," Enter the Google Drive sharing URL or Google Cloud Storage URL ",-1))]),i("div",Se,[o(e(_),{for:"duration"},{default:s(()=>t[19]||(t[19]=[a("Duration")])),_:1}),o(e($),{id:"duration",modelValue:e(l).duration,"onUpdate:modelValue":t[4]||(t[4]=r=>e(l).duration=r),type:"text",placeholder:"30 (minutes) or 30:45 (MM:SS)",class:b({"border-destructive":e(l).errors.duration})},null,8,["modelValue","class"]),e(l).errors.duration?(n(),d("div",Ve,f(e(l).errors.duration),1)):p("",!0),t[20]||(t[20]=i("div",{class:"text-sm text-muted-foreground"},' Enter duration in minutes (e.g., "30") or MM:SS format (e.g., "30:45") ',-1))])]),_:1})]),_:1}),o(e(C),null,{default:s(()=>[o(e(S),null,{default:s(()=>[o(e(V),{class:"flex items-center gap-2"},{default:s(()=>[o(e(me),{class:"h-5 w-5"}),t[21]||(t[21]=a(" Thumbnail Image "))]),_:1}),o(e(T),null,{default:s(()=>t[22]||(t[22]=[a(" Update the thumbnail image or provide an external URL ")])),_:1})]),_:1}),o(e(U),{class:"space-y-4"},{default:s(()=>[e(R)&&!c.value&&!g.value?(n(),d("div",$e,[o(e(_),null,{default:s(()=>t[23]||(t[23]=[a("Current Thumbnail")])),_:1}),i("div",Ie,[i("img",{src:u.audio.thumbnail_url,alt:"Current thumbnail",class:"w-full h-full object-cover"},null,8,Re)]),i("div",Me,[o(e(v),{onClick:x,variant:"outline",size:"sm",type:"button"},{default:s(()=>[o(e(I),{class:"h-4 w-4 mr-2"}),t[24]||(t[24]=a(" Replace Image "))]),_:1}),o(e(v),{onClick:M,variant:"outline",size:"sm",type:"button"},{default:s(()=>[o(e(G),{class:"h-4 w-4 mr-2"}),t[25]||(t[25]=a(" Remove Thumbnail "))]),_:1})])])):p("",!0),c.value?(n(),d("div",De,[o(e(N),{variant:"destructive"},{default:s(()=>[o(e(G),{class:"h-4 w-4"}),o(e(z),null,{default:s(()=>t[26]||(t[26]=[i("strong",null,"Remove current thumbnail?",-1),i("br",null,null,-1),a(" This action will remove the current thumbnail image. ")])),_:1})]),_:1}),i("div",Le,[o(e(v),{onClick:M,variant:"outline",size:"sm",type:"button"},{default:s(()=>[o(e(P),{class:"h-4 w-4 mr-2"}),t[27]||(t[27]=a(" Keep Thumbnail "))]),_:1}),o(e(v),{onClick:x,variant:"outline",size:"sm",type:"button"},{default:s(()=>[o(e(I),{class:"h-4 w-4 mr-2"}),t[28]||(t[28]=a(" Upload New Image "))]),_:1})])])):p("",!0),i("div",Ae,[o(e(_),null,{default:s(()=>t[29]||(t[29]=[a("Upload New Thumbnail")])),_:1}),i("input",{ref_key:"fileInputRef",ref:h,type:"file",accept:"image/*",onChange:J,class:"hidden"},null,544),!g.value&&(!e(R)||c.value)?(n(),d("div",{key:0,onClick:x,class:b(["border-2 border-dashed border-input rounded-lg p-6 text-center cursor-pointer hover:border-primary transition-colors",{"border-destructive":e(l).errors.thumbnail}])},[o(e(I),{class:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),t[30]||(t[30]=i("div",{class:"text-sm font-medium mb-2"},"Click to upload new thumbnail",-1)),t[31]||(t[31]=i("div",{class:"text-xs text-muted-foreground"}," PNG, JPG, GIF, WebP up to 2MB ",-1))],2)):p("",!0),g.value?(n(),d("div",Ee,[i("div",Fe,[i("img",{src:g.value,alt:"New thumbnail preview",class:"w-full h-full object-cover"},null,8,Ne),o(e(v),{onClick:K,variant:"destructive",size:"sm",class:"absolute top-2 right-2 h-8 w-8 p-0 rounded-full",type:"button"},{default:s(()=>[o(e(P),{class:"h-4 w-4"})]),_:1})]),i("div",ze,[o(e(v),{onClick:x,variant:"outline",size:"sm",type:"button"},{default:s(()=>[o(e(I),{class:"h-4 w-4 mr-2"}),t[32]||(t[32]=a(" Change Image "))]),_:1})])])):p("",!0),e(l).errors.thumbnail?(n(),d("div",Ge,f(e(l).errors.thumbnail),1)):p("",!0)]),t[34]||(t[34]=i("div",{class:"flex items-center gap-4 my-4"},[i("div",{class:"flex-1 border-t border-border"}),i("span",{class:"text-sm text-muted-foreground bg-background px-2"},"OR"),i("div",{class:"flex-1 border-t border-border"})],-1)),i("div",Pe,[o(e(_),{for:"thumbnail_url"},{default:s(()=>t[33]||(t[33]=[a("External Thumbnail URL")])),_:1}),o(e($),{id:"thumbnail_url",modelValue:e(l).thumbnail_url,"onUpdate:modelValue":t[5]||(t[5]=r=>e(l).thumbnail_url=r),type:"url",placeholder:"https://example.com/thumbnail.jpg",class:b({"border-destructive":e(l).errors.thumbnail_url}),disabled:!!e(l).thumbnail||c.value},null,8,["modelValue","class","disabled"]),e(l).errors.thumbnail_url?(n(),d("div",Be,f(e(l).errors.thumbnail_url),1)):p("",!0),i("div",je," Alternative: provide an external image URL "+f(e(l).thumbnail||c.value?"(disabled due to file upload/removal)":""),1)])]),_:1})]),_:1}),o(e(C),null,{default:s(()=>[o(e(S),null,{default:s(()=>[o(e(V),{class:"flex items-center gap-2"},{default:s(()=>[o(e(fe),{class:"h-5 w-5"}),t[35]||(t[35]=a(" Settings "))]),_:1}),o(e(T),null,{default:s(()=>t[36]||(t[36]=[a(" Configure the visibility and availability of this audio course ")])),_:1})]),_:1}),o(e(U),null,{default:s(()=>[i("div",We,[i("div",qe,[o(e(_),null,{default:s(()=>t[37]||(t[37]=[a("Active Status")])),_:1}),t[38]||(t[38]=i("div",{class:"text-sm text-muted-foreground"}," Make this audio course available to users ",-1))]),o(e(ue),{checked:e(l).is_active,"onUpdate:checked":t[6]||(t[6]=r=>e(l).is_active=r)},null,8,["checked"])])]),_:1})]),_:1}),o(e(N),null,{default:s(()=>[o(e(pe),{class:"h-4 w-4"}),o(e(z),null,{default:s(()=>t[39]||(t[39]=[i("strong",null,"Important:",-1),a(` When updating the Google Drive file, make sure it's set to "Anyone with the link can view" for proper audio streaming. `)])),_:1})]),_:1}),i("div",Oe,[o(e(v),{asChild:"",variant:"outline"},{default:s(()=>[o(e(E),{href:`/admin/audio/${u.audio.id}`},{default:s(()=>t[40]||(t[40]=[a(" Cancel ")])),_:1},8,["href"])]),_:1}),o(e(v),{type:"submit",disabled:y.value||e(l).processing},{default:s(()=>[o(e(ce),{class:"h-4 w-4 mr-2"}),a(" "+f(y.value?"Updating...":"Update Audio Course"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{Ct as default};
