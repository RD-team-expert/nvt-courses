import{d as se,r as q,A as le,p as ae,c as g,W as re,a as x,o as u,b as a,u as t,m as ne,w as r,e as l,g as b,h as z,t as i,n as $,f as d,F as j,i as F}from"./app-B6yE8LOk.js";import{q as oe,f as ie}from"./AppLayout.vue_vue_type_script_setup_true_lang-fW9bHL08.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-BCmbLoyf.js";import{_ as y}from"./Card.vue_vue_type_script_setup_true_lang-DD4LNril.js";import{_ as h}from"./CardContent.vue_vue_type_script_setup_true_lang-CZheQe_Z.js";import{_ as P}from"./CardHeader.vue_vue_type_script_setup_true_lang-CboW5KhX.js";import{_ as W}from"./CardTitle.vue_vue_type_script_setup_true_lang-C-pTtL_h.js";import{_ as w}from"./index-DI_vaViV.js";import{_ as ue}from"./Progress.vue_vue_type_script_setup_true_lang-vNPtqBVC.js";import{_ as de}from"./Textarea.vue_vue_type_script_setup_true_lang-DuROun2w.js";import{_ as N,a as L}from"./index-C-9aVWff.js";import{C as me}from"./clock-TaqH5Jq1.js";import{S as K}from"./send-9sf7xYHm.js";import{C as U}from"./circle-check-big-ClmpUFBh.js";import{C as ce}from"./chevron-left-uj1-2UTf.js";import{T as fe}from"./triangle-alert-BKtrGwxt.js";import"./index-ByyNcVWT.js";import"./index-Cm0BeycD.js";import"./_plugin-vue_export-helper-DSV2G5wh.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-ypd93s_P.js";import"./useForwardExpose-CusEPu18.js";import"./nullish-CHIgUVhi.js";const pe={class:"w-full mx-auto space-y-4 sm:space-y-6 px-4 sm:px-6 lg:px-8 py-6 sm:py-8 pb-20 sm:pb-12"},ve={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3"},be={class:"flex-1"},xe={class:"text-lg sm:text-xl font-bold"},ge={class:"text-xs sm:text-sm text-muted-foreground"},_e={class:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto"},ye={class:"flex items-center justify-between mb-3"},he={class:"text-right"},we={class:"text-2xl font-bold text-blue-900 dark:text-blue-100"},ke={class:"text-sm text-blue-700 dark:text-blue-300"},Ce={class:"text-xs text-blue-600 dark:text-blue-400 mt-2 text-center"},qe={class:"flex flex-wrap gap-2"},ze={class:"flex items-center justify-between flex-wrap gap-2"},$e={class:"flex items-center gap-2"},Ae={key:0,class:"space-y-3"},Se=["onClick"],Te={class:"flex items-center justify-center mt-0.5"},Qe={class:"flex-1 min-w-0"},Oe={class:"flex items-start gap-2"},je={class:"font-medium text-primary text-sm"},Ne={key:1,class:"space-y-3"},Le={class:"flex items-center justify-between gap-3"},Ie={class:"hidden sm:block text-sm text-muted-foreground"},rt=se({__name:"Take",props:{module:{},course:{},quiz:{},attempt:{},questions:{},existingAnswers:{},timeRemaining:{}},setup(D){const o=D,J=[{name:"My Courses",href:"/courses-online"},{name:o.course.name,href:`/courses-online/${o.course.id}`},{name:o.module.name,href:`/courses-online/${o.course.id}`},{name:"Taking Quiz",href:""}],f=q(0),p=q({}),k=q(!1),v=q(o.timeRemaining);let A=null;le(()=>{o.existingAnswers&&(p.value={...o.existingAnswers}),o.quiz.time_limit_minutes&&v.value!==null&&X()}),ae(()=>{A&&clearInterval(A)});const X=()=>{A=setInterval(()=>{v.value!==null&&v.value>0?v.value--:v.value===0&&O()},1e3)},I=g(()=>{if(v.value===null)return null;const s=Math.floor(v.value/60),e=v.value%60;return`${s}:${e.toString().padStart(2,"0")}`}),M=g(()=>v.value!==null&&v.value<60),m=g(()=>o.questions[f.value]),B=g(()=>Object.keys(p.value).filter(e=>{const n=p.value[parseInt(e)];return n&&n.length>0&&n.some(c=>c.trim()!=="")}).length/o.questions.length*100),V=g(()=>Object.keys(p.value).filter(s=>{const e=p.value[parseInt(s)];return e&&e.length>0&&e.some(n=>n.trim()!=="")}).length),S=s=>{s>=0&&s<o.questions.length&&(Y(),f.value=s)},G=()=>S(f.value+1),H=()=>S(f.value-1),T=()=>p.value[m.value.id]||[],Q=(s,e)=>{p.value[s]=e},Z=s=>{const e=m.value,n=T();if(e.type==="radio")Q(e.id,[s]);else if(e.type==="checkbox"){const c=n.indexOf(s);c>-1?n.splice(c,1):n.push(s),Q(e.id,[...n])}},ee=s=>{Q(m.value.id,[s])},C=s=>T().includes(s),R=s=>{const e=p.value[s];return e&&e.length>0&&e.some(n=>n.trim()!=="")},Y=()=>{var n;const s=m.value,e=p.value[s.id];e&&fetch(route("courses-online.modules.quiz.save-answer",{courseOnline:o.course.id,courseModule:o.module.id,attempt:o.attempt.id}),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))||""},body:JSON.stringify({question_id:s.id,answer:e})}).catch(console.error)},O=()=>{if(k.value)return;k.value=!0,Y();const s=Object.entries(p.value).map(([e,n])=>({question_id:parseInt(e),answer:n}));re.post(route("courses-online.modules.quiz.submit",{courseOnline:o.course.id,courseModule:o.module.id,attempt:o.attempt.id}),{answers:s})},E=()=>{const s=o.questions.length-V.value;s>0?confirm(`You have ${s} unanswered question(s). Are you sure you want to submit?`)&&O():O()};return(s,e)=>(u(),x(j,null,[a(t(ne),{title:`Quiz - ${s.quiz.title}`},null,8,["title"]),a(ie,{breadcrumbs:J},{default:r(()=>[l("div",pe,[a(t(y),{class:"sticky top-0 z-10 shadow-md"},{default:r(()=>[a(t(h),{class:"py-4"},{default:r(()=>[l("div",ve,[l("div",be,[l("h1",xe,i(s.quiz.title),1),l("p",ge,"Attempt #"+i(s.attempt.attempt_number)+" â€¢ "+i(s.quiz.total_points)+" points total",1)]),l("div",_e,[I.value?(u(),x("div",{key:0,class:$(["flex items-center gap-2 px-3 sm:px-4 py-2 rounded-lg font-mono text-base sm:text-lg flex-1 sm:flex-initial justify-center font-bold",M.value?"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300 animate-pulse":"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300"])},[a(t(me),{class:"h-4 w-4 sm:h-5 sm:w-5"}),d(" "+i(I.value),1)],2)):z("",!0),a(t(_),{onClick:E,disabled:k.value,size:"default",class:"w-full sm:w-auto"},{default:r(()=>[a(t(K),{class:"h-4 w-4 mr-2"}),e[1]||(e[1]=d(" Submit Quiz "))]),_:1},8,["disabled"])])])]),_:1})]),_:1}),a(t(y),{class:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950 dark:to-purple-950 border-blue-200 dark:border-blue-800"},{default:r(()=>[a(t(h),{class:"py-4"},{default:r(()=>[l("div",ye,[e[2]||(e[2]=l("div",null,[l("span",{class:"text-sm font-medium text-blue-900 dark:text-blue-100"},"Your Progress"),l("p",{class:"text-xs text-blue-700 dark:text-blue-300 mt-0.5"},"Keep going! You're doing great ðŸ’ª")],-1)),l("div",he,[l("span",we,i(V.value),1),l("span",ke," / "+i(s.questions.length),1)])]),a(t(ue),{"model-value":B.value,class:"h-3"},null,8,["model-value"]),l("p",Ce,i(Math.round(B.value))+"% Complete ",1)]),_:1})]),_:1}),a(t(y),null,{default:r(()=>[a(t(P),{class:"pb-3"},{default:r(()=>[a(t(W),{class:"text-base"},{default:r(()=>e[3]||(e[3]=[d("Quick Navigation")])),_:1})]),_:1}),a(t(h),null,{default:r(()=>[l("div",qe,[(u(!0),x(j,null,F(s.questions,(n,c)=>(u(),b(t(_),{key:n.id,variant:f.value===c?"default":R(n.id)?"secondary":"outline",size:"sm",class:"w-10 h-10 relative",onClick:te=>S(c)},{default:r(()=>[d(i(c+1)+" ",1),R(n.id)&&f.value!==c?(u(),b(t(U),{key:0,class:"absolute -top-1 -right-1 h-4 w-4 text-green-500 bg-white dark:bg-gray-900 rounded-full"})):z("",!0)]),_:2},1032,["variant","onClick"]))),128))]),e[4]||(e[4]=l("div",{class:"flex items-center gap-4 mt-3 text-xs text-muted-foreground"},[l("div",{class:"flex items-center gap-1"},[l("div",{class:"w-3 h-3 rounded bg-primary"}),l("span",null,"Current")]),l("div",{class:"flex items-center gap-1"},[l("div",{class:"w-3 h-3 rounded bg-secondary"}),l("span",null,"Answered")]),l("div",{class:"flex items-center gap-1"},[l("div",{class:"w-3 h-3 rounded border-2"}),l("span",null,"Not Answered")])],-1))]),_:1})]),_:1}),a(t(y),{class:"border-2 border-primary/20"},{default:r(()=>[a(t(P),{class:"bg-gradient-to-r from-primary/5 to-purple-500/5"},{default:r(()=>[l("div",ze,[a(t(w),{variant:"default",class:"text-sm"},{default:r(()=>[d("Question "+i(f.value+1)+" of "+i(s.questions.length),1)]),_:1}),l("div",$e,[m.value.type==="radio"?(u(),b(t(w),{key:0,variant:"outline",class:"text-xs"},{default:r(()=>e[5]||(e[5]=[d(" Single Choice ")])),_:1})):m.value.type==="checkbox"?(u(),b(t(w),{key:1,variant:"outline",class:"text-xs"},{default:r(()=>e[6]||(e[6]=[d(" Multiple Choice ")])),_:1})):(u(),b(t(w),{key:2,variant:"outline",class:"text-xs"},{default:r(()=>e[7]||(e[7]=[d(" Text Answer ")])),_:1})),a(t(w),{variant:"secondary",class:"text-sm"},{default:r(()=>[d(i(m.value.points)+" point"+i(m.value.points!==1?"s":""),1)]),_:1})])]),a(t(W),{class:"text-lg sm:text-xl mt-4 leading-relaxed"},{default:r(()=>[d(i(m.value.question_text),1)]),_:1})]),_:1}),a(t(h),{class:"space-y-4"},{default:r(()=>[m.value.type!=="text"?(u(),x("div",Ae,[a(t(N),{class:"bg-blue-50 dark:bg-blue-950 border-blue-200 dark:border-blue-800"},{default:r(()=>[a(t(L),{class:"text-sm text-blue-800 dark:text-blue-200"},{default:r(()=>[d(i(m.value.type==="radio"?"ðŸ“Œ Select ONE answer":"ðŸ“Œ Select ALL that apply"),1)]),_:1})]),_:1}),(u(!0),x(j,null,F(m.value.options,(n,c)=>(u(),x("div",{key:c,onClick:te=>Z(n),class:$(["flex items-start gap-3 p-4 rounded-lg border-2 cursor-pointer transition-all duration-200",C(n)?"border-primary bg-primary/10 shadow-md":"border-border hover:border-primary/50 hover:bg-muted/50 hover:shadow-sm"])},[l("div",Te,[l("div",{class:$(["w-6 h-6 rounded flex items-center justify-center border-2 shrink-0 transition-all",m.value.type==="radio"?"rounded-full":"rounded",C(n)?"border-primary bg-primary scale-110":"border-gray-400"])},[C(n)?(u(),b(t(U),{key:0,class:"h-4 w-4 text-primary-foreground"})):z("",!0)],2)]),l("div",Qe,[l("div",Oe,[l("span",je,i(String.fromCharCode(65+c))+".",1),l("span",{class:$(["text-sm sm:text-base break-words",C(n)?"font-medium":""])},i(n),3)])])],10,Se))),128))])):(u(),x("div",Ne,[a(t(N),{class:"bg-purple-50 dark:bg-purple-950 border-purple-200 dark:border-purple-800"},{default:r(()=>[a(t(L),{class:"text-sm text-purple-800 dark:text-purple-200"},{default:r(()=>e[8]||(e[8]=[d(" âœï¸ Write your answer below. This will be manually graded by your instructor. ")])),_:1})]),_:1}),a(t(de),{"model-value":T()[0]||"","onUpdate:modelValue":e[0]||(e[0]=n=>ee(n)),placeholder:"Type your detailed answer here...",rows:"8",class:"text-base"},null,8,["model-value"]),e[9]||(e[9]=l("p",{class:"text-xs text-muted-foreground"}," ðŸ’¡ Tip: Be clear and detailed in your response for better evaluation. ",-1))]))]),_:1})]),_:1}),a(t(y),{class:"bg-muted/50"},{default:r(()=>[a(t(h),{class:"py-4"},{default:r(()=>[l("div",Le,[a(t(_),{variant:"outline",size:"lg",onClick:H,disabled:f.value===0,class:"flex-1 sm:flex-initial"},{default:r(()=>[a(t(ce),{class:"h-4 w-4 mr-2"}),e[10]||(e[10]=d(" Previous "))]),_:1},8,["disabled"]),l("div",Ie," Question "+i(f.value+1)+" of "+i(s.questions.length),1),f.value<s.questions.length-1?(u(),b(t(_),{key:0,size:"lg",onClick:G,class:"flex-1 sm:flex-initial"},{default:r(()=>[e[11]||(e[11]=d(" Next ")),a(t(oe),{class:"h-4 w-4 ml-2"})]),_:1})):(u(),b(t(_),{key:1,size:"lg",onClick:E,disabled:k.value,class:"flex-1 sm:flex-initial bg-green-600 hover:bg-green-700"},{default:r(()=>[a(t(K),{class:"h-4 w-4 mr-2"}),e[12]||(e[12]=d(" Submit Quiz "))]),_:1},8,["disabled"]))])]),_:1})]),_:1}),M.value?(u(),b(t(N),{key:0,variant:"destructive"},{default:r(()=>[a(t(fe),{class:"h-4 w-4"}),a(t(L),null,{default:r(()=>e[13]||(e[13]=[d(" Less than 1 minute remaining! Your quiz will be automatically submitted when time runs out. ")])),_:1})]),_:1})):z("",!0)])]),_:1})],64))}});export{rt as default};
