import{d as W,r as g,C as Y,c as N,s as T,k as G,o as l,w as z,e,b as k,t as a,a as n,f as m,l as J,g as c,u as o,F as _,h as y,i as x,n as C,y as K,v as U,j as V,q as Q,P as X,W as Z}from"./app-iYB6CK9s.js";import{_ as ee}from"./AdminLayout.vue_vue_type_script_setup_true_lang-BmAEUQ0k.js";import{_ as se,a as te,b as oe}from"./LoadingModal.vue_vue_type_script_setup_true_lang-Tx-omn7W.js";import"./AppLayout.vue_vue_type_script_setup_true_lang-BOHGZ_58.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B3PnW6xU.js";import"./index-BHiy4VMt.js";const re={class:"px-4 sm:px-0"},le={class:"mb-6"},ne={class:"mt-2 text-sm text-gray-600"},ae={class:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-8"},ie={class:"flex items-start space-x-3"},de={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},ue={class:"text-blue-700"},me={class:"text-blue-700"},ce={class:"text-blue-700"},pe={key:0,class:"mt-2 text-sm"},ge={class:"text-blue-700"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-8"},fe={class:"col-span-1"},ve=["disabled"],_e=["value"],ye={key:0,class:"text-red-600 text-sm mt-1"},xe={class:"col-span-1"},he=["disabled"],we=["value"],ke={key:0,class:"text-red-600 text-sm mt-1"},Me={class:"col-span-1"},Ce=["disabled"],Ue=["value"],Ve={key:0,class:"text-red-600 text-sm mt-1"},Ae={class:"col-span-1"},Le=["disabled"],Re={key:0,class:"text-red-600 text-sm mt-1"},Se={class:"mb-8"},je={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Be=["onClick"],De={class:"flex items-start space-x-3"},Ee={class:"shrink-0 mt-1"},Ne=["value"],Te={class:"flex-1"},ze={class:"flex items-center space-x-2 mb-2"},qe={key:0,class:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Oe={key:1,class:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pe={key:2,class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},$e={class:"font-semibold text-gray-900 cursor-pointer"},Fe={class:"text-sm text-gray-600 cursor-pointer"},He={key:0,class:"absolute top-2 right-2"},Ie={key:0,class:"mb-8"},We={class:"bg-blue-50 border border-blue-200 rounded-lg p-6"},Ye=["disabled"],Ge=["value"],Je={key:0,class:"text-sm text-blue-600 mt-2"},Ke={key:1,class:"text-sm text-blue-600 mt-2"},Qe={key:0,class:"text-red-600 text-sm mt-1"},Xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-8"},Ze={class:"col-span-1"},es=["disabled"],ss={key:0,class:"text-red-600 text-sm mt-1"},ts={class:"col-span-1"},os=["disabled"],rs={key:0,class:"text-red-600 text-sm mt-1"},ls={class:"space-y-6 mb-8"},ns={class:"flex items-center"},as=["disabled"],is=["disabled"],ds={key:0,class:"text-red-600 text-sm mt-1"},us={class:"flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-200"},ms=["disabled"],cs={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},ps={key:1},gs={key:2},hs=W({__name:"Edit",props:{role:Object,managers:Array,departments:Array,employees:Array,roleTypes:Object},setup(d){const u=d,M=g(!1),h=g(!1),w=g(!1),b=g({type:"info",title:"",message:""}),f=g({title:"",message:"",action:null}),A=g({message:"Loading..."}),t=Y({user_id:u.role.user_id,department_id:u.role.department_id,role_type:u.role.role_type,manages_user_id:u.role.manages_user_id,management_type:u.role.manages_user_id?"specific_user":"department_wide",is_primary:u.role.is_primary,authority_level:u.role.authority_level,start_date:u.role.start_date,end_date:u.role.end_date,notes:u.role.notes}),q=[{value:"specific_user",label:"Manages Specific User",description:"Direct 1:1 management relationship with selected employee",icon:"user",color:"blue"},{value:"department_wide",label:"Department-wide Management",description:"Oversees entire department operations and policies",icon:"building",color:"green"},{value:"no_management",label:"No Management Responsibilities",description:"Individual contributor, specialist, or advisory role",icon:"star",color:"gray"}],L=(i,s,p)=>{b.value={type:i,title:s,message:p},M.value=!0},O=(i,s,p)=>{f.value={title:i,message:s,action:p},h.value=!0},R=N(()=>t.department_id?u.employees.filter(i=>i.department_id===t.department_id):[]),S=N(()=>R.value.filter(i=>i.id!==parseInt(t.user_id)));T(()=>t.department_id,i=>{i&&t.manages_user_id&&(R.value.find(p=>p.id===t.manages_user_id)||(t.manages_user_id=null))}),T(()=>t.management_type,i=>{i!=="specific_user"&&(t.manages_user_id=null)});const P=()=>{O("Update Manager Role","Are you sure you want to update this manager role assignment? This will change the current management structure.",()=>{w.value=!0,A.value.message="Updating manager role...",t.management_type!=="specific_user"&&(t.manages_user_id=null),t.put(route("admin.manager-roles.update",u.role.id),{onSuccess:()=>{w.value=!1,L("success","Success","Manager role updated successfully!"),setTimeout(()=>{Z.visit(route("admin.manager-roles.show",u.role.id))},1500)},onError:i=>{w.value=!1,console.error("Update failed:",i);const s=i.role_conflict||"Failed to update manager role. Please try again.";L("error","Error",s)}})})},$=()=>{h.value=!1,f.value.action&&f.value.action()},F=()=>{M.value=!1},H=()=>{h.value=!1},I=[{name:"Dashboard",href:route("dashboard")},{name:"Manager Roles",href:route("admin.manager-roles.index")},{name:"Edit Role",href:route("admin.manager-roles.edit",u.role.id)}];return(i,s)=>(l(),G(ee,{breadcrumbs:I},{default:z(()=>{var p,j,B,D,E;return[e("div",re,[e("div",le,[s[10]||(s[10]=e("h1",{class:"text-xl sm:text-2xl font-bold"},"Edit Manager Role Assignment",-1)),e("p",ne," Update the management role for "+a((p=d.role.manager)==null?void 0:p.name)+" in "+a((j=d.role.department)==null?void 0:j.name),1)]),e("div",ae,[e("div",ie,[s[16]||(s[16]=e("div",{class:"shrink-0"},[e("svg",{class:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",null,[s[15]||(s[15]=e("h3",{class:"font-semibold text-blue-900 mb-2"},"Current Assignment",-1)),e("div",de,[e("div",null,[s[11]||(s[11]=e("span",{class:"font-medium text-blue-800"},"Manager:",-1)),e("span",ue,a((B=d.role.manager)==null?void 0:B.name)+" ("+a((D=d.role.manager)==null?void 0:D.level)+")",1)]),e("div",null,[s[12]||(s[12]=e("span",{class:"font-medium text-blue-800"},"Department:",-1)),e("span",me,a((E=d.role.department)==null?void 0:E.name),1)]),e("div",null,[s[13]||(s[13]=e("span",{class:"font-medium text-blue-800"},"Role:",-1)),e("span",ce,a(d.roleTypes[d.role.role_type]),1)])]),d.role.managed_user?(l(),n("div",pe,[s[14]||(s[14]=e("span",{class:"font-medium text-blue-800"},"Currently Manages:",-1)),e("span",ge,a(d.role.managed_user.name)+" ("+a(d.role.managed_user.email)+")",1)])):m("",!0)])])]),e("form",{onSubmit:J(P,["prevent"]),class:"max-w-6xl mx-auto"},[e("div",be,[e("div",fe,[s[18]||(s[18]=e("label",{class:"block font-semibold mb-2"},"Manager",-1)),c(e("select",{"onUpdate:modelValue":s[0]||(s[0]=r=>o(t).user_id=r),class:"border border-gray-300 px-3 py-2 rounded-md w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o(t).processing,required:""},[s[17]||(s[17]=e("option",{value:""},"Select Manager",-1)),(l(!0),n(_,null,y(d.managers,r=>(l(),n("option",{key:r.id,value:r.id},a(r.name)+" ("+a(r.level)+") - "+a(r.department),9,_e))),128))],8,ve),[[x,o(t).user_id]]),o(t).errors.user_id?(l(),n("div",ye,a(o(t).errors.user_id),1)):m("",!0)]),e("div",xe,[s[20]||(s[20]=e("label",{class:"block font-semibold mb-2"},"Department",-1)),c(e("select",{"onUpdate:modelValue":s[1]||(s[1]=r=>o(t).department_id=r),class:"border border-gray-300 px-3 py-2 rounded-md w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o(t).processing,required:""},[s[19]||(s[19]=e("option",{value:""},"Select Department",-1)),(l(!0),n(_,null,y(d.departments,r=>(l(),n("option",{key:r.id,value:r.id},a(r.name)+" ("+a(r.department_code)+") ",9,we))),128))],8,he),[[x,o(t).department_id]]),o(t).errors.department_id?(l(),n("div",ke,a(o(t).errors.department_id),1)):m("",!0)]),e("div",Me,[s[22]||(s[22]=e("label",{class:"block font-semibold mb-2"},"Role Type",-1)),c(e("select",{"onUpdate:modelValue":s[2]||(s[2]=r=>o(t).role_type=r),class:"border border-gray-300 px-3 py-2 rounded-md w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o(t).processing,required:""},[s[21]||(s[21]=e("option",{value:""},"Select Role Type",-1)),(l(!0),n(_,null,y(d.roleTypes,(r,v)=>(l(),n("option",{key:v,value:v},a(r),9,Ue))),128))],8,Ce),[[x,o(t).role_type]]),o(t).errors.role_type?(l(),n("div",Ve,a(o(t).errors.role_type),1)):m("",!0)]),e("div",Ae,[s[24]||(s[24]=e("label",{class:"block font-semibold mb-2"},"Authority Level",-1)),c(e("select",{"onUpdate:modelValue":s[3]||(s[3]=r=>o(t).authority_level=r),class:"border border-gray-300 px-3 py-2 rounded-md w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o(t).processing,required:""},s[23]||(s[23]=[e("option",{value:"1"},"High Authority",-1),e("option",{value:"2"},"Medium Authority",-1),e("option",{value:"3"},"Low Authority",-1)]),8,Le),[[x,o(t).authority_level]]),o(t).errors.authority_level?(l(),n("div",Re,a(o(t).errors.authority_level),1)):m("",!0)])]),e("div",Se,[s[29]||(s[29]=e("label",{class:"block font-semibold mb-4 text-lg"},"Management Responsibilities",-1)),e("div",je,[(l(),n(_,null,y(q,r=>e("div",{key:r.value,class:C(["relative border-2 rounded-lg p-6 cursor-pointer transition-all hover:shadow-md",{"border-blue-500 bg-blue-50 shadow-md":o(t).management_type===r.value&&r.color==="blue","border-green-500 bg-green-50 shadow-md":o(t).management_type===r.value&&r.color==="green","border-gray-500 bg-gray-50 shadow-md":o(t).management_type===r.value&&r.color==="gray","border-gray-200 hover:border-gray-300":o(t).management_type!==r.value}]),onClick:v=>o(t).management_type=r.value},[e("div",De,[e("div",Ee,[c(e("input",{type:"radio",value:r.value,"onUpdate:modelValue":s[4]||(s[4]=v=>o(t).management_type=v),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"},null,8,Ne),[[K,o(t).management_type]])]),e("div",Te,[e("div",ze,[r.icon==="user"?(l(),n("svg",qe,s[25]||(s[25]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)]))):r.icon==="building"?(l(),n("svg",Oe,s[26]||(s[26]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},null,-1)]))):(l(),n("svg",Pe,s[27]||(s[27]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"},null,-1)]))),e("h3",$e,a(r.label),1)]),e("p",Fe,a(r.description),1)])]),o(t).management_type===r.value?(l(),n("div",He,[e("div",{class:C(["w-6 h-6 rounded-full flex items-center justify-center",{"bg-blue-500":r.color==="blue","bg-green-500":r.color==="green","bg-gray-500":r.color==="gray"}])},s[28]||(s[28]=[e("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)]),2)])):m("",!0)],10,Be)),64))])]),o(t).management_type==="specific_user"?(l(),n("div",Ie,[e("div",We,[s[32]||(s[32]=e("div",{class:"flex items-start space-x-3 mb-4"},[e("div",{class:"shrink-0"},[e("svg",{class:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])]),e("div",null,[e("h4",{class:"font-semibold text-blue-900 mb-1"},"Direct Management Assignment"),e("p",{class:"text-sm text-blue-700"},"Select a specific L1 employee who will report directly to this manager for daily tasks, performance reviews, and career development.")])],-1)),e("div",null,[s[31]||(s[31]=e("label",{class:"block font-semibold mb-2 text-blue-900"},"Select L1 Employee to Manage",-1)),c(e("select",{"onUpdate:modelValue":s[5]||(s[5]=r=>o(t).manages_user_id=r),class:"border border-blue-300 px-3 py-2 rounded-md w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white",disabled:o(t).processing||!o(t).department_id},[s[30]||(s[30]=e("option",{value:""},"Choose an L1 employee",-1)),(l(!0),n(_,null,y(S.value,r=>(l(),n("option",{key:r.id,value:r.id},a(r.name)+" ("+a(r.level)+") - "+a(r.email),9,Ge))),128))],8,Ye),[[x,o(t).manages_user_id]]),o(t).department_id?S.value.length===0?(l(),n("p",Ke," No L1 employees available in this department ")):m("",!0):(l(),n("p",Je," Please select a department first to see available L1 employees "))]),o(t).errors.manages_user_id?(l(),n("div",Qe,a(o(t).errors.manages_user_id),1)):m("",!0)])])):m("",!0),e("div",Xe,[e("div",Ze,[s[33]||(s[33]=e("label",{class:"block font-semibold mb-2"},"Start Date",-1)),c(e("input",{type:"date","onUpdate:modelValue":s[6]||(s[6]=r=>o(t).start_date=r),class:"border border-gray-300 px-3 py-2 rounded-md w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o(t).processing,required:""},null,8,es),[[U,o(t).start_date]]),o(t).errors.start_date?(l(),n("div",ss,a(o(t).errors.start_date),1)):m("",!0)]),e("div",ts,[s[34]||(s[34]=e("label",{class:"block font-semibold mb-2"},[V("End Date "),e("span",{class:"text-gray-500 font-normal"},"(Optional)")],-1)),c(e("input",{type:"date","onUpdate:modelValue":s[7]||(s[7]=r=>o(t).end_date=r),class:"border border-gray-300 px-3 py-2 rounded-md w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o(t).processing},null,8,os),[[U,o(t).end_date]]),s[35]||(s[35]=e("p",{class:"text-sm text-gray-500 mt-1"},"Leave empty for permanent assignment",-1)),o(t).errors.end_date?(l(),n("div",rs,a(o(t).errors.end_date),1)):m("",!0)])]),e("div",ls,[e("div",null,[e("div",ns,[c(e("input",{id:"is_primary","onUpdate:modelValue":s[8]||(s[8]=r=>o(t).is_primary=r),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",disabled:o(t).processing},null,8,as),[[Q,o(t).is_primary]]),s[36]||(s[36]=e("label",{for:"is_primary",class:"ml-3 block font-semibold text-gray-900"},"Primary Role",-1))]),s[37]||(s[37]=e("p",{class:"text-sm text-gray-600 mt-2 ml-7"},"Primary roles have higher authority and receive priority notifications. Only one primary role is recommended per person per department.",-1))]),e("div",null,[s[38]||(s[38]=e("label",{class:"block font-semibold mb-2"},[V("Notes "),e("span",{class:"text-gray-500 font-normal"},"(Optional)")],-1)),c(e("textarea",{"onUpdate:modelValue":s[9]||(s[9]=r=>o(t).notes=r),rows:"4",class:"border border-gray-300 px-3 py-2 rounded-md w-full focus:outline-hidden focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:o(t).processing,placeholder:"Additional notes about this role assignment, responsibilities, special conditions, or expectations..."},null,8,is),[[U,o(t).notes]]),o(t).errors.notes?(l(),n("div",ds,a(o(t).errors.notes),1)):m("",!0)])]),e("div",us,[e("button",{type:"submit",class:"bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors w-full sm:w-auto font-semibold flex items-center justify-center gap-2 shadow-sm",disabled:o(t).processing},[o(t).processing?(l(),n("svg",cs,s[39]||(s[39]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):m("",!0),o(t).processing?(l(),n("span",ps,"Updating Assignment...")):(l(),n("span",gs,"Update Role Assignment"))],8,ms),k(o(X),{href:i.route("admin.manager-roles.show",d.role.id),class:C(["bg-gray-100 text-gray-700 px-8 py-3 rounded-lg hover:bg-gray-200 transition-colors w-full sm:w-auto text-center font-semibold border border-gray-300",{"pointer-events-none opacity-50":o(t).processing}])},{default:z(()=>s[40]||(s[40]=[V(" Cancel ")])),_:1},8,["href","class"])])],32)]),k(se,{show:M.value,type:b.value.type,title:b.value.title,message:b.value.message,"auto-close":b.value.type==="success",duration:4e3,onClose:F},null,8,["show","type","title","message","auto-close"]),k(te,{show:h.value,title:f.value.title,message:f.value.message,"confirm-text":"Yes, Update","cancel-text":"Cancel",type:"info",onConfirm:$,onCancel:H},null,8,["show","title","message"]),k(oe,{show:w.value,message:A.value.message},null,8,["show","message"])]}),_:1}))}});export{hs as default};
