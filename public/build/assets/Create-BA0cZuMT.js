import{d as G,C as N,r as U,c as q,a as m,o as n,b as o,u as e,m as H,w as s,e as l,P as $,f as d,j as O,h as f,n as p,t as u,F as L,i as I,g as w}from"./app-BBTIqQTG.js";import{m as J,f as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-BQt6xuzr.js";import{T as Q,C as W}from"./ChunkUploader-4ceUuaXZ.js";import{_ as g}from"./Button.vue_vue_type_script_setup_true_lang-BWA484I_.js";import{_ as y}from"./Card.vue_vue_type_script_setup_true_lang-Cu8nXv2d.js";import{_ as x}from"./CardContent.vue_vue_type_script_setup_true_lang-CQK6Rmid.js";import{_ as b}from"./CardDescription.vue_vue_type_script_setup_true_lang-CiIrxnJs.js";import{_ as V}from"./CardHeader.vue_vue_type_script_setup_true_lang-QMZ_WLrm.js";import{_ as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-BM2okKYS.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-Mc4eNpWx.js";import{_ as c}from"./Label.vue_vue_type_script_setup_true_lang-B0Fth6sj.js";import{_ as X}from"./Textarea.vue_vue_type_script_setup_true_lang-SolbK0n3.js";import{_ as Y}from"./Switch.vue_vue_type_script_setup_true_lang-jnRezweG.js";import{_ as Z,a as ee,b as te,c as oe,d as re}from"./SelectValue.vue_vue_type_script_setup_true_lang-CjBJ6PF8.js";import{_ as se,a as M}from"./RadioGroupItem.vue_vue_type_script_setup_true_lang-BXmY57yj.js";import{A as le}from"./arrow-left-ChPw_eWD.js";import{S as ae}from"./square-play-DToLw1aC.js";import{H as D,C as ie}from"./hard-drive-Pa5yLbH2.js";import{L as de}from"./link-2-58IQFXN5.js";import{L as ne}from"./loader-circle-BsVX274U.js";import{S as ue}from"./save-CMfk28Gw.js";import"./index-DxmgYEzh.js";import"./index-C9D0HCi3.js";import"./_plugin-vue_export-helper-Cr3cSxNb.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-CdZUx_uO.js";import"./clock-C--zl4aK.js";import"./useForwardPropsEmits-BDMB5xTJ.js";import"./useForwardExpose-BHBoz1Qx.js";import"./VisuallyHidden-DaZyBqaM.js";import"./VisuallyHiddenInput-UeOzdMxw.js";import"./usePrimitiveElement-Bvq0sdb7.js";import"./Presence-Dh4E0ubB.js";import"./ConfigProvider-8_wu1FjH.js";import"./Teleport-FX-RPmRf.js";import"./handleAndDispatchCustomEvent-ChOKVcqp.js";import"./chevron-up-D4TVYOoO.js";import"./Collection-0xWfu39u.js";import"./check-DoB6EHYW.js";import"./useSize-Cmmj1tLI.js";import"./ohash.D__AXeF1-DHF4M4F_.js";import"./nullish-CHIgUVhi.js";import"./RovingFocusItem-CD1_eSJP.js";const me={class:"max-w-4xl mx-auto space-y-6"},ce={class:"flex items-center gap-4"},fe={class:"space-y-2"},pe={key:0,class:"text-sm text-destructive"},_e={class:"space-y-2"},ve={key:0,class:"text-sm text-destructive"},ge={class:"space-y-2"},ye={key:0,class:"text-sm text-destructive"},xe={key:0,class:"space-y-2"},be={class:"flex gap-2"},Ve={key:0,class:"text-sm text-destructive"},Se={key:1,class:"space-y-2"},we={key:0,class:"text-sm text-destructive"},he={class:"text-sm text-muted-foreground"},ke={class:"space-y-2"},Ce={class:"flex gap-2"},Ue={class:"flex items-center px-3 py-2 bg-muted rounded-md text-sm text-muted-foreground min-w-0"},$e={key:0,class:"text-sm text-destructive"},Le={class:"text-sm text-muted-foreground"},Me={class:"flex items-center justify-between"},De={class:"space-y-1"},Fe={class:"flex justify-between items-center"},Vt=G({__name:"Create",props:{categories:{},maxFileSize:{}},setup(F){const P=F,B=[{title:"Video Management",href:"/admin/videos"},{title:"Create Video Course",href:""}],r=N({name:"",description:"",storage_type:"google_drive",google_drive_url:"",video_data:"",duration:null,content_category_id:null,is_active:!0}),_=U(!1),v=U(!1),k=q(()=>Math.round((P.maxFileSize||512e3)/1024)),T=i=>{console.log("✅ Chunk upload complete:",i),r.video_data=JSON.stringify(i)},z=i=>{console.error("❌ Chunk upload error:",i),alert("Upload failed. Please try again.")},E=i=>{console.log("Upload progress:",i+"%")},R=async()=>{if(r.google_drive_url){v.value=!0;try{console.log("Testing URL:",r.google_drive_url),await new Promise(i=>setTimeout(i,2e3)),alert("Video URL is valid!")}catch(i){console.error("URL test failed:",i),alert("Failed to validate video URL. Please check the link.")}finally{v.value=!1}}},j=i=>{if(!i)return"00:00";const t=Math.floor(i/3600),a=Math.floor(i%3600/60),C=i%60;return t>0?`${t.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`:`${a.toString().padStart(2,"0")}:${C.toString().padStart(2,"0")}`},A=async()=>{_.value=!0,r.post("/admin/videos",{preserveScroll:!0,onFinish:()=>{_.value=!1},onSuccess:()=>{console.log("✅ Video created successfully")},onError:i=>{console.error("❌ Form errors:",i)}})};return(i,t)=>(n(),m(L,null,[o(e(H),{title:"Create Video Course"}),o(K,{breadcrumbs:B},{default:s(()=>[l("div",me,[l("div",ce,[o(e(g),{"as-child":"",variant:"ghost"},{default:s(()=>[o(e($),{href:"/admin/videos"},{default:s(()=>[o(e(le),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=d(" Back to Videos "))]),_:1})]),_:1}),t[8]||(t[8]=l("div",null,[l("h1",{class:"text-2xl font-bold"},"Create Video Course"),l("p",{class:"text-muted-foreground"},"Add a new video course to your library")],-1))]),l("form",{onSubmit:O(A,["prevent"]),class:"space-y-6"},[o(e(y),null,{default:s(()=>[o(e(V),null,{default:s(()=>[o(e(S),{class:"flex items-center gap-2"},{default:s(()=>[o(e(ae),{class:"h-5 w-5"}),t[9]||(t[9]=d(" Video Information "))]),_:1}),o(e(b),null,{default:s(()=>t[10]||(t[10]=[d(" Enter the basic details for your video course ")])),_:1})]),_:1}),o(e(x),{class:"space-y-4"},{default:s(()=>[l("div",fe,[o(e(c),{for:"name"},{default:s(()=>t[11]||(t[11]=[d("Video Title")])),_:1}),o(e(h),{id:"name",modelValue:e(r).name,"onUpdate:modelValue":t[0]||(t[0]=a=>e(r).name=a),type:"text",placeholder:"Enter video course title...",class:p({"border-destructive":e(r).errors.name}),required:""},null,8,["modelValue","class"]),e(r).errors.name?(n(),m("div",pe,u(e(r).errors.name),1)):f("",!0)]),l("div",_e,[o(e(c),{for:"description"},{default:s(()=>t[12]||(t[12]=[d("Description")])),_:1}),o(e(X),{id:"description",modelValue:e(r).description,"onUpdate:modelValue":t[1]||(t[1]=a=>e(r).description=a),placeholder:"Describe what students will learn from this video course...",rows:"5",class:p({"border-destructive":e(r).errors.description})},null,8,["modelValue","class"]),e(r).errors.description?(n(),m("div",ve,u(e(r).errors.description),1)):f("",!0)]),l("div",ge,[o(e(c),{for:"content_category_id"},{default:s(()=>t[13]||(t[13]=[d("Category")])),_:1}),o(e(Z),{modelValue:e(r).content_category_id,"onUpdate:modelValue":t[2]||(t[2]=a=>e(r).content_category_id=a)},{default:s(()=>[o(e(ee),{class:p({"border-destructive":e(r).errors.content_category_id})},{default:s(()=>[o(e(te),{placeholder:"Select a category..."})]),_:1},8,["class"]),o(e(oe),null,{default:s(()=>[(n(!0),m(L,null,I(i.categories,a=>(n(),w(e(re),{key:a.id,value:a.id.toString()},{default:s(()=>[d(u(a.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"]),e(r).errors.content_category_id?(n(),m("div",ye,u(e(r).errors.content_category_id),1)):f("",!0)])]),_:1})]),_:1}),o(e(y),null,{default:s(()=>[o(e(V),null,{default:s(()=>[o(e(S),{class:"flex items-center gap-2"},{default:s(()=>[o(e(D),{class:"h-5 w-5"}),t[14]||(t[14]=d(" Storage Type "))]),_:1}),o(e(b),null,{default:s(()=>t[15]||(t[15]=[d(" Choose where to store your video ")])),_:1})]),_:1}),o(e(x),{class:"space-y-4"},{default:s(()=>[o(e(se),{modelValue:e(r).storage_type,"onUpdate:modelValue":t[3]||(t[3]=a=>e(r).storage_type=a),class:"grid grid-cols-2 gap-4"},{default:s(()=>[o(e(c),{for:"google_drive",class:p(["flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground cursor-pointer",{"border-primary":e(r).storage_type==="google_drive"}])},{default:s(()=>[o(e(M),{value:"google_drive",id:"google_drive",class:"sr-only"}),o(e(ie),{class:"mb-3 h-6 w-6"}),t[16]||(t[16]=l("div",{class:"space-y-1 text-center"},[l("p",{class:"text-sm font-medium leading-none"},"Google Drive"),l("p",{class:"text-xs text-muted-foreground"}," Store video on Google Drive ")],-1))]),_:1},8,["class"]),o(e(c),{for:"local",class:p(["flex flex-col items-center justify-between rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground cursor-pointer",{"border-primary":e(r).storage_type==="local"}])},{default:s(()=>[o(e(M),{value:"local",id:"local",class:"sr-only"}),o(e(D),{class:"mb-3 h-6 w-6"}),t[17]||(t[17]=l("div",{class:"space-y-1 text-center"},[l("p",{class:"text-sm font-medium leading-none"},"Local Storage"),l("p",{class:"text-xs text-muted-foreground"}," Upload video to server ")],-1))]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(e(y),null,{default:s(()=>[o(e(V),null,{default:s(()=>[o(e(S),{class:"flex items-center gap-2"},{default:s(()=>[o(e(de),{class:"h-5 w-5"}),t[18]||(t[18]=d(" Video Source "))]),_:1}),o(e(b),null,{default:s(()=>[d(u(e(r).storage_type==="google_drive"?"Provide Google Drive URL":"Upload video file"),1)]),_:1})]),_:1}),o(e(x),{class:"space-y-4"},{default:s(()=>[e(r).storage_type==="google_drive"?(n(),m("div",xe,[o(e(c),{for:"google_drive_url"},{default:s(()=>t[19]||(t[19]=[d("Google Drive Video URL")])),_:1}),l("div",be,[o(e(h),{id:"google_drive_url",modelValue:e(r).google_drive_url,"onUpdate:modelValue":t[4]||(t[4]=a=>e(r).google_drive_url=a),type:"url",placeholder:"https://drive.google.com/file/d/...",class:p({"border-destructive":e(r).errors.google_drive_url})},null,8,["modelValue","class"]),o(e(g),{type:"button",variant:"outline",size:"icon",onClick:R,disabled:!e(r).google_drive_url||v.value},{default:s(()=>[v.value?(n(),w(e(ne),{key:0,class:"h-4 w-4 animate-spin"})):(n(),w(e(Q),{key:1,class:"h-4 w-4"}))]),_:1},8,["disabled"])]),e(r).errors.google_drive_url?(n(),m("div",Ve,u(e(r).errors.google_drive_url),1)):f("",!0),t[20]||(t[20]=l("div",{class:"text-sm text-muted-foreground"},' Paste the shareable link from Google Drive. Make sure the video is set to "Anyone with the link can view" ',-1))])):e(r).storage_type==="local"?(n(),m("div",Se,[o(e(c),{for:"video_file"},{default:s(()=>t[21]||(t[21]=[d("Video File")])),_:1}),o(W,{name:"file",accept:"video/*",maxFileSize:k.value+"MB",onUploaded:T,onError:z,onProgress:E},null,8,["maxFileSize"]),e(r).errors.video_file||e(r).errors.video_data?(n(),m("div",we,u(e(r).errors.video_file||e(r).errors.video_data),1)):f("",!0),l("div",he," Video will be uploaded in 2MB chunks for reliability. Maximum "+u(k.value)+"MB ",1)])):f("",!0),l("div",ke,[o(e(c),{for:"duration"},{default:s(()=>t[22]||(t[22]=[d("Duration (seconds)")])),_:1}),l("div",Ce,[o(e(h),{id:"duration",modelValue:e(r).duration,"onUpdate:modelValue":t[5]||(t[5]=a=>e(r).duration=a),type:"number",min:"1",max:"86400",placeholder:"e.g., 3600 for 1 hour",class:p({"border-destructive":e(r).errors.duration})},null,8,["modelValue","class"]),l("div",Ue,u(j(e(r).duration)),1)]),e(r).errors.duration?(n(),m("div",$e,u(e(r).errors.duration),1)):f("",!0),l("div",Le,u(e(r).storage_type==="local"?"Optional - will be auto-detected from video file":"Video duration in seconds (optional)"),1)])]),_:1})]),_:1}),o(e(y),null,{default:s(()=>[o(e(V),null,{default:s(()=>[o(e(S),{class:"flex items-center gap-2"},{default:s(()=>[o(e(J),{class:"h-5 w-5"}),t[23]||(t[23]=d(" Settings "))]),_:1}),o(e(b),null,{default:s(()=>t[24]||(t[24]=[d(" Configure the video course settings ")])),_:1})]),_:1}),o(e(x),null,{default:s(()=>[l("div",Me,[l("div",De,[o(e(c),null,{default:s(()=>t[25]||(t[25]=[d("Active Status")])),_:1}),t[26]||(t[26]=l("div",{class:"text-sm text-muted-foreground"}," Make this video course available to students ",-1))]),o(e(Y),{checked:e(r).is_active,"onUpdate:checked":t[6]||(t[6]=a=>e(r).is_active=a)},null,8,["checked"])])]),_:1})]),_:1}),l("div",Fe,[o(e(g),{"as-child":"",variant:"outline"},{default:s(()=>[o(e($),{href:"/admin/videos"},{default:s(()=>t[27]||(t[27]=[d("Cancel")])),_:1})]),_:1}),o(e(g),{type:"submit",disabled:_.value||e(r).processing||e(r).storage_type==="local"&&!e(r).video_data},{default:s(()=>[o(e(ue),{class:"h-4 w-4 mr-2"}),d(" "+u(_.value?"Creating...":"Create Video Course"),1)]),_:1},8,["disabled"])])],32)])]),_:1})],64))}});export{Vt as default};
